à%
]C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Helpers\AutoMapperConfig.cs
	namespace 	
	ViewModel
 
. 
Helpers 
{ 
public 

static 
class 
AutoMapperConfig (
{		 
public

 
static

 
void

 
RegisterMappings

 +
(

+ ,
)

, -
{ 	
Mapper 
. 

Initialize 
( 
cfg !
=>" $
{ 
cfg 
. 
	CreateMap 
< 
Appointment )
,) *
AppointmentDTO+ 9
>9 :
(: ;
); <
;< =
cfg 
. 
	CreateMap 
< 
AppointmentDTO ,
,, -
AppointmentModel. >
>> ?
(? @
)@ A
;A B
cfg 
. 
	CreateMap 
< 
AppointmentModel .
,. /
AppointmentDTO0 >
>> ?
(? @
)@ A
;A B
cfg 
. 
	CreateMap 
< 
AppointmentDTO ,
,, -
Appointment. 9
>9 :
(: ;
); <
;< =
cfg 
. 
	CreateMap 
< 
Location &
,& '
LocationDTO( 3
>3 4
(4 5
)5 6
;6 7
cfg 
. 
	CreateMap 
< 
User "
," #
UserDTO$ +
>+ ,
(, -
)- .
. 
	ForMember 
( 
s  
=>! #
s$ %
.% &
Groups& ,
,, -
opt. 1
=>2 4
opt5 8
.8 9
Ignore9 ?
(? @
)@ A
)A B
;B C
cfg 
. 
	CreateMap 
< 
UserDTO %
,% &
	UserModel' 0
>0 1
(1 2
)2 3
;3 4
cfg 
. 
	CreateMap 
< 
	UserModel '
,' (
UserDTO) 0
>0 1
(1 2
)2 3
;3 4
cfg 
. 
	CreateMap 
< 
UserDTO %
,% &
User' +
>+ ,
(, -
)- .
;. /
cfg 
. 
	CreateMap 
< 
Group #
,# $
GroupDTO% -
>- .
(. /
)/ 0
;0 1
cfg 
. 
	CreateMap 
< 
GroupDTO &
,& '

GroupModel( 2
>2 3
(3 4
)4 5
;5 6
cfg 
. 
	CreateMap 
< 

GroupModel (
,( )
GroupDTO* 2
>2 3
(3 4
)4 5
;5 6
cfg 
. 
	CreateMap 
< 
GroupDTO &
,& '
Group( -
>- .
(. /
)/ 0
;0 1
cfg   
.   
	CreateMap   
<   
Role   "
,  " #
RoleDTO  $ +
>  + ,
(  , -
)  - .
;  . /
cfg!! 
.!! 
	CreateMap!! 
<!! 
RoleDTO!! %
,!!% &
Role!!' +
>!!+ ,
(!!, -
)!!- .
;!!. /
cfg## 
.## 
	CreateMap## 
<## 
Log## !
,##! "
LogDTO### )
>##) *
(##* +
)##+ ,
;##, -
cfg$$ 
.$$ 
	CreateMap$$ 
<$$ 
LogDTO$$ $
,$$$ %
LogModel$$& .
>$$. /
($$/ 0
)$$0 1
;$$1 2
cfg&& 
.&& 
	CreateMap&& 
<&& 
Notification&& *
,&&* +
NotificationDTO&&, ;
>&&; <
(&&< =
)&&= >
;&&> ?
cfg'' 
.'' 
	CreateMap'' 
<'' 
NotificationDTO'' -
,''- .
Notification''/ ;
>''; <
(''< =
)''= >
;''> ?
cfg(( 
.(( 
	CreateMap(( 
<(( 
AppointmentDTO(( ,
,((, -
Notification((. :
>((: ;
(((; <
)((< =
;((= >
})) 
))) 
;)) 
}** 	
}++ 
},, ∆
^C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Helpers\OpenWindowMessage.cs
	namespace 	
	ViewModel
 
. 
Helpers 
{ 
public 

class 
OpenWindowMessage "
{ 
public 

WindowType 
Type 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
string		 
Argument		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
int

 
SecondsToShow

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
AppointmentModel 
Appointment  +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
UserDTO 
User 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ◊V
XC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Helpers\PrintHelper.cs
	namespace 	
	ViewModel
 
. 
Helpers 
{ 
public 

static 
class 
PrintHelper #
{ 
public 
static 
void 
PrintViewList (
(( )
ListView) 1
appointmentList2 A
)A B
{ 	
PrintDialog 
pd 
= 
new  
PrintDialog! ,
(, -
)- .
;. /
FlowDocument 
fd 
= 
new !
FlowDocument" .
(. /
)/ 0
;0 1
fd 
. 

FontFamily 
= 
new 

FontFamily  *
(* +
$str+ 8
)8 9
;9 :
fd 
. 
FontSize 
= 
$num 
; 
fd 
. 
PagePadding 
= 
new  
	Thickness! *
(* +
$num+ -
)- .
;. /
fd 
. 
	ColumnGap 
= 
$num 
; 
fd 
. 
ColumnWidth 
= 
pd 
.  
PrintableAreaWidth  2
;2 3
fd 
. 
Blocks 
. 
Add 
( 
new 
	Paragraph '
(' (
new( +
Run, /
(/ 0
String0 6
.6 7
Format7 =
(= >
$"> @
{@ A
$strA J
,J K
-K L
$numL N
}N O
{O P
$strP [
,[ \
-\ ]
$num] _
}_ `
{` a
$stra q
,q r
-r s
$nums u
}u v
{v w
$str	w Ñ
,
Ñ Ö
-
Ö Ü
$num
Ü à
}
à â
{
â ä
$str
ä î
,
î ï
-
ï ñ
$num
ñ ò
}
ò ô
{
ô ö
$str
ö ¶
,
¶ ß
-
ß ®
$num
® ©
}
© ™
"
™ ´
)
´ ¨
)
¨ ≠
)
≠ Æ
)
Æ Ø
;
Ø ∞
foreach 
( 
var 
item 
in  
appointmentList! 0
.0 1"
ItemContainerGenerator1 G
.G H
ItemsH M
)M N
{ 
var 
temp 
= 
item 
as  "
AppointmentModel# 3
;3 4
fd 
. 
Blocks 
. 
Add 
( 
new !
	Paragraph" +
(+ ,
new, /
Run0 3
(3 4
String4 :
.: ;
Format; A
(A B
$"B D
{D E
tempE I
.I J
SubjectJ Q
,Q R
-R S
$numS U
}U V
{V W
tempW [
.[ \
AppointmentId\ i
,i j
-j k
$numk m
}m n
{n o
tempo s
.s t
BeginningDate	t Å
.
Å Ç
ToString
Ç ä
(
ä ã
$str
ã ù
)
ù û
,
û ü
-
ü †
$num
† ¢
}
¢ £
{
£ §
temp
§ ®
.
® ©

EndingDate
© ≥
.
≥ ¥
ToString
¥ º
(
º Ω
$str
Ω œ
)
œ –
,
– —
-
— “
$num
“ ‘
}
‘ ’
{
’ ÷
temp
÷ ⁄
.
⁄ €
Room
€ ﬂ
,
ﬂ ‡
-
‡ ·
$num
· „
}
„ ‰
{
‰ Â
temp
Â È
.
È Í
Users
Í Ô
.
Ô 
Count
 ı
,
ı ˆ
-
ˆ ˜
$num
˜ ¯
}
¯ ˘
"
˘ ˙
)
˙ ˚
)
˚ ¸
)
¸ ˝
)
˝ ˛
;
˛ ˇ
}   $
IDocumentPaginatorSource!! $
dps!!% (
=!!) *
fd!!+ -
;!!- .
var"" 
result"" 
="" 
pd"" 
."" 

ShowDialog"" &
(""& '
)""' (
;""( )
if## 
(## 
(## 
bool## 
)## 
result## 
)## 
{$$ 
pd%% 
.%% 
PrintDocument%%  
(%%  !
dps%%! $
.%%$ %
DocumentPaginator%%% 6
,%%6 7
$str%%8 A
)%%A B
;%%B C
}&& 
}'' 	
public)) 
static)) 
void)) 
PrintAppointment)) +
())+ ,
AppointmentModel)), <
appointment))= H
)))H I
{** 	
PrintDialog,, 
pd,, 
=,, 
new,,  
PrintDialog,,! ,
(,,, -
),,- .
;,,. /
FlowDocument-- 
fd-- 
=-- 
new-- !
FlowDocument--" .
(--. /
)--/ 0
;--0 1
fd.. 
... 

FontFamily.. 
=.. 
new.. 

FontFamily..  *
(..* +
$str..+ 8
)..8 9
;..9 :
fd// 
.// 
FontSize// 
=// 
$num// 
;// 
fd00 
.00 
PagePadding00 
=00 
new00  
	Thickness00! *
(00* +
$num00+ -
)00- .
;00. /
fd11 
.11 
	ColumnGap11 
=11 
$num11 
;11 
fd22 
.22 
ColumnWidth22 
=22 
pd22 
.22  
PrintableAreaWidth22  2
;222 3
fd33 
.33 
Blocks33 
.33 
Add33 
(33 
new33 
	Paragraph33 '
(33' (
new33( +
Run33, /
(33/ 0
String330 6
.336 7
Format337 =
(33= >
$"33> @
{33@ A
$str33A K
,33K L
-33L M
$num33M O
}33O P
{33P Q
appointment33Q \
.33\ ]
Subject33] d
,33d e
-33e f
$num33f h
}33h i
"33i j
)33j k
)33k l
)33l m
)33m n
;33n o
fd44 
.44 
Blocks44 
.44 
Add44 
(44 
new44 
	Paragraph44 '
(44' (
new44( +
Run44, /
(44/ 0
String440 6
.446 7
Format447 =
(44= >
$"44> @
{44@ A
$str44A M
,44M N
-44N O
$num44O Q
}44Q R
{44R S
appointment44S ^
.44^ _
AppointmentId44_ l
,44l m
-44m n
$num44n p
}44p q
"44q r
)44r s
)44s t
)44t u
)44u v
;44v w
fd55 
.55 
Blocks55 
.55 
Add55 
(55 
new55 
	Paragraph55 '
(55' (
new55( +
Run55, /
(55/ 0
String550 6
.556 7
Format557 =
(55= >
$"55> @
{55@ A
$str55A R
,55R S
-55S T
$num55T V
}55V W
{55W X
appointment55X c
.55c d
BeginningDate55d q
.55q r
ToString55r z
(55z {
$str	55{ é
)
55é è
,
55è ê
-
55ê ë
$num
55ë ì
}
55ì î
"
55î ï
)
55ï ñ
)
55ñ ó
)
55ó ò
)
55ò ô
;
55ô ö
fd66 
.66 
Blocks66 
.66 
Add66 
(66 
new66 
	Paragraph66 '
(66' (
new66( +
Run66, /
(66/ 0
String660 6
.666 7
Format667 =
(66= >
$"66> @
{66@ A
$str66A O
,66O P
-66P Q
$num66Q S
}66S T
{66T U
appointment66U `
.66` a

EndingDate66a k
.66k l
ToString66l t
(66t u
$str	66u à
)
66à â
,
66â ä
-
66ä ã
$num
66ã ç
}
66ç é
"
66é è
)
66è ê
)
66ê ë
)
66ë í
)
66í ì
;
66ì î
fd77 
.77 
Blocks77 
.77 
Add77 
(77 
new77 
	Paragraph77 '
(77' (
new77( +
Run77, /
(77/ 0
String770 6
.776 7
Format777 =
(77= >
$"77> @
{77@ A
$str77A L
,77L M
-77M N
$num77N P
}77P Q
{77Q R
appointment77R ]
.77] ^
Room77^ b
,77b c
-77c d
$num77d f
}77f g
"77g h
)77h i
)77i j
)77j k
)77k l
;77l m
fd88 
.88 
Blocks88 
.88 
Add88 
(88 
new88 
	Paragraph88 '
(88' (
new88( +
Run88, /
(88/ 0
$str880 >
)88> ?
)88? @
)88@ A
;88A B
foreach99 
(99 
var99 
item99 
in99  
appointment99! ,
.99, -
Users99- 2
)992 3
{:: 
fd;; 
.;; 
Blocks;; 
.;; 
Add;; 
(;; 
new;; !
	Paragraph;;" +
(;;+ ,
new;;, /
Run;;0 3
(;;3 4
String;;4 :
.;;: ;
Format;;; A
(;;A B
$";;B D
{;;D E
$str;;E L
,;;L M
-;;N O
$num;;O P
};;P Q
{;;Q R
item;;R V
.;;V W
Name;;W [
,;;[ \
-;;] ^
$num;;^ `
};;` a
";;a b
);;b c
);;c d
);;d e
);;e f
;;;f g
}<< $
IDocumentPaginatorSource== $
dps==% (
===) *
fd==+ -
;==- .
var>> 
result>> 
=>> 
pd>> 
.>> 

ShowDialog>> &
(>>& '
)>>' (
;>>( )
if?? 
(?? 
(?? 
bool?? 
)?? 
result?? 
)?? 
{@@ 
pdAA 
.AA 
PrintDocumentAA  
(AA  !
dpsAA! $
.AA$ %
DocumentPaginatorAA% 6
,AA6 7
$strAA8 A
)AAA B
;AAB C
}BB 
}CC 	
}DD 
}EE Å
WC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Helpers\WindowType.cs
	namespace 	
	ViewModel
 
. 
Helpers 
{ 
public 

enum 

WindowType 
{ 
AddAppWindow 
, %
AddAboutAppointmentWindow !
,! "%
AddAllAppByLocationWindow !
,! "
LoadLocations 
, 
Toast		 
,		 
Sync

 
,

 
CalendarFrame 
, 
None 
, 
Refresh 
} 
} ﬂF
\C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Models\AppointmentModel.cs
	namespace 	
	ViewModel
 
. 
Models 
{ 
[ 
Serializable 
] 
public		 

class		 
AppointmentModel		 !
:		" #
IDataErrorInfo		$ 2
,		2 3"
INotifyPropertyChanged		4 J
{

 
private 
string 
_subject 
;  
private 
int 
_locationId 
;  
private 
DateTime 
_beginningDate '
;' (
private 
DateTime 
_endingDate $
;$ %
private 
ICollection 
< 
UserDTO #
># $
_users% +
;+ ,
public 
int 
AppointmentId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Subject 
{ 	
get 
{ 
return 
_subject !
;! "
}# $
set 
{ 
_subject 
= 
value  
;  !!
NotifyPropertyChanged %
(% &
$str& /
)/ 0
;0 1
} 
} 	
public 
DateTime 
BeginningDate %
{ 	
get 
{ 
return 
_beginningDate '
;' (
}) *
set 
{ 
_beginningDate   
=    
value  ! &
;  & '!
NotifyPropertyChanged!! %
(!!% &
$str!!& 5
)!!5 6
;!!6 7
}"" 
}## 	
public$$ 
DateTime$$ 

EndingDate$$ "
{%% 	
get&& 
{&& 
return&& 
_endingDate&& $
;&&$ %
}&&& '
set'' 
{(( 
_endingDate)) 
=)) 
value)) #
;))# $!
NotifyPropertyChanged** %
(**% &
$str**& 2
)**2 3
;**3 4
}++ 
},, 	
public-- 
int-- 

LocationId-- 
{.. 	
get// 
{// 
return// 
_locationId// $
;//$ %
}//& '
set00 
{11 
_locationId22 
=22 
value22 #
;22# $!
NotifyPropertyChanged33 %
(33% &
$str33& 2
)332 3
;333 4
}44 
}55 	
public66 
string66 
Room66 
{66 
get66  
;66  !
set66" %
;66% &
}66' (
public77 
ICollection77 
<77 
UserDTO77 "
>77" #
Users77$ )
{88 	
get99 
{99 
return99 
_users99 
;99  
}99! "
set:: 
{;; 
_users<< 
=<< 
value<< 
;<< !
NotifyPropertyChanged== %
(==% &
$str==& -
)==- .
;==. /
}>> 
}?? 	
publicAA 
AppointmentModelAA 
(AA  
)AA  !
{BB 	
}DD 	
stringGG 
IDataErrorInfoGG 
.GG 
ErrorGG #
{HH 	
getII 
{JJ 
returnKK 
nullKK 
;KK 
}LL 
}MM 	
stringOO 
IDataErrorInfoOO 
.OO 
thisOO "
[OO" #
stringOO# )
propertyNameOO* 6
]OO6 7
{PP 	
getQQ 
{QQ 
returnQQ 
GetValidationErrorQQ +
(QQ+ ,
propertyNameQQ, 8
)QQ8 9
;QQ9 :
}QQ; <
}RR 	
staticVV 
readonlyVV 
stringVV 
[VV 
]VV  
ValidatedPropertiesVV! 4
=VV5 6
{WW 	
$strXX 
,XX 
$strXX 
,XX 
$strXX  ,
,XX, -
$strXX. =
}YY 	
;YY	 

public[[ 
bool[[ 
IsValid[[ 
{\\ 	
get]] 
{^^ 
foreach__ 
(__ 
var__ 
property__ %
in__& (
ValidatedProperties__) <
)__< =
{`` 
ifaa 
(aa 
GetValidationErroraa *
(aa* +
propertyaa+ 3
)aa3 4
!=aa5 7
nullaa8 <
)aa< =
{bb 
returncc 
falsecc $
;cc$ %
}dd 
}ee 
returnff 
trueff 
;ff 
}gg 
}hh 	
stringjj 
GetValidationErrorjj !
(jj! "
stringjj" (
propertyNamejj) 5
)jj5 6
{kk 	
stringll 
errorll 
=ll 
nullll 
;ll  
switchnn 
(nn 
propertyNamenn  
)nn  !
{oo 
casepp 
$strpp 
:pp 
errorqq 
=qq 
ValidateSubjectqq +
(qq+ ,
)qq, -
;qq- .
breakrr 
;rr 
casett 
$strtt 
:tt 
erroruu 
=uu 
ValidateUsersuu )
(uu) *
)uu* +
;uu+ ,
breakvv 
;vv 
casexx 
$strxx !
:xx! "
erroryy 
=yy 
ValidateLocationIdyy .
(yy. /
)yy/ 0
;yy0 1
breakzz 
;zz 
case|| 
$str|| $
:||$ %
error}} 
=}} !
ValidateBeginningDate}} 1
(}}1 2
)}}2 3
;}}3 4
break~~ 
;~~ 
} 
return
ÅÅ 
error
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
private
ÖÖ 
string
ÖÖ #
ValidateBeginningDate
ÖÖ ,
(
ÖÖ, -
)
ÖÖ- .
{
ÜÜ 	
if
áá 
(
áá 
BeginningDate
áá 
>=
áá  

EndingDate
áá! +
)
áá+ ,
{
àà 
return
ââ 
$str
ââ 9
;
ââ9 :
}
ää 
return
ãã 
null
ãã 
;
ãã 
}
åå 	
private
çç 
string
çç  
ValidateLocationId
çç )
(
çç) *
)
çç* +
{
éé 	
if
èè 
(
èè 

LocationId
èè 
==
èè 
$num
èè 
||
èè  "

LocationId
èè# -
<
èè. /
$num
èè0 1
)
èè1 2
{
êê 
return
ëë 
$str
ëë )
;
ëë) *
}
íí 
return
ìì 
null
ìì 
;
ìì 
}
îî 	
private
ïï 
string
ïï 
ValidateUsers
ïï $
(
ïï$ %
)
ïï% &
{
ññ 	
if
óó 
(
óó 
Users
óó 
.
óó 
Count
óó 
==
óó 
$num
óó  
)
óó  !
{
òò 
return
ôô 
$str
ôô 4
;
ôô4 5
}
öö 
return
õõ 
null
õõ 
;
õõ 
}
úú 	
private
ùù 
string
ùù 
ValidateSubject
ùù &
(
ùù& '
)
ùù' (
{
ûû 	
if
üü 
(
üü 
String
üü 
.
üü  
IsNullOrWhiteSpace
üü )
(
üü) *
Subject
üü* 1
)
üü1 2
)
üü2 3
{
†† 
return
°° 
$str
°° 2
;
°°2 3
}
¢¢ 
if
££ 
(
££ 
Subject
££ 
.
££ 
Length
££ 
>
££  
$num
££! #
)
££# $
{
§§ 
return
•• 
$str
•• @
;
••@ A
}
¶¶ 
return
ßß 
null
ßß 
;
ßß 
}
®® 	
[
¨¨ 	
field
¨¨	 
:
¨¨ 
NonSerialized
¨¨ 
]
¨¨ 
public
≠≠ 
event
≠≠ )
PropertyChangedEventHandler
≠≠ 0
PropertyChanged
≠≠1 @
;
≠≠@ A
public
ÆÆ 
void
ÆÆ #
NotifyPropertyChanged
ÆÆ )
(
ÆÆ) *
String
ÆÆ* 0
propertyName
ÆÆ1 =
)
ÆÆ= >
{
ØØ 	
if
∞∞ 
(
∞∞ 
PropertyChanged
∞∞ 
!=
∞∞  "
null
∞∞# '
)
∞∞' (
{
±± 
PropertyChanged
≤≤ 
(
≤≤  
this
≤≤  $
,
≤≤$ %
new
≤≤& )&
PropertyChangedEventArgs
≤≤* B
(
≤≤B C
propertyName
≤≤C O
)
≤≤O P
)
≤≤P Q
;
≤≤Q R
}
≥≥ 
}
¥¥ 	
}
∂∂ 
}∑∑ Í0
VC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Models\GroupModel.cs
	namespace

 	
	ViewModel


 
.

 
Models

 
{ 
public 

class 

GroupModel 
: "
INotifyPropertyChanged 4
,4 5
IDataErrorInfo6 D
{ 
public 
int 
GroupId 
{ 
get  
;  !
set" %
;% &
}' (
private 
string 

_groupName !
;! "
private 
string 
_parentName "
;" #
private 
string 
_creatorName #
;# $
private 
int 
? 
	_parentId 
; 
private 
int 

_creatorId 
; 
private  
ObservableCollection $
<$ %

GroupModel% /
>/ 0
_groups1 8
;8 9
private  
ObservableCollection $
<$ %
UserDTO% ,
>, -
_users. 4
;4 5
public 

GroupModel 
( 
) 
{ 	
_users 
= 
new  
ObservableCollection -
<- .
UserDTO. 5
>5 6
(6 7
)7 8
;8 9
_groups 
= 
new  
ObservableCollection .
<. /

GroupModel/ 9
>9 :
(: ;
); <
;< =
} 	
public 
int 
? 
ParentId 
{ 	
get   
=>   
	_parentId   
;   
set!! 
{"" 
	_parentId## 
=## 
value## !
;##! "!
NotifyPropertyChanged$$ %
($$% &
$str$$& 0
)$$0 1
;$$1 2
}%% 
}&& 	
public(( 
string(( 
	GroupName(( 
{)) 	
get** 
=>** 

_groupName** 
;** 
set++ 
{,, 
if-- 
(-- 
value-- 
!=-- 
string-- !
.--! "
Empty--" '
)--' (
{.. 

_groupName// 
=//  
value//! &
;//& '!
NotifyPropertyChanged00 )
(00) *
$str00* 5
)005 6
;006 7
}11 
}22 
}33 	
public55 
string55 

ParentName55  
{66 	
get77 
=>77 
_parentName77 
;77 
set88 
{99 
_parentName:: 
=:: 
value:: #
;::# $!
NotifyPropertyChanged;; %
(;;% &
$str;;& 2
);;2 3
;;;3 4
}<< 
}== 	
public?? 
string?? 
CreatorName?? !
{@@ 	
getAA 
=>AA 
_creatorNameAA 
;AA  
setBB 
{CC 
_creatorNameDD 
=DD 
valueDD $
;DD$ %!
NotifyPropertyChangedEE %
(EE% &
$strEE& 3
)EE3 4
;EE4 5
}FF 
}GG 	
publicII 
intII 
	CreatorIdII 
{JJ 	
getKK 
=>KK 

_creatorIdKK 
;KK 
setLL 
{MM 

_creatorIdNN 
=NN 
valueNN "
;NN" #!
NotifyPropertyChangedOO %
(OO% &
$strOO& 1
)OO1 2
;OO2 3
}PP 
}QQ 	
publicSS  
ObservableCollectionSS #
<SS# $
UserDTOSS$ +
>SS+ ,
UsersSS- 2
{TT 	
getUU 
=>UU 
_usersUU 
;UU 
setVV 
{WW 
ifXX 
(XX 
valueXX 
!=XX 
nullXX !
)XX! "
{YY 
_usersZZ 
=ZZ 
valueZZ "
;ZZ" #!
NotifyPropertyChanged[[ )
([[) *
$str[[* 1
)[[1 2
;[[2 3
}\\ 
}]] 
}^^ 	
public``  
ObservableCollection`` #
<``# $

GroupModel``$ .
>``. /
Groups``0 6
{aa 	
getbb 
=>bb 
_groupsbb 
;bb 
setcc 
{dd 
_groupsee 
=ee 
valueee 
;ee  !
NotifyPropertyChangedff %
(ff% &
$strff& .
)ff. /
;ff/ 0
}gg 
}hh 	
publicll 
eventll '
PropertyChangedEventHandlerll 0
PropertyChangedll1 @
;ll@ A
publicmm 
voidmm !
NotifyPropertyChangedmm )
(mm) *
Stringmm* 0
propertyNamemm1 =
)mm= >
{nn 	
ifoo 
(oo 
PropertyChangedoo 
!=oo  "
nulloo# '
)oo' (
{pp 
PropertyChangedqq 
(qq  
thisqq  $
,qq$ %
newqq& )$
PropertyChangedEventArgsqq* B
(qqB C
propertyNameqqC O
)qqO P
)qqP Q
;qqQ R
}rr 
}ss 	
publicww 
stringww 
Errorww 
{ww 
getww !
=>ww" $
nullww% )
;ww) *
}ww+ ,
publicyy 
stringyy 
thisyy 
[yy 
stringyy !

columnNameyy" ,
]yy, -
{zz 	
get{{ 
{|| 
if}} 
(}} 

columnName}} 
==}} !
$str}}" -
)}}- .
{~~ 
if 
( 
string 
. 
IsNullOrEmpty ,
(, -
	GroupName- 6
)6 7
)7 8
return
ÄÄ 
$str
ÄÄ 6
;
ÄÄ6 7
}
ÅÅ 
return
ÉÉ 
null
ÉÉ 
;
ÉÉ 
}
ÑÑ 
}
ÖÖ 	
}
ÜÜ 
}áá ¡
TC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Models\LogModel.cs
	namespace 	
	ViewModel
 
. 
Models 
{		 
public

 

class

 
LogModel

 
:

 "
INotifyPropertyChanged

 2
{ 
public 
int 
LogId 
{ 
get 
; 
set  #
;# $
}% &
private 
string 
_action 
{  
get! $
;$ %
set& )
;) *
}+ ,
private 
string 
_appointmentName '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
private 
string 
_actionAuthorName (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
private 
string 
_creatorName #
{$ %
get& )
;) *
set+ .
;. /
}0 1
private 
DateTime 

_eventTime #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
Action 
{ 	
get 
=> 
_action 
; 
set 
{ 
_action 
= 
value 
;  !
NotifyPropertyChanged %
(% &
$str& .
). /
;/ 0
} 
} 	
public 
string 
AppointmentName %
{ 	
get 
=> 
_appointmentName #
;# $
set   
{!! 
_appointmentName""  
=""! "
value""# (
;""( )!
NotifyPropertyChanged## %
(##% &
$str##& 7
)##7 8
;##8 9
}$$ 
}%% 	
public'' 
string'' 
ActionAuthorName'' &
{(( 	
get)) 
=>)) 
_actionAuthorName)) $
;))$ %
set** 
{++ 
_actionAuthorName,, !
=,," #
value,,$ )
;,,) *!
NotifyPropertyChanged-- %
(--% &
$str--& 8
)--8 9
;--9 :
}.. 
}// 	
public11 
string11 
CreatorName11 !
{22 	
get33 
=>33 
_creatorName33 
;33  
set44 
{55 
_creatorName66 
=66 
value66 $
;66$ %!
NotifyPropertyChanged77 %
(77% &
$str77& 3
)773 4
;774 5
}88 
}99 	
public;; 
DateTime;; 
	EventTime;; !
{<< 	
get== 
=>== 

_eventTime== 
;== 
set>> 
{?? 

_eventTime@@ 
=@@ 
value@@ "
;@@" #!
NotifyPropertyChangedAA %
(AA% &
$strAA& 1
)AA1 2
;AA2 3
}BB 
}CC 	
publicFF 
eventFF '
PropertyChangedEventHandlerFF 0
PropertyChangedFF1 @
;FF@ A
publicGG 
voidGG !
NotifyPropertyChangedGG )
(GG) *
StringGG* 0
propertyNameGG1 =
)GG= >
{HH 	
ifII 
(II 
PropertyChangedII 
!=II  "
nullII# '
)II' (
{JJ 
PropertyChangedKK 
(KK  
thisKK  $
,KK$ %
newKK& )$
PropertyChangedEventArgsKK* B
(KKB C
propertyNameKKC O
)KKO P
)KKP Q
;KKQ R
}LL 
}MM 	
}OO 
}PP ¢6
UC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Models\UserModel.cs
	namespace

 	
	ViewModel


 
.

 
Models

 
{ 
public 

class 
	UserModel 
: "
INotifyPropertyChanged 3
,3 4
IDataErrorInfo5 C
{ 
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
private 
bool 
	_isActive 
; 
private 
string 
_name 
; 
private 
string 
	_userName  
;  !
private 
string 
	_password  
;  !
private  
ObservableCollection $
<$ %
GroupDTO% -
>- .
_groups/ 6
;6 7
private  
ObservableCollection $
<$ %
RoleDTO% ,
>, -
_roles. 4
;4 5
private  
ObservableCollection $
<$ %
AppointmentDTO% 3
>3 4
_appointments5 B
;B C
public 
	UserModel 
( 
) 
{ 	
_groups 
= 
new  
ObservableCollection .
<. /
GroupDTO/ 7
>7 8
(8 9
)9 :
;: ;
_roles 
= 
new  
ObservableCollection -
<- .
RoleDTO. 5
>5 6
(6 7
)7 8
;8 9
_appointments 
= 
new  
ObservableCollection  4
<4 5
AppointmentDTO5 C
>C D
(D E
)E F
;F G
} 	
public 
bool 
IsActive 
{   	
get!! 
=>!! 
	_isActive!! 
;!! 
set"" 
{## 
	_isActive$$ 
=$$ 
value$$ !
;$$! "!
NotifyPropertyChanged%% %
(%%% &
$str%%& 0
)%%0 1
;%%1 2
}&& 
}'' 	
public)) 
string)) 
Name)) 
{** 	
get++ 
=>++ 
_name++ 
;++ 
set,, 
{-- 
_name.. 
=.. 
value.. 
;.. !
NotifyPropertyChanged// %
(//% &
$str//& ,
)//, -
;//- .
}00 
}11 	
public33 
string33 
UserName33 
{44 	
get55 
=>55 
	_userName55 
;55 
set66 
{77 
if88 
(88 
value88 
!=88 
string88 #
.88# $
Empty88$ )
)88) *
{99 
	_userName:: 
=:: 
value::  %
;::% &!
NotifyPropertyChanged;; )
(;;) *
$str;;* 4
);;4 5
;;;5 6
}<< 
}== 
}>> 	
public@@ 
string@@ 
Password@@ 
{AA 	
getBB 
=>BB 
	_passwordBB 
;BB 
setCC 
{DD 
ifEE 
(EE 
valueEE 
!=EE 
stringEE "
.EE" #
EmptyEE# (
)EE( )
{FF 
	_passwordGG 
=GG 
valueGG  %
;GG% &!
NotifyPropertyChangedHH )
(HH) *
$strHH* 4
)HH4 5
;HH5 6
}II 
}JJ 
}KK 	
publicMM  
ObservableCollectionMM #
<MM# $
GroupDTOMM$ ,
>MM, -
GroupsMM. 4
{NN 	
getOO 
=>OO 
_groupsOO 
;OO 
setPP 
{QQ 
_groupsRR 
=RR 
valueRR 
;RR  !
NotifyPropertyChangedSS %
(SS% &
$strSS& .
)SS. /
;SS/ 0
}TT 
}UU 	
publicWW  
ObservableCollectionWW #
<WW# $
RoleDTOWW$ +
>WW+ ,
RolesWW- 2
{XX 	
getYY 
=>YY 
_rolesYY 
;YY 
setZZ 
{[[ 
_roles\\ 
=\\ 
value\\ 
;\\ !
NotifyPropertyChanged]] %
(]]% &
$str]]& -
)]]- .
;]]. /
}^^ 
}__ 	
publicaa  
ObservableCollectionaa #
<aa# $
AppointmentDTOaa$ 2
>aa2 3
Appointmentsaa4 @
{bb 	
getcc 
=>cc 
_appointmentscc  
;cc  !
setdd 
{ee 
_appointmentsff 
=ff 
valueff  %
;ff% &!
NotifyPropertyChangedgg %
(gg% &
$strgg& 4
)gg4 5
;gg5 6
}hh 
}ii 	
publicll 
eventll '
PropertyChangedEventHandlerll 0
PropertyChangedll1 @
;ll@ A
publicmm 
voidmm !
NotifyPropertyChangedmm )
(mm) *
Stringmm* 0
propertyNamemm1 =
)mm= >
{nn 	
ifoo 
(oo 
PropertyChangedoo 
!=oo  "
nulloo# '
)oo' (
{pp 
PropertyChangedqq 
(qq  
thisqq  $
,qq$ %
newqq& )$
PropertyChangedEventArgsqq* B
(qqB C
propertyNameqqC O
)qqO P
)qqP Q
;qqQ R
}rr 
}ss 	
publicvv 
stringvv 
Errorvv 
{vv 
getvv !
=>vv" $
nullvv% )
;vv) *
}vv+ ,
publicxx 
stringxx 
thisxx 
[xx 
stringxx !

columnNamexx" ,
]xx, -
{yy 	
getzz 
{{{ 
if|| 
(|| 

columnName|| 
==|| !
$str||" ,
)||, -
{}} 
if~~ 
(~~ 
string~~ 
.~~ 
IsNullOrEmpty~~ ,
(~~, -
UserName~~- 5
)~~5 6
)~~6 7
return 
$str 5
;5 6
}
ÄÄ 
if
ÅÅ 
(
ÅÅ 

columnName
ÅÅ 
==
ÅÅ !
$str
ÅÅ" ,
)
ÅÅ, -
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
string
ÉÉ 
.
ÉÉ 
IsNullOrEmpty
ÉÉ ,
(
ÉÉ, -
Password
ÉÉ- 5
)
ÉÉ5 6
)
ÉÉ6 7
return
ÑÑ 
$str
ÑÑ 5
;
ÑÑ5 6
}
ÖÖ 
return
áá 
null
áá 
;
áá 
}
àà 
}
ââ 	
}
ää 
}ãã ‰C
UC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Notify\Scheduler.cs
	namespace		 	
	ViewModel		
 
.		 
Notify		 
{

 
public 

class 
NotifyEventArgs  
:! "
	EventArgs# ,
{ 
public 
int 
NotifyId 
{ 
get !
;! "
}# $
public 
NotifyEventArgs 
( 
int "
notifyId# +
)+ ,
{ 	
NotifyId 
= 
notifyId 
;  
} 	
} 
public 

static 
class 
	Scheduler !
{ 
public 
static 
EventHandler "
<" #
NotifyEventArgs# 2
>2 3
RemoveFromDataBase4 F
;F G
private 
static 
BackgroundWorker '
_notifyWorker( 5
;5 6
private 
static 
DispatcherTimer &
_notifyTimer' 3
;3 4
private 
static 
List 
< 
DispatcherTimer +
>+ ,
_timers- 4
;4 5
public 
static 
void 
ScheduleNotify )
() *
IEnumerable* 5
<5 6
NotificationDTO6 E
>E F
notificationsG T
)T U
{ 	
_timers 
= 
new 
List 
< 
DispatcherTimer .
>. /
(/ 0
)0 1
;1 2
EventHandler   
<   
NotifyEventArgs   (
>  ( )
removeFromDataBase  * <
=  = >
RemoveFromDataBase  ? Q
;  Q R
var!! 
missedNotify!! 
=!! 
new!! "
List!!# '
<!!' (
NotificationDTO!!( 7
>!!7 8
(!!8 9
)!!9 :
;!!: ;
foreach## 
(## 
var## 
notify## 
in##  "
notifications### 0
)##0 1
{$$ 
string%% 
notifyString%% #
=%%$ %
$"%%& (
{%%( )
notify%%) /
.%%/ 0
Subject%%0 7
}%%7 8
 from %%8 >
{%%> ?
notify%%? E
.%%E F
BeginningDate%%F S
}%%S T
 to %%T X
{%%X Y
notify%%Y _
.%%_ `

EndingDate%%` j
}%%j k
 at %%k o
{%%o p
notify%%p v
.%%v w
Room%%w {
}%%{ |
"%%| }
;%%} ~
if&& 
(&& 
notify&& 
.&& 
BeginningDate&& (
.&&( )

AddMinutes&&) 3
(&&3 4
-&&4 5
$num&&5 7
)&&7 8
>=&&9 ;
DateTime&&< D
.&&D E
Now&&E H
)&&H I
{'' 
_notifyTimer((  
=((! "
new((# &
DispatcherTimer((' 6
(((6 7
)((7 8
;((8 9
var** 
interval**  
=**! "
TimeSpan**# +
.**+ ,
	FromTicks**, 5
(**5 6
notify**6 <
.**< =
BeginningDate**= J
.**J K
Ticks**K P
-**Q R
DateTime**S [
.**[ \
Now**\ _
.**_ `
Ticks**` e
+**f g
TimeSpan**h p
.**p q
FromMinutes**q |
(**| }
-**} ~
$num	**~ Ä
)
**Ä Å
.
**Å Ç
Ticks
**Ç á
)
**á à
;
**à â
_notifyTimer++  
.++  !
Interval++! )
=++* +
interval++, 4
;++4 5
_notifyTimer--  
.--  !
Tick--! %
+=--& (
delegate--) 1
{.. 

MessageBox// "
.//" #
Show//# '
(//' (
notifyString//( 4
)//4 5
;//5 6
removeFromDataBase00 *
?00* +
.00+ ,
Invoke00, 2
(002 3
null003 7
,007 8
new009 <
NotifyEventArgs00= L
(00L M
notify00M S
.00S T
NotificationId00T b
)00b c
)00c d
;00d e
}11 
;11 
_timers33 
.33 
Add33 
(33  
_notifyTimer33  ,
)33, -
;33- .
_notifyWorker55 !
=55" #
new55$ '
BackgroundWorker55( 8
(558 9
)559 :
;55: ;
_notifyWorker66 !
.66! "
DoWork66" (
+=66) +
delegate66, 4
{77 
_notifyTimer88 $
?88$ %
.88% &
Start88& +
(88+ ,
)88, -
;88- .
}99 
;99 
_notifyWorker:: !
.::! "
RunWorkerAsync::" 0
(::0 1
)::1 2
;::2 3
};; 
if<< 
(<< 
DateTime<< 
.<< 
Now<<  
><<! "
notify<<# )
.<<) *
BeginningDate<<* 7
.<<7 8

AddMinutes<<8 B
(<<B C
-<<C D
$num<<D F
)<<F G
&&<<H J
DateTime<<K S
.<<S T
Now<<T W
<<<X Y
notify<<Z `
.<<` a
BeginningDate<<a n
)<<n o
{== 

MessageBox>> 
.>> 
Show>> #
(>># $
$">>$ &
{>>& '
notifyString>>' 3
}>>3 4$
 - you have little time!>>4 L
">>L M
)>>M N
;>>N O
removeFromDataBase?? &
???& '
.??' (
Invoke??( .
(??. /
null??/ 3
,??3 4
new??5 8
NotifyEventArgs??9 H
(??H I
notify??I O
.??O P
NotificationId??P ^
)??^ _
)??_ `
;??` a
}@@ 
ifAA 
(AA 
notifyAA 
.AA 
BeginningDateAA (
<AA) *
DateTimeAA+ 3
.AA3 4
NowAA4 7
)AA7 8
{BB 
missedNotifyCC  
.CC  !
AddCC! $
(CC$ %
notifyCC% +
)CC+ ,
;CC, -
removeFromDataBaseDD &
?DD& '
.DD' (
InvokeDD( .
(DD. /
nullDD/ 3
,DD3 4
newDD5 8
NotifyEventArgsDD9 H
(DDH I
notifyDDI O
.DDO P
NotificationIdDDP ^
)DD^ _
)DD_ `
;DD` a
}EE 
}FF 
ifGG 
(GG 
missedNotifyGG 
.GG 
CountGG "
>GG# $
$numGG% &
)GG& '
{HH 
stringII 
	missedAppII  
=II! "
StringII# )
.II) *
EmptyII* /
;II/ 0
forJJ 
(JJ 
intJJ 
iJJ 
=JJ 
$numJJ 
;JJ 
iJJ  !
<JJ" #
missedNotifyJJ$ 0
.JJ0 1
CountJJ1 6
;JJ6 7
iJJ8 9
++JJ9 ;
)JJ; <
{KK 
NotificationDTOLL #

infoNotifyLL$ .
=LL/ 0
missedNotifyLL1 =
.LL= >
	ElementAtLL> G
(LLG H
iLLH I
)LLI J
;LLJ K
stringMM 
finallyInfoMM &
=MM' (
$"NN 
{NN 

infoNotifyNN %
.NN% &
SubjectNN& -
}NN- .
 at NN. 2
{NN2 3

infoNotifyNN3 =
.NN= >
RoomNN> B
}NNB C
 from NNC I
{NNI J

infoNotifyNNJ T
.NNT U
BeginningDateNNU b
}NNb c
 to NNc g
{NNg h

infoNotifyNNh r
.NNr s

EndingDateNNs }
}NN} ~!
 - MISSED! \r\n \r\n	NN~ í
"
NNí ì
;
NNì î
	missedAppOO 
+=OO  
finallyInfoOO! ,
;OO, -
}PP 

MessageBoxQQ 
.QQ 
ShowQQ 
(QQ  
	missedAppQQ  )
)QQ) *
;QQ* +
}RR 
}SS 	
publicTT 
staticTT 
voidTT 
ShutdownTT #
(TT# $
)TT$ %
{UU 	
foreachVV 
(VV 
varVV 
timerVV 
inVV !
_timersVV" )
)VV) *
{WW 
timerXX 
.XX 
StopXX 
(XX 
)XX 
;XX 
}YY 
}ZZ 	
}[[ 
}\\ á
\C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str $
)$ %
]% &
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str &
)& '
]' (
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str <
)< =
]= >
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ú@
UC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModelLocator.cs
	namespace 	
	ViewModel
 
{ 
public 

class 
DesignTimeModule !
:" #
NinjectModule$ 1
{ 
public 
override 
void 
Load !
(! "
)" #
{ 	
} 	
} 
public 

class 
RunTimeModule 
:  
NinjectModule! .
{ 
public 
override 
void 
Load !
(! "
)" #
{ 	
Bind 
< 
WPFOutlookContext "
>" #
(# $
)$ %
.% &
ToSelf& ,
(, -
)- .
.. /
InSingletonScope/ ?
(? @
)@ A
.A B#
WithConstructorArgumentB Y
(Y Z
$strZ l
,l m
$str	n Å
)
Å Ç
;
Ç É
Bind   
(   
typeof   
(   
IGenericRepository   *
<  * +
>  + ,
)  , -
)  - .
.  . /
To  / 1
(  1 2
typeof  2 8
(  8 9
GenericRepository  9 J
<  J K
>  K L
)  L M
)  M N
.  N O
InSingletonScope  O _
(  _ `
)  ` a
;  a b
Bind!! 
<!! 
IBLLServiceMain!!  
>!!  !
(!!! "
)!!" #
.!!# $
To!!$ &
<!!& '
BLLServiceMain!!' 5
>!!5 6
(!!6 7
)!!7 8
.!!8 9
InSingletonScope!!9 I
(!!I J
)!!J K
;!!K L
Bind"" 
<"" "
IAuthenticationService"" '
>""' (
(""( )
)"") *
.""* +
To""+ -
<""- .!
AuthenticationService"". C
>""C D
(""D E
)""E F
.""F G
InSingletonScope""G W
(""W X
)""X Y
;""Y Z
Bind## 
<## "
IAdministrationService## '
>##' (
(##( )
)##) *
.##* +
To##+ -
<##- .!
AdministrationService##. C
>##C D
(##D E
)##E F
.##F G
InSingletonScope##G W
(##W X
)##X Y
;##Y Z
Bind$$ 
<$$ 
ILogService$$ 
>$$ 
($$ 
)$$ 
.$$  
To$$  "
<$$" #

LogService$$# -
>$$- .
($$. /
)$$/ 0
.$$0 1
InSingletonScope$$1 A
($$A B
)$$B C
;$$C D
Bind%% 
<%% 
INotifyService%% 
>%%  
(%%  !
)%%! "
.%%" #
To%%# %
<%%% &
NotifyService%%& 3
>%%3 4
(%%4 5
)%%5 6
.%%6 7
InSingletonScope%%7 G
(%%G H
)%%H I
;%%I J
}&& 	
}'' 
public)) 

class)) 
ViewModelLocator)) !
{** 
private++ 
readonly++ 
IKernel++  
_kernel++! (
;++( )
public-- 
MainWindowViewModel-- "

MainWindow--# -
=>--. 0
_kernel--1 8
.--8 9
Get--9 <
<--< =
MainWindowViewModel--= P
>--P Q
(--Q R
)--R S
;--S T
public.. !
AddAppWindowViewModel.. $
AddAppWindow..% 1
=>..2 4
_kernel..5 <
...< =
Get..= @
<..@ A!
AddAppWindowViewModel..A V
>..V W
(..W X
)..X Y
;..Y Z
public// +
AboutAppointmentWindowViewModel// .
AboutAppWindow/// =
=>//> @
_kernel//A H
.//H I
Get//I L
<//L M+
AboutAppointmentWindowViewModel//M l
>//l m
(//m n
)//n o
;//o p
public00 +
AllAppByLocationWindowViewModel00 .
AllAppByLocWindow00/ @
=>00A C
_kernel00D K
.00K L
Get00L O
<00O P+
AllAppByLocationWindowViewModel00P o
>00o p
(00p q
)00q r
;00r s
public11 
ToastListViewModel11 !
ToastWindow11" -
=>11. 0
_kernel111 8
.118 9
Get119 <
<11< =
ToastListViewModel11= O
>11O P
(11P Q
)11Q R
;11R S
public22 
SyncWindowViewModel22 "

SyncWindow22# -
=>22. 0
_kernel221 8
.228 9
Get229 <
<22< =
SyncWindowViewModel22= P
>22P Q
(22Q R
)22R S
;22S T
public33 #
AuthenticationViewModel33 &
	LoginPage33' 0
=>331 3
_kernel334 ;
.33; <
Get33< ?
<33? @#
AuthenticationViewModel33@ W
>33W X
(33X Y
)33Y Z
;33Z [
public44 #
AdministrationViewModel44 &
	AdminPage44' 0
=>441 3
_kernel444 ;
.44; <
Get44< ?
<44? @#
AdministrationViewModel44@ W
>44W X
(44X Y
)44Y Z
;44Z [
public55 
EditGroupViewModel55 !
EditGroupWindow55" 1
=>552 4
_kernel555 <
.55< =
Get55= @
<55@ A
EditGroupViewModel55A S
>55S T
(55T U
)55U V
;55V W
public66 "
ShowAllGroupsViewModel66 %
AllGroupsPageTest66& 7
=>668 :
_kernel66; B
.66B C
Get66C F
<66F G"
ShowAllGroupsViewModel66G ]
>66] ^
(66^ _
)66_ `
;66` a
public77 
AddGroupViewModel77  
AddGroupWindow77! /
=>770 2
_kernel773 :
.77: ;
Get77; >
<77> ?
AddGroupViewModel77? P
>77P Q
(77Q R
)77R S
;77S T
public88 
AddUserViewModel88 
AddUserWindow88  -
=>88. 0
_kernel881 8
.888 9
Get889 <
<88< =
AddUserViewModel88= M
>88M N
(88N O
)88O P
;88P Q
public99 
EditUserViewModel99  
EditUserWindow99! /
=>990 2
_kernel993 :
.99: ;
Get99; >
<99> ?
EditUserViewModel99? P
>99P Q
(99Q R
)99R S
;99S T
public:: !
ShowAllUsersViewModel:: $
AllUsersPage::% 1
=>::2 4
_kernel::5 <
.::< =
Get::= @
<::@ A!
ShowAllUsersViewModel::A V
>::V W
(::W X
)::X Y
;::Y Z
public;;  
ShowAllLogsViewModel;; #
AllLogsPage;;$ /
=>;;0 2
_kernel;;3 :
.;;: ;
Get;;; >
<;;> ? 
ShowAllLogsViewModel;;? S
>;;S T
(;;T U
);;U V
;;;V W
public<< #
CalendarWindowViewModel<< &
CalendarPage<<' 3
=><<4 6
_kernel<<7 >
.<<> ?
Get<<? B
<<<B C#
CalendarWindowViewModel<<C Z
><<Z [
(<<[ \
)<<\ ]
;<<] ^
public>> 
ViewModelLocator>> 
(>>  
)>>  !
{?? 	
if@@ 
(@@ 
ViewModelBase@@ 
.@@  
IsInDesignModeStatic@@ 2
)@@2 3
{AA 
_kernelBB 
=BB 
newBB 
StandardKernelBB ,
(BB, -
newBB- 0
DesignTimeModuleBB1 A
(BBA B
)BBB C
)BBC D
;BBD E
}CC 
elseDD 
{EE 
_kernelFF 
=FF 
newFF 
StandardKernelFF ,
(FF, -
newFF- 0
RunTimeModuleFF1 >
(FF> ?
)FF? @
)FF@ A
;FFA B
}GG 
}HH 	
}II 
}JJ ∂
sC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\ShowAllLogsViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Administration -
{ 
public 

class  
ShowAllLogsViewModel %
:% &
ViewModelBase' 4
{ 
private  
ObservableCollection $
<$ %
LogModel% -
>- .
_logs/ 4
;4 5
private "
IAdministrationService &"
_administrationService' =
;= >
public  
ObservableCollection #
<# $
LogModel$ ,
>, -
Logs. 2
{ 	
get 
=> 
_logs 
; 
set 
{ 
_logs 
= 
value 
; 
base 
.  
RaisePropertyChanged )
() *
)* +
;+ ,
} 
} 	
public  
ShowAllLogsViewModel #
(# $"
IAdministrationService$ :!
administrationService; P
)P Q
{ 	"
_administrationService   "
=  # $!
administrationService  % :
;  : ;
Logs!! 
=!! 
new!!  
ObservableCollection!! +
<!!+ ,
LogModel!!, 4
>!!4 5
(!!5 6
Mapper!!6 <
.!!< =
Map!!= @
<!!@ A
IEnumerable!!A L
<!!L M
LogDTO!!M S
>!!S T
,!!T U
ICollection!!V a
<!!a b
LogModel!!b j
>!!j k
>!!k l
(!!l m#
_administrationService	!!m É
.
!!É Ñ
GetLogs
!!Ñ ã
(
!!ã å
)
!!å ç
)
!!ç é
)
!!é è
;
!!è ê
}"" 	
}## 
}$$ ò
|C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Appointments\AboutAppointmentWindowViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Appointments +
{ 
public 

class +
AboutAppointmentWindowViewModel 0
:1 2
ViewModelBase3 @
{ 
private 
AppointmentModel  
_appointment! -
;- .
private 
LocationDTO 
	_location %
;% &
private 
RelayCommand 
< 
Window #
># $$
_printAppointmentCommand% =
;= >
public 
RelayCommand 
< 
Window "
>" ##
PrintAppointmentCommand$ ;
{ 	
get 
=> $
_printAppointmentCommand +
;+ ,
} 	
public 
LocationDTO 
Location #
{ 	
get 
=> 
	_location 
; 
private 
set 
{ 
if 
( 
value 
!= 
	_location &
)& '
{ 
	_location 
= 
value  %
;% &
base   
.    
RaisePropertyChanged   -
(  - .
)  . /
;  / 0
}!! 
}"" 
}## 	
private%% 
void%% 
PrintAppointment%% %
(%%% &
Window%%& ,
window%%- 3
)%%3 4
{&& 	
PrintHelper'' 
.'' 
PrintAppointment'' (
(''( )
_appointment'') 5
)''5 6
;''6 7
window(( 
.(( 
Close(( 
((( 
)(( 
;(( 
})) 	
public++ 
AppointmentModel++ 
Appointment++  +
{,, 	
get-- 
=>-- 
_appointment-- 
;--  
private.. 
set.. 
{// 
if00 
(00 
value00 
!=00 
_appointment00 )
)00) *
{11 
_appointment22  
=22! "
value22# (
;22( )
base33 
.33  
RaisePropertyChanged33 -
(33- .
)33. /
;33/ 0
}44 
}55 
}66 	
public88 +
AboutAppointmentWindowViewModel88 .
(88. /
IBLLServiceMain88/ >
service88? F
)88F G
{99 	
	Messenger:: 
.:: 
Default:: 
.:: 
Register:: &
<::& '
OpenWindowMessage::' 8
>::8 9
(::9 :
this::: >
,::> ?
message::@ G
=>::H J
{;; 
if<< 
(<< 
message<< 
.<< 
Argument<< $
==<<% '
$str<<( ?
)<<? @
{== 
Appointment>> 
=>>  !
message>>" )
.>>) *
Appointment>>* 5
;>>5 6
Location?? 
=?? 
service?? &
.??& '
GetLocationById??' 6
(??6 7
message??7 >
.??> ?
Appointment??? J
.??J K

LocationId??K U
)??U V
;??V W
	Messenger@@ 
.@@ 
Default@@ %
.@@% &

Unregister@@& 0
<@@0 1
OpenWindowMessage@@1 B
>@@B C
(@@C D
this@@D H
)@@H I
;@@I J
}AA 
}BB 
)BB 
;BB $
_printAppointmentCommandCC $
=CC% &
newCC' *
RelayCommandCC+ 7
<CC7 8
WindowCC8 >
>CC> ?
(CC? @
PrintAppointmentCC@ P
)CCP Q
;CCQ R
}DD 	
}EE 
}GG ÖŸ
rC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Appointments\AddAppWindowViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Appointments +
{ 
public 

class !
AddAppWindowViewModel &
:' (
ViewModelBase) 6
{ 
private 
readonly 
IBLLServiceMain (
_service) 1
;1 2
private 
readonly 
INotifyService '
_notifyService( 6
;6 7
private 
readonly 
ILogService $
_logService% 0
;0 1
private  
ObservableCollection $
<$ %
UserDTO% ,
>, -
	_userList. 7
;7 8
private  
ObservableCollection $
<$ %
UserDTO% ,
>, -
_selectedUserList. ?
;? @
private  
ObservableCollection $
<$ %
AppointmentModel% 5
>5 6
_templateApps7 D
;D E
private 
DateTime 
_parseStartDate (
;( )
private 
DateTime 
_parseEndingDate )
;) *
private 
DateTime "
_selectedBeginningTime /
;/ 0
private   
DateTime   
_selectedEndingTime   ,
;  , -
private!! 
DateTime!! 

_startDate!! #
=!!$ %
DateTime!!& .
.!!. /
Today!!/ 4
;!!4 5
private"" 
DateTime"" 
_endingDate"" $
=""% &
DateTime""' /
.""/ 0
Today""0 5
;""5 6
private## 
LocationDTO## 
_selectedLocation## -
;##- .
private$$ 
AppointmentModel$$  !
_selectedTemplateItem$$! 6
;$$6 7
private%% 
bool%% 
_allDayEvent%% !
;%%! "
private'' 
int'' 
Id'' 
{'' 
get'' 
;'' 
}'' 
public)) 
RelayCommand)) 
<)) 
Window)) "
>))" #
CreateAppCommand))$ 4
{))5 6
get))7 :
;)): ;
}))< =
public** 
RelayCommand** 
<** 
UserDTO** #
>**# $ 
AddUserToListCommand**% 9
{**: ;
get**< ?
;**? @
}**A B
public++ 
RelayCommand++ 
<++ 
UserDTO++ #
>++# $%
RemoveUserFromListCommand++% >
{++? @
get++A D
;++D E
}++F G
public--  
ObservableCollection-- #
<--# $
UserDTO--$ +
>--+ ,
SelectedUserList--- =
{.. 	
get// 
=>// 
_selectedUserList// $
;//$ %
set00 
{11 
if22 
(22 
value22 
!=22 
_selectedUserList22 .
)22. /
{33 
_selectedUserList44 %
=44& '
value44( -
;44- .
base55 
.55  
RaisePropertyChanged55 -
(55- .
)55. /
;55/ 0
}66 
}77 
}88 	
public99  
ObservableCollection99 #
<99# $
UserDTO99$ +
>99+ ,
UserList99- 5
{:: 	
get;; 
=>;; 
	_userList;; 
;;; 
private<< 
set<< 
{== 
if>> 
(>> 
value>> 
!=>> 
	_userList>> &
)>>& '
{?? 
	_userList@@ 
=@@ 
value@@  %
;@@% &
baseAA 
.AA  
RaisePropertyChangedAA -
(AA- .
)AA. /
;AA/ 0
}BB 
}CC 
}DD 	
publicEE  
ObservableCollectionEE #
<EE# $
AppointmentModelEE$ 4
>EE4 5
TemplateAppsEE6 B
{FF 	
getGG 
=>GG 
_templateAppsGG  
;GG  !
privateHH 
setHH 
{II 
ifJJ 
(JJ 
valueJJ 
!=JJ 
_templateAppsJJ *
)JJ* +
{KK 
_templateAppsLL !
=LL" #
valueLL$ )
;LL) *
baseMM 
.MM  
RaisePropertyChangedMM -
(MM- .
)MM. /
;MM/ 0
}NN 
}OO 
}PP 	
publicRR 
AppointmentModelRR 
AppointmentRR  +
{RR, -
getRR. 1
;RR1 2
setRR3 6
;RR6 7
}RR8 9
publicUU 
ListUU 
<UU 
DateTimeUU 
>UU 
BeginningTimeUU +
{UU, -
getUU. 1
;UU1 2
}UU3 4
publicVV 
ListVV 
<VV 
DateTimeVV 
>VV 

EndingTimeVV (
{VV) *
getVV+ .
;VV. /
}VV0 1
publicWW 
ListWW 
<WW 
LocationDTOWW 
>WW  
LocationListWW! -
{WW. /
getWW0 3
;WW3 4
}WW5 6
publicZZ 
AppointmentModelZZ  
SelectedTemplateItemZZ  4
{[[ 	
get\\ 
=>\\ !
_selectedTemplateItem\\ (
;\\( )
set]] 
{^^ !
_selectedTemplateItem__ %
=__& '
value__( -
;__- .
Appointment`` 
.`` 
Subject`` #
=``$ %
value``& +
.``+ ,
Subject``, 3
;``3 4
SelectedLocationaa  
=aa! "
LocationListaa# /
.aa/ 0
Firstaa0 5
(aa5 6
xaa6 7
=>aa8 :
xaa; <
.aa< =

LocationIdaa= G
==aaH J
valueaaK P
.aaP Q

LocationIdaaQ [
)aa[ \
;aa\ ]
StartBeginningDatebb "
=bb# $
valuebb% *
.bb* +
BeginningDatebb+ 8
;bb8 9
EndBeginningDatecc  
=cc! "
valuecc# (
.cc( )

EndingDatecc) 3
;cc3 4!
SelectedBeginningTimedd %
=dd& '
BeginningTimedd( 5
.dd5 6
Firstdd6 ;
(dd; <
xdd< =
=>dd> @
xee 
.ee 
Houree 
==ee 
valueee #
.ee# $
BeginningDateee$ 1
.ee1 2
Houree2 6
&&ee7 9
xee: ;
.ee; <
Minuteee< B
==eeC E
valueeeF K
.eeK L
BeginningDateeeL Y
.eeY Z
MinuteeeZ `
)ee` a
;eea b
SelectedEndingTimeff "
=ff# $
BeginningTimeff% 2
.ff2 3
Firstff3 8
(ff8 9
xff9 :
=>ff; =
xgg 
.gg 
Hourgg 
==gg 
valuegg #
.gg# $

EndingDategg$ .
.gg. /
Hourgg/ 3
&&gg4 6
xgg7 8
.gg8 9
Minutegg9 ?
==gg@ B
valueggC H
.ggH I

EndingDateggI S
.ggS T
MinuteggT Z
)ggZ [
;gg[ \
basehh 
.hh  
RaisePropertyChangedhh )
(hh) *
)hh* +
;hh+ ,
}ii 
}jj 	
publickk 
LocationDTOkk 
SelectedLocationkk +
{ll 	
getmm 
=>mm 
_selectedLocationmm $
;mm$ %
setnn 
{oo 
_selectedLocationpp !
=pp" #
valuepp$ )
;pp) *
baseqq 
.qq  
RaisePropertyChangedqq )
(qq) *
)qq* +
;qq+ ,
}rr 
}ss 	
publictt 
DateTimett 
StartBeginningDatett *
{uu 	
getvv 
=>vv 

_startDatevv 
;vv 
setww 
{xx 
ifyy 
(yy 
EndBeginningDateyy $
!=yy% '
valueyy( -
)yy- .
{zz 
EndBeginningDate{{ $
={{% &
value{{' ,
;{{, -
}|| 

_startDate}} 
=}} 
value}} "
;}}" #
base~~ 
.~~  
RaisePropertyChanged~~ )
(~~) *
)~~* +
;~~+ ,
} 
}
ÄÄ 	
public
ÅÅ 
DateTime
ÅÅ 
EndBeginningDate
ÅÅ (
{
ÇÇ 	
get
ÉÉ 
=>
ÉÉ 
_endingDate
ÉÉ 
;
ÉÉ 
set
ÑÑ 
{
ÖÖ 
_endingDate
ÜÜ 
=
ÜÜ 
value
ÜÜ #
;
ÜÜ# $
base
áá 
.
áá "
RaisePropertyChanged
áá )
(
áá) *
)
áá* +
;
áá+ ,
}
àà 
}
ââ 	
public
ää 
DateTime
ää #
SelectedBeginningTime
ää -
{
ãã 	
get
åå 
=>
åå $
_selectedBeginningTime
åå )
;
åå) *
set
çç 
{
éé $
_selectedBeginningTime
èè &
=
èè' (
value
èè) .
;
èè. /
base
êê 
.
êê "
RaisePropertyChanged
êê )
(
êê) *
)
êê* +
;
êê+ ,
}
ëë 
}
íí 	
public
ìì 
DateTime
ìì  
SelectedEndingTime
ìì *
{
îî 	
get
ïï 
=>
ïï !
_selectedEndingTime
ïï &
;
ïï& '
set
ññ 
{
óó !
_selectedEndingTime
òò #
=
òò$ %
value
òò& +
;
òò+ ,
base
ôô 
.
ôô "
RaisePropertyChanged
ôô )
(
ôô) *
)
ôô* +
;
ôô+ ,
}
öö 
}
õõ 	
public
úú 
bool
úú 
AllDayEvent
úú 
{
ùù 	
get
ûû 
=>
ûû 
_allDayEvent
ûû 
;
ûû  
set
üü 
{
†† 
_allDayEvent
°° 
=
°° 
value
°° $
;
°°$ %
base
¢¢ 
.
¢¢ "
RaisePropertyChanged
¢¢ )
(
¢¢) *
)
¢¢* +
;
¢¢+ ,
}
££ 
}
§§ 	
public
¶¶ #
AddAppWindowViewModel
¶¶ $
(
¶¶$ %
IBLLServiceMain
¶¶% 4
service
¶¶5 <
,
¶¶< =
ILogService
¶¶> I

logService
¶¶J T
,
¶¶T U
INotifyService
¶¶V d
notifyService
¶¶e r
)
¶¶r s
{
ßß 	
_service
®® 
=
®® 
service
®® 
;
®® 
_logService
©© 
=
©© 

logService
©© $
;
©©$ %
_notifyService
™™ 
=
™™ 
notifyService
™™ *
;
™™* +"
AddUserToListCommand
¨¨  
=
¨¨! "
new
¨¨# &
RelayCommand
¨¨' 3
<
¨¨3 4
UserDTO
¨¨4 ;
>
¨¨; <
(
¨¨< =
AddUsersToList
¨¨= K
)
¨¨K L
;
¨¨L M'
RemoveUserFromListCommand
≠≠ %
=
≠≠& '
new
≠≠( +
RelayCommand
≠≠, 8
<
≠≠8 9
UserDTO
≠≠9 @
>
≠≠@ A
(
≠≠A B!
RemoveUsersFromList
≠≠B U
)
≠≠U V
;
≠≠V W
CreateAppCommand
ÆÆ 
=
ÆÆ 
new
ÆÆ "
RelayCommand
ÆÆ# /
<
ÆÆ/ 0
Window
ÆÆ0 6
>
ÆÆ6 7
(
ÆÆ7 8
CreateAppointment
ÆÆ8 I
)
ÆÆI J
;
ÆÆJ K
UserList
∞∞ 
=
∞∞ 
new
∞∞ "
ObservableCollection
∞∞ /
<
∞∞/ 0
UserDTO
∞∞0 7
>
∞∞7 8
(
∞∞8 9
_service
∞∞9 A
.
∞∞A B
GetUsers
∞∞B J
(
∞∞J K
)
∞∞K L
)
∞∞L M
;
∞∞M N
SelectedUserList
±± 
=
±± 
new
±± ""
ObservableCollection
±±# 7
<
±±7 8
UserDTO
±±8 ?
>
±±? @
(
±±@ A
)
±±A B
;
±±B C
LocationList
≤≤ 
=
≤≤ 
_service
≤≤ #
.
≤≤# $
GetLocations
≤≤$ 0
(
≤≤0 1
)
≤≤1 2
.
≤≤2 3
ToList
≤≤3 9
(
≤≤9 :
)
≤≤: ;
;
≤≤; <
CustomPrincipal
¥¥ 
cp
¥¥ 
=
¥¥  
Thread
¥¥! '
.
¥¥' (
CurrentPrincipal
¥¥( 8
as
¥¥9 ;
CustomPrincipal
¥¥< K
;
¥¥K L
if
µµ 
(
µµ 
cp
µµ 
!=
µµ 
null
µµ 
)
µµ 
Id
µµ 
=
µµ  
cp
µµ! #
.
µµ# $
Identity
µµ$ ,
.
µµ, -
UserId
µµ- 3
;
µµ3 4
TemplateApps
∂∂ 
=
∂∂ 
new
∂∂ "
ObservableCollection
∂∂ 3
<
∂∂3 4
AppointmentModel
∂∂4 D
>
∂∂D E
(
∂∂E F
Mapper
∂∂F L
.
∂∂L M
Map
∂∂M P
<
∂∂P Q
IEnumerable
∂∂Q \
<
∂∂\ ]
AppointmentDTO
∂∂] k
>
∂∂k l
,
∂∂l m
ICollection
∂∂n y
<
∂∂y z
AppointmentModel∂∂z ä
>∂∂ä ã
>∂∂ã å
(∂∂å ç
_service∂∂ç ï
.∂∂ï ñ'
GetAppointmentsByUserId∂∂ñ ≠
(∂∂≠ Æ
Id∂∂Æ ∞
)∂∂∞ ±
)∂∂± ≤
)∂∂≤ ≥
;∂∂≥ ¥
Appointment
∏∏ 
=
∏∏ 
new
∏∏ 
AppointmentModel
∏∏ .
(
∏∏. /
)
∏∏/ 0
;
∏∏0 1
BeginningTime
∫∫ 
=
∫∫ 
LoadTimeRange
∫∫ )
(
∫∫) *
)
∫∫* +
;
∫∫+ ,

EndingTime
ªª 
=
ªª 
LoadTimeRange
ªª &
(
ªª& '
)
ªª' (
;
ªª( )#
SelectedBeginningTime
ºº !
=
ºº" #
BeginningTime
ºº$ 1
.
ºº1 2
Find
ºº2 6
(
ºº6 7
x
ºº7 8
=>
ºº9 ;
x
ºº< =
==
ºº> @
GetDateTimeNow
ººA O
(
ººO P
)
ººP Q
)
ººQ R
;
ººR S 
SelectedEndingTime
ΩΩ 
=
ΩΩ  
BeginningTime
ΩΩ! .
[
ΩΩ. /
BeginningTime
ΩΩ/ <
.
ΩΩ< =
IndexOf
ΩΩ= D
(
ΩΩD E#
SelectedBeginningTime
ΩΩE Z
)
ΩΩZ [
+
ΩΩ\ ]
$num
ΩΩ^ _
]
ΩΩ_ `
;
ΩΩ` a
SelectedLocation
ææ 
=
ææ 
LocationList
ææ +
[
ææ+ ,
$num
ææ, -
]
ææ- .
;
ææ. /
AllDayEvent
¿¿ 
=
¿¿ 
false
¿¿ 
;
¿¿  
AddUsersToList
¬¬ 
(
¬¬ 
UserList
¬¬ #
.
¬¬# $
FirstOrDefault
¬¬$ 2
(
¬¬2 3
s
¬¬3 4
=>
¬¬5 7
s
¬¬8 9
.
¬¬9 :
UserId
¬¬: @
==
¬¬A C
Id
¬¬D F
)
¬¬F G
)
¬¬G H
;
¬¬H I
}
√√ 	
public
≈≈ 
int
≈≈ 
GetLocationsCount
≈≈ $
(
≈≈$ %
)
≈≈% &
{
∆∆ 	
return
«« 
LocationList
«« 
.
««  
Count
««  %
;
««% &
}
»» 	
public
   
int
   
GetUsersCount
    
(
    !
)
  ! "
{
ÀÀ 	
return
ÃÃ 
UserList
ÃÃ 
.
ÃÃ 
Count
ÃÃ !
;
ÃÃ! "
}
ÕÕ 	
public
œœ 
DateTime
œœ 
GetDateTimeNow
œœ &
(
œœ& '
)
œœ' (
{
–– 	
var
—— 
dateTimeNow
—— 
=
—— 
DateTime
—— &
.
——& '
Now
——' *
.
——* +
Ticks
——+ 0
;
——0 1
var
““ 
	checkTime
““ 
=
““ 
new
““ 
DateTime
““  (
(
““( )
)
““) *
;
““* +
foreach
”” 
(
”” 
var
”” 
item
”” 
in
””  
BeginningTime
””! .
)
””. /
{
‘‘ 
if
’’ 
(
’’ 
dateTimeNow
’’ 
>
’’  !
item
’’" &
.
’’& '
Ticks
’’' ,
)
’’, -
{
÷÷ 
int
◊◊ 
nextTime
◊◊  
=
◊◊! "
BeginningTime
◊◊# 0
.
◊◊0 1
IndexOf
◊◊1 8
(
◊◊8 9
item
◊◊9 =
)
◊◊= >
+
◊◊? @
$num
◊◊A B
;
◊◊B C
	checkTime
ÿÿ 
=
ÿÿ 
nextTime
ÿÿ  (
<=
ÿÿ) +
BeginningTime
ÿÿ, 9
.
ÿÿ9 :
Count
ÿÿ: ?
?
ÿÿ@ A
BeginningTime
ÿÿB O
.
ÿÿO P
	ElementAt
ÿÿP Y
(
ÿÿY Z
nextTime
ÿÿZ b
)
ÿÿb c
:
ÿÿd e
BeginningTime
ÿÿf s
[
ÿÿs t
$num
ÿÿt u
]
ÿÿu v
;
ÿÿv w
}
ŸŸ 
}
⁄⁄ 
return
€€ 
	checkTime
€€ 
;
€€ 
}
‹‹ 	
private
ﬁﬁ 
List
ﬁﬁ 
<
ﬁﬁ 
DateTime
ﬁﬁ 
>
ﬁﬁ 
LoadTimeRange
ﬁﬁ ,
(
ﬁﬁ, -
)
ﬁﬁ- .
{
ﬂﬂ 	
var
‡‡ 
timeList
‡‡ 
=
‡‡ 
new
‡‡ 
List
‡‡ #
<
‡‡# $
DateTime
‡‡$ ,
>
‡‡, -
(
‡‡- .
)
‡‡. /
;
‡‡/ 0
DateTime
‚‚ 
day
‚‚ 
=
‚‚ 
new
‚‚ 
DateTime
‚‚ '
(
‚‚' (
DateTime
‚‚( 0
.
‚‚0 1
Now
‚‚1 4
.
‚‚4 5
Year
‚‚5 9
,
‚‚9 :
DateTime
‚‚; C
.
‚‚C D
Now
‚‚D G
.
‚‚G H
Month
‚‚H M
,
‚‚M N
DateTime
‚‚O W
.
‚‚W X
Now
‚‚X [
.
‚‚[ \
Day
‚‚\ _
,
‚‚_ `
$num
‚‚a c
,
‚‚c d
$num
‚‚e g
,
‚‚g h
$num
‚‚i k
)
‚‚k l
;
‚‚l m
DateTime
„„ 
day2
„„ 
=
„„ 
new
„„ 
DateTime
„„  (
(
„„( )
DateTime
„„) 1
.
„„1 2
Now
„„2 5
.
„„5 6
Year
„„6 :
,
„„: ;
DateTime
„„< D
.
„„D E
Now
„„E H
.
„„H I
Month
„„I N
,
„„N O
DateTime
„„P X
.
„„X Y
Now
„„Y \
.
„„\ ]
Day
„„] `
,
„„` a
$num
„„b d
,
„„d e
$num
„„f h
,
„„h i
$num
„„j l
)
„„l m
;
„„m n
for
‰‰ 
(
‰‰ 
TimeSpan
‰‰ 
i
‰‰ 
=
‰‰ 
day
‰‰ !
.
‰‰! "
	TimeOfDay
‰‰" +
;
‰‰+ ,
i
‰‰- .
<
‰‰/ 0
day2
‰‰1 5
.
‰‰5 6
	TimeOfDay
‰‰6 ?
;
‰‰? @
i
‰‰A B
+=
‰‰C E
TimeSpan
‰‰F N
.
‰‰N O
FromMinutes
‰‰O Z
(
‰‰Z [
$num
‰‰[ ]
)
‰‰] ^
)
‰‰^ _
{
ÂÂ 
timeList
ÊÊ 
.
ÊÊ 
Add
ÊÊ 
(
ÊÊ 
DateTime
ÊÊ %
.
ÊÊ% &
Parse
ÊÊ& +
(
ÊÊ+ ,
i
ÊÊ, -
.
ÊÊ- .
ToString
ÊÊ. 6
(
ÊÊ6 7
)
ÊÊ7 8
)
ÊÊ8 9
)
ÊÊ9 :
;
ÊÊ: ;
}
ÁÁ 
return
ËË 
timeList
ËË 
;
ËË 
}
ÈÈ 	
private
˝˝ 
void
˝˝ 
CreateAppointment
˝˝ &
(
˝˝& '
Window
˝˝' -
window
˝˝. 4
)
˝˝4 5
{
˛˛ 	
string
ˇˇ 
	startDate
ˇˇ 
;
ˇˇ 
string
ÄÄ 

endingDate
ÄÄ 
;
ÄÄ 
if
ÅÅ 
(
ÅÅ 
AllDayEvent
ÅÅ 
)
ÅÅ 
{
ÇÇ 
	startDate
ÉÉ 
=
ÉÉ 

_startDate
ÉÉ &
.
ÉÉ& '
ToString
ÉÉ' /
(
ÉÉ/ 0
CultureInfo
ÉÉ0 ;
.
ÉÉ; <
InvariantCulture
ÉÉ< L
)
ÉÉL M
;
ÉÉM N

endingDate
ÑÑ 
=
ÑÑ 

_startDate
ÑÑ '
.
ÑÑ' (
AddDays
ÑÑ( /
(
ÑÑ/ 0
$num
ÑÑ0 1
)
ÑÑ1 2
.
ÑÑ2 3

AddSeconds
ÑÑ3 =
(
ÑÑ= >
-
ÑÑ> ?
$num
ÑÑ? @
)
ÑÑ@ A
.
ÑÑA B
ToString
ÑÑB J
(
ÑÑJ K
CultureInfo
ÑÑK V
.
ÑÑV W
InvariantCulture
ÑÑW g
)
ÑÑg h
;
ÑÑh i
}
ÖÖ 
else
ÜÜ 
{
áá 
	startDate
àà 
=
àà 
$"
àà 
{
àà 

_startDate
àà )
.
àà) *
ToString
àà* 2
(
àà2 3
$str
àà3 6
,
àà6 7
CultureInfo
àà8 C
.
ààC D
InvariantCulture
ààD T
)
ààT U
}
ààU V
{
ààW X$
_selectedBeginningTime
ààX n
.
ààn o
ToString
àào w
(
ààw x
$strààx Å
,ààÅ Ç
CultureInfoààÉ é
.ààé è 
InvariantCultureààè ü
)ààü †
}àà† °
"àà° ¢
;àà¢ £

endingDate
ââ 
=
ââ 
$"
ââ 
{
ââ  
_endingDate
ââ  +
.
ââ+ ,
ToString
ââ, 4
(
ââ4 5
$str
ââ5 8
,
ââ8 9
CultureInfo
ââ: E
.
ââE F
InvariantCulture
ââF V
)
ââV W
}
ââW X
{
ââY Z!
_selectedEndingTime
ââZ m
.
ââm n
ToString
âân v
(
ââv w
$strââw Ä
,ââÄ Å
CultureInfoââÇ ç
.ââç é 
InvariantCultureââé û
)ââû ü
}ââü †
"ââ† °
;ââ° ¢
}
ää 
_parseStartDate
ãã 
=
ãã 
DateTime
ãã &
.
ãã& '
Parse
ãã' ,
(
ãã, -
	startDate
ãã- 6
,
ãã6 7
CultureInfo
ãã8 C
.
ããC D
InvariantCulture
ããD T
)
ããT U
;
ããU V
_parseEndingDate
åå 
=
åå 
DateTime
åå '
.
åå' (
Parse
åå( -
(
åå- .

endingDate
åå. 8
,
åå8 9
CultureInfo
åå: E
.
ååE F
InvariantCulture
ååF V
)
ååV W
;
ååW X
Appointment
éé 
.
éé 
BeginningDate
éé %
=
éé& '
_parseStartDate
éé( 7
;
éé7 8
Appointment
èè 
.
èè 

EndingDate
èè "
=
èè# $
_parseEndingDate
èè% 5
;
èè5 6
Appointment
êê 
.
êê 

LocationId
êê "
=
êê# $
SelectedLocation
êê% 5
.
êê5 6

LocationId
êê6 @
;
êê@ A
Appointment
ëë 
.
ëë 
Room
ëë 
=
ëë 
SelectedLocation
ëë /
.
ëë/ 0
Room
ëë0 4
;
ëë4 5
Appointment
íí 
.
íí 
Users
íí 
=
íí 
SelectedUserList
íí  0
;
íí0 1
var
ïï 
overlappingDates
ïï  
=
ïï! "
_service
ïï# +
.
ïï+ ,#
CheckOverlappingDates
ïï, A
(
ïïA B
_parseStartDate
ïïB Q
,
ïïQ R
_parseEndingDate
ïïS c
,
ïïc d
Appointment
ïïe p
.
ïïp q

LocationId
ïïq {
)
ïï{ |
;
ïï| }
if
óó 
(
óó 
Appointment
óó 
.
óó 
IsValid
óó #
&&
óó$ &
overlappingDates
óó' 7
==
óó8 :
$num
óó; <
)
óó< =
{
òò 
_logService
ôô 
.
ôô 
LogAppointment
ôô *
(
ôô* +
Mapper
ôô+ 1
.
ôô1 2
Map
ôô2 5
<
ôô5 6
AppointmentModel
ôô6 F
,
ôôF G
AppointmentDTO
ôôH V
>
ôôV W
(
ôôW X
Appointment
ôôX c
)
ôôc d
,
ôôd e
Id
ôôf h
,
ôôh i
true
ôôj n
)
ôôn o
;
ôôo p
_service
öö 
.
öö 
AddAppointment
öö '
(
öö' (
Mapper
öö( .
.
öö. /
Map
öö/ 2
<
öö2 3
AppointmentModel
öö3 C
,
ööC D
AppointmentDTO
ööE S
>
ööS T
(
ööT U
Appointment
ööU `
)
öö` a
,
ööa b
Id
ööc e
)
ööe f
;
ööf g
_notifyService
õõ 
.
õõ 
AddNotification
õõ .
(
õõ. /
Mapper
õõ/ 5
.
õõ5 6
Map
õõ6 9
<
õõ9 :
AppointmentModel
õõ: J
,
õõJ K
AppointmentDTO
õõL Z
>
õõZ [
(
õõ[ \
Appointment
õõ\ g
)
õõg h
,
õõh i
Id
õõj l
)
õõl m
;
õõm n
window
ùù 
.
ùù 
Close
ùù 
(
ùù 
)
ùù 
;
ùù 
	Messenger
ûû 
.
ûû 
Default
ûû !
.
ûû! "
Send
ûû" &
<
ûû& '!
NotificationMessage
ûû' :
,
ûû: ;!
MainWindowViewModel
ûû< O
>
ûûO P
(
ûûP Q
new
ûûQ T!
NotificationMessage
ûûU h
(
ûûh i
$str
ûûi r
)
ûûr s
)
ûûs t
;
ûût u
}
üü 
else
†† 
{
°° 

MessageBox
¢¢ 
.
¢¢ 
Show
¢¢ 
(
¢¢  
SelectedUserList
¢¢  0
.
¢¢0 1
Count
¢¢1 6
==
¢¢7 9
$num
¢¢: ;
?
££ 
$str
££ @
:
§§ 
$"
§§ S
EThe selected room is busy for the specified period of time! You have 
§§ ]
{
§§] ^
overlappingDates
§§^ n
}
§§n o
 intersections!
§§o ~
"
§§~ 
)§§ Ä
;§§Ä Å
}
•• 
}
¶¶ 	
private
®® 
void
®® 
AddUsersToList
®® #
(
®®# $
UserDTO
®®$ +
user
®®, 0
)
®®0 1
{
©© 	
if
™™ 
(
™™ 
user
™™ 
!=
™™ 
null
™™ 
)
™™ 
{
´´ 
SelectedUserList
¨¨  
.
¨¨  !
Add
¨¨! $
(
¨¨$ %
user
¨¨% )
)
¨¨) *
;
¨¨* +
UserList
≠≠ 
.
≠≠ 
Remove
≠≠ 
(
≠≠  
user
≠≠  $
)
≠≠$ %
;
≠≠% &
base
ÆÆ 
.
ÆÆ "
RaisePropertyChanged
ÆÆ )
(
ÆÆ) *
)
ÆÆ* +
;
ÆÆ+ ,
}
ØØ 
}
∞∞ 	
private
≤≤ 
void
≤≤ !
RemoveUsersFromList
≤≤ (
(
≤≤( )
UserDTO
≤≤) 0
user
≤≤1 5
)
≤≤5 6
{
≥≥ 	
if
¥¥ 
(
¥¥ 
user
¥¥ 
!=
¥¥ 
null
¥¥ 
)
¥¥ 
{
µµ 
UserList
∂∂ 
.
∂∂ 
Add
∂∂ 
(
∂∂ 
user
∂∂ !
)
∂∂! "
;
∂∂" #
SelectedUserList
∑∑  
.
∑∑  !
Remove
∑∑! '
(
∑∑' (
user
∑∑( ,
)
∑∑, -
;
∑∑- .
base
∏∏ 
.
∏∏ "
RaisePropertyChanged
∏∏ )
(
∏∏) *
)
∏∏* +
;
∏∏+ ,
}
ππ 
}
∫∫ 	
}
ªª 
}ºº Ò
vC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\AdministrationViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Administration -
{ 
public		 

class		 #
AdministrationViewModel		 (
:		) *
ViewModelBase		+ 8
,		8 9"
INotifyPropertyChanged		: P
{

 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
public #
AdministrationViewModel &
(& '"
IAdministrationService' =!
administrationService> S
)S T
{ 	"
_administrationService "
=# $!
administrationService% :
;: ;
} 	
public 
event '
PropertyChangedEventHandler 0
PropertyChanged1 @
;@ A
private 
void !
NotifyPropertyChanged *
(* +
string+ 1
propertyName2 >
)> ?
{ 	
if 
( 
PropertyChanged 
!=  "
null# '
)' (
PropertyChanged 
(  
this  $
,$ %
new& )$
PropertyChangedEventArgs* B
(B C
propertyNameC O
)O P
)P Q
;Q R
} 	
} 
} ª
hC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\TestShell\ShellViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
	TestShell (
{ 
public 

class 
ShellViewModel 
:  !
ViewModelBase" /
,/ 0"
INotifyPropertyChanged1 G
{ 
}		 
}

 ûç
yC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\CommonViewModels\Groups\AddGroupViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
CommonViewModels /
./ 0
Groups0 6
{ 
public 

class 
AddGroupViewModel "
:# $
ViewModelBase% 2
{ 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
private 
readonly 
CustomPrincipal (
_customPrincipal) 9
;9 :
private 
ICollection 
< 

GroupModel &
>& '!
_hiddenGroupAncestors( =
;= >
private 
ICollection 
< 

GroupModel &
>& '"
_groupsWithNoAncestors( >
;> ?
private  
ObservableCollection $
<$ %

GroupModel% /
>/ 0

_groupList1 ;
;; <
private  
ObservableCollection $
<$ %
UserDTO% ,
>, -
	_userList. 7
;7 8
private 
ICollection 
< 

GroupModel &
>& '
_groupsForComboBox( :
;: ;
public   
ICollection   
<   

GroupModel   %
>  % &
GroupsForComboBox  ' 8
{!! 	
get"" 
=>"" 
_groupsForComboBox"" %
;""% &
set## 
{$$ 
_groupsForComboBox%% "
=%%# $
value%%% *
;%%* +
}&& 
}'' 	
private)) 

GroupModel)) 
_groupNameForFilter)) .
;)). /
public++ 

GroupModel++ 
GroupNameForFilter++ ,
{,, 	
get-- 
=>-- 
_groupNameForFilter-- &
;--& '
set.. 
{// 
_groupNameForFilter00 #
=00$ %
value00& +
;00+ ,
FilterGroupList11 
(11  
_groupNameForFilter11  3
)113 4
;114 5
}22 
}33 	
private55 
void55 
FilterGroupList55 $
(55$ %

GroupModel55% /
group550 5
)555 6
{66 	
if77 
(77 
group77 
.77 
	GroupName77 
!=77  "
$str77# (
)77( )
{88 
Group99 
.99 
ParentId99 
=99  
group99! &
.99& '
GroupId99' .
;99. /
ICollection:: 
<:: 
string:: "
>::" #
groupNameList::$ 1
=::2 3"
_administrationService::4 J
.::J K
GetGroupAncestors::K \
(::\ ]
group::] b
.::b c
	GroupName::c l
)::l m
;::m n
if;; 
(;; !
_hiddenGroupAncestors;; )
.;;) *
Any;;* -
(;;- .
);;. /
);;/ 0
{<< 
foreach== 
(== 
var==  
item==! %
in==& (!
_hiddenGroupAncestors==) >
.==> ?
GroupBy==? F
(==F G
g==G H
=>==I K
g==L M
.==M N
GroupId==N U
)==U V
.==V W
First==W \
(==\ ]
)==] ^
.==^ _
ToList==_ e
(==e f
)==f g
)==g h
{>> 
	GroupList?? !
.??! "
Add??" %
(??% &
item??& *
)??* +
;??+ ,!
_hiddenGroupAncestors@@ -
.@@- .
Remove@@. 4
(@@4 5
item@@5 9
)@@9 :
;@@: ;
}AA 
}BB 
foreachCC 
(CC 
varCC 
	groupNameCC &
inCC' )
groupNameListCC* 7
)CC7 8
{DD 
foreachFF 
(FF 
varFF 
itemFF  $
inFF% '
	GroupListFF( 1
.FF1 2
ToListFF2 8
(FF8 9
)FF9 :
)FF; <
{GG 
ifHH 
(HH 
itemHH  
.HH  !
	GroupNameHH! *
==HH+ -
	groupNameHH. 7
)HH7 8
{II 
	GroupListJJ %
.JJ% &
RemoveJJ& ,
(JJ, -
itemJJ- 1
)JJ1 2
;JJ2 3!
_hiddenGroupAncestorsKK 1
.KK1 2
AddKK2 5
(KK5 6
itemKK6 :
)KK: ;
;KK; <
}LL 
}MM 
}NN 
GroupOO 
.OO 
GroupsOO 
=OO 
newOO " 
ObservableCollectionOO# 7
<OO7 8

GroupModelOO8 B
>OOB C
(OOC D
)OOD E
;OOE F
}PP 
elseQQ 
{RR 
GroupSS 
.SS 
ParentIdSS 
=SS  
nullSS! %
;SS% &
GroupTT 
.TT 
GroupsTT 
=TT 
newTT " 
ObservableCollectionTT# 7
<TT7 8

GroupModelTT8 B
>TTB C
(TTC D
)TTD E
;TTE F
foreachUU 
(UU 
varUU 
itemUU  
inUU! #!
_hiddenGroupAncestorsUU$ 9
.UU9 :
ToListUU: @
(UU@ A
)UUA B
)UUB C
{VV !
_hiddenGroupAncestorsWW )
.WW) *
RemoveWW* 0
(WW0 1
itemWW1 5
)WW5 6
;WW6 7
}XX 
	GroupListYY 
=YY 
newYY  
ObservableCollectionYY  4
<YY4 5

GroupModelYY5 ?
>YY? @
(YY@ A"
_groupsWithNoAncestorsYYA W
)YYW X
;YYX Y
}ZZ 
}[[ 	
public]] 

GroupModel]] 
Group]] 
{]]  !
get]]" %
;]]% &
set]]' *
;]]* +
}]], -
public__ 
AddGroupViewModel__  
(__  !"
IAdministrationService__! 7!
administrationService__8 M
)__M N
{`` 	"
_administrationServiceaa "
=aa# $!
administrationServiceaa% :
;aa: ;!
_hiddenGroupAncestorscc !
=cc" #
newcc$ '
Listcc( ,
<cc, -

GroupModelcc- 7
>cc7 8
(cc8 9
)cc9 :
;cc: ;
	_userListee 
=ee 
newee  
ObservableCollectionee 0
<ee0 1
UserDTOee1 8
>ee8 9
(ee9 :"
_administrationServiceee: P
.eeP Q
GetUserseeQ Y
(eeY Z
)eeZ [
)ee[ \
;ee\ ]
_groupsForComboBoxgg 
=gg  
Mappergg! '
.gg' (
Mapgg( +
<gg+ ,
IEnumerablegg, 7
<gg7 8
GroupDTOgg8 @
>gg@ A
,ggA B
ICollectionggC N
<ggN O

GroupModelggO Y
>ggY Z
>ggZ [
(gg[ \"
_administrationServicegg\ r
.ggr s
	GetGroupsggs |
(gg| }
)gg} ~
)gg~ 
;	gg Ä"
_groupsWithNoAncestorshh "
=hh# $
Mapperhh% +
.hh+ ,
Maphh, /
<hh/ 0
IEnumerablehh0 ;
<hh; <
GroupDTOhh< D
>hhD E
,hhE F
ICollectionhhG R
<hhR S

GroupModelhhS ]
>hh] ^
>hh^ _
(hh_ `"
_administrationServicehh` v
.hhv w%
GetGroupsWithNoAncestors	hhw è
(
hhè ê
)
hhê ë
)
hhë í
;
hhí ì

_groupListii 
=ii 
newii  
ObservableCollectionii 1
<ii1 2

GroupModelii2 <
>ii< =
(ii= >"
_groupsWithNoAncestorsii> T
)iiT U
;iiU V
_groupsForComboBoxjj 
.jj 
Addjj "
(jj" #
newjj# &

GroupModeljj' 1
{jj2 3
	GroupNamejj4 =
=jj> ?
$strjj@ E
}jjF G
)jjG H
;jjH I
_addUserCommandll 
=ll 
newll !
RelayCommandll" .
<ll. /
UserDTOll/ 6
>ll6 7
(ll7 8
AddUserll8 ?
)ll? @
;ll@ A
_removeUserCommandmm 
=mm  
newmm! $
RelayCommandmm% 1
<mm1 2
UserDTOmm2 9
>mm9 :
(mm: ;

RemoveUsermm; E
)mmE F
;mmF G
_addGroupCommandnn 
=nn 
newnn "
RelayCommandnn# /
<nn/ 0

GroupModelnn0 :
>nn: ;
(nn; <
AddGroupnn< D
)nnD E
;nnE F
_removeGroupCommandoo 
=oo  !
newoo" %
RelayCommandoo& 2
<oo2 3

GroupModeloo3 =
>oo= >
(oo> ?
RemoveGroupoo? J
)ooJ K
;ooK L
_createGroupCommandpp 
=pp  !
newpp" %
RelayCommandpp& 2
<pp2 3
Windowpp3 9
>pp9 :
(pp: ;
CreateGrouppp; F
)ppF G
;ppG H
_customPrincipalrr 
=rr 
Threadrr %
.rr% &
CurrentPrincipalrr& 6
asrr7 9
CustomPrincipalrr: I
;rrI J
Grouptt 
=tt 
newtt 

GroupModeltt "
(tt" #
)tt# $
;tt$ %
AddUservv 
(vv 
UserListvv 
.vv 
FirstOrDefaultvv +
(vv+ ,
uvv, -
=>vv. 0
uvv1 2
.vv2 3
UserIdvv3 9
==vv: <
_customPrincipalvv= M
.vvM N
IdentityvvN V
.vvV W
UserIdvvW ]
)vv] ^
)vv^ _
;vv_ `
}ww 	
publicyy  
ObservableCollectionyy #
<yy# $
UserDTOyy$ +
>yy+ ,
UserListyy- 5
{zz 	
get{{ 
=>{{ 
	_userList{{ 
;{{ 
set|| 
{}} 
if~~ 
(~~ 
value~~ 
!=~~ 
	_userList~~ &
)~~& '
{ 
	_userList
ÄÄ 
=
ÄÄ 
value
ÄÄ  %
;
ÄÄ% &
base
ÅÅ 
.
ÅÅ "
RaisePropertyChanged
ÅÅ -
(
ÅÅ- .
)
ÅÅ. /
;
ÅÅ/ 0
}
ÇÇ 
}
ÉÉ 
}
ÑÑ 	
public
ÜÜ "
ObservableCollection
ÜÜ #
<
ÜÜ# $

GroupModel
ÜÜ$ .
>
ÜÜ. /
	GroupList
ÜÜ0 9
{
áá 	
get
àà 
=>
àà 

_groupList
àà 
;
àà 
set
ââ 
{
ää 
if
ãã 
(
ãã 
value
ãã 
!=
ãã 

_groupList
ãã '
)
ãã' (
{
åå 

_groupList
çç 
=
çç  
value
çç! &
;
çç& '
base
éé 
.
éé "
RaisePropertyChanged
éé -
(
éé- .
)
éé. /
;
éé/ 0
}
èè 
}
êê 
}
ëë 	
private
ìì 
RelayCommand
ìì 
<
ìì 
UserDTO
ìì $
>
ìì$ %
_addUserCommand
ìì& 5
;
ìì5 6
private
îî 
RelayCommand
îî 
<
îî 
UserDTO
îî $
>
îî$ % 
_removeUserCommand
îî& 8
;
îî8 9
public
ññ 
RelayCommand
ññ 
<
ññ 
UserDTO
ññ #
>
ññ# $
AddUserCommand
ññ% 3
{
ññ4 5
get
ññ6 9
{
ññ: ;
return
ññ< B
_addUserCommand
ññC R
;
ññR S
}
ññT U
}
ññV W
public
óó 
RelayCommand
óó 
<
óó 
UserDTO
óó #
>
óó# $
RemoveUserCommand
óó% 6
{
óó7 8
get
óó9 <
{
óó= >
return
óó? E 
_removeUserCommand
óóF X
;
óóX Y
}
óóZ [
}
óó\ ]
public
ôô 
void
ôô 
AddUser
ôô 
(
ôô 
UserDTO
ôô #
user
ôô$ (
)
ôô( )
{
öö 	
Group
õõ 
.
õõ 
Users
õõ 
.
õõ 
Add
õõ 
(
õõ 
user
õõ  
)
õõ  !
;
õõ! "
UserList
úú 
.
úú 
Remove
úú 
(
úú 
user
úú  
)
úú  !
;
úú! "
base
ùù 
.
ùù "
RaisePropertyChanged
ùù %
(
ùù% &
)
ùù& '
;
ùù' (
}
ûû 	
public
†† 
void
†† 

RemoveUser
†† 
(
†† 
UserDTO
†† &
user
††' +
)
††+ ,
{
°° 	
UserList
¢¢ 
.
¢¢ 
Add
¢¢ 
(
¢¢ 
user
¢¢ 
)
¢¢ 
;
¢¢ 
Group
££ 
.
££ 
Users
££ 
.
££ 
Remove
££ 
(
££ 
user
££ #
)
££# $
;
££$ %
base
§§ 
.
§§ "
RaisePropertyChanged
§§ %
(
§§% &
)
§§& '
;
§§' (
}
•• 	
private
®® 
RelayCommand
®® 
<
®® 

GroupModel
®® '
>
®®' (
_addGroupCommand
®®) 9
;
®®9 :
private
©© 
RelayCommand
©© 
<
©© 

GroupModel
©© '
>
©©' (!
_removeGroupCommand
©©) <
;
©©< =
public
´´ 
RelayCommand
´´ 
<
´´ 

GroupModel
´´ &
>
´´& '
AddGroupCommand
´´( 7
{
´´8 9
get
´´: =
{
´´> ?
return
´´@ F
_addGroupCommand
´´G W
;
´´W X
}
´´Y Z
}
´´[ \
public
¨¨ 
RelayCommand
¨¨ 
<
¨¨ 

GroupModel
¨¨ &
>
¨¨& ' 
RemoveGroupCommand
¨¨( :
{
¨¨; <
get
¨¨= @
{
¨¨A B
return
¨¨C I!
_removeGroupCommand
¨¨J ]
;
¨¨] ^
}
¨¨_ `
}
¨¨a b
public
ÆÆ 
void
ÆÆ 
AddGroup
ÆÆ 
(
ÆÆ 

GroupModel
ÆÆ '
group
ÆÆ( -
)
ÆÆ- .
{
ØØ 	
Group
∞∞ 
.
∞∞ 
Groups
∞∞ 
.
∞∞ 
Add
∞∞ 
(
∞∞ 
group
∞∞ "
)
∞∞" #
;
∞∞# $
	GroupList
±± 
.
±± 
Remove
±± 
(
±± 
group
±± "
)
±±" #
;
±±# $
base
≤≤ 
.
≤≤ "
RaisePropertyChanged
≤≤ %
(
≤≤% &
)
≤≤& '
;
≤≤' (
}
≥≥ 	
public
µµ 
void
µµ 
RemoveGroup
µµ 
(
µµ  

GroupModel
µµ  *
group
µµ+ 0
)
µµ0 1
{
∂∂ 	
Group
∑∑ 
.
∑∑ 
Groups
∑∑ 
.
∑∑ 
Remove
∑∑ 
(
∑∑  
group
∑∑  %
)
∑∑% &
;
∑∑& '
	GroupList
∏∏ 
.
∏∏ 
Add
∏∏ 
(
∏∏ 
group
∏∏ 
)
∏∏  
;
∏∏  !
base
ππ 
.
ππ "
RaisePropertyChanged
ππ %
(
ππ% &
)
ππ& '
;
ππ' (
}
∫∫ 	
private
ºº 
RelayCommand
ºº 
<
ºº 
Window
ºº #
>
ºº# $!
_createGroupCommand
ºº% 8
;
ºº8 9
public
ææ 
RelayCommand
ææ 
<
ææ 
Window
ææ "
>
ææ" # 
CreateGroupCommand
ææ$ 6
{
ææ7 8
get
ææ9 <
{
ææ= >
return
ææ? E!
_createGroupCommand
ææF Y
;
ææY Z
}
ææ[ \
}
ææ] ^
public
¿¿ 
void
¿¿ 
CreateGroup
¿¿ 
(
¿¿  
Window
¿¿  &
window
¿¿' -
)
¿¿- .
{
¡¡ 	
if
¬¬ 
(
¬¬ 
Group
¬¬ 
.
¬¬ 
	GroupName
¬¬ 
!=
¬¬ !
null
¬¬! %
)
¬¬% &
{
√√ 
if
ƒƒ 
(
ƒƒ $
_administrationService
ƒƒ *
.
ƒƒ* +

CheckGroup
ƒƒ+ 5
(
ƒƒ5 6
Group
ƒƒ6 ;
.
ƒƒ; <
	GroupName
ƒƒ< E
)
ƒƒE F
)
ƒƒF G
{
≈≈ $
_administrationService
∆∆ *
.
∆∆* +
CreateGroup
∆∆+ 6
(
∆∆6 7
Mapper
∆∆7 =
.
∆∆= >
Map
∆∆> A
<
∆∆A B

GroupModel
∆∆B L
,
∆∆L M
GroupDTO
∆∆N V
>
∆∆V W
(
∆∆W X
Group
∆∆X ]
)
∆∆] ^
,
∆∆^ _
Mapper
∆∆` f
.
∆∆f g
Map
∆∆g j
<
∆∆j k
IEnumerable
∆∆k v
<
∆∆v w

GroupModel∆∆w Å
>∆∆Å Ç
,∆∆Ç É
ICollection∆∆Ñ è
<∆∆è ê
GroupDTO∆∆ê ò
>∆∆ò ô
>∆∆ô ö
(∆∆ö õ
Group∆∆õ †
.∆∆† °
Groups∆∆° ß
)∆∆ß ®
,∆∆® ©
Group∆∆™ Ø
.∆∆Ø ∞
Users∆∆∞ µ
,∆∆µ ∂ 
_customPrincipal∆∆∑ «
.∆∆« »
Identity∆∆» –
.∆∆– —
UserId∆∆— ◊
)∆∆◊ ÿ
;∆∆ÿ Ÿ
window
«« 
.
«« 
Close
««  
(
««  !
)
««! "
;
««" #
}
»» 
else
…… 
{
   

MessageBox
ÀÀ 
.
ÀÀ 
Show
ÀÀ #
(
ÀÀ# $
$str
ÀÀ$ I
)
ÀÀI J
;
ÀÀJ K
}
ÃÃ 
}
ÕÕ 
else
ŒŒ 
{
œœ 

MessageBox
–– 
.
–– 
Show
–– 
(
––  
$str
––  4
)
––4 5
;
––5 6
}
—— 
}
““ 	
}
”” 
}‘‘ Ω|
|C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\Groups\ShowAllGroupsViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
CommonViewModels /
./ 0
Groups0 6
{ 
[ 
PrincipalPermission 
( 
SecurityAction '
.' (
Demand( .
,. /
Role0 4
=5 6
$str7 >
)> ?
]? @
public 

class "
ShowAllGroupsViewModel '
:( )
ViewModelBase* 7
{ 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
private  
ObservableCollection $
<$ %

GroupModel% /
>/ 0
_groups1 8
;8 9
private 
RelayCommand 
< 

GroupModel '
>' (
_editUserCommand) 9
{: ;
get< ?
;? @
}A B
private 
RelayCommand 
_addUserCommand ,
{- .
get/ 2
;2 3
}4 5
private 
RelayCommand 
< 

GroupModel '
>' (
_deleteGroupCommand) <
{= >
get? B
;B C
}D E
public   "
ShowAllGroupsViewModel   %
(  % &"
IAdministrationService  & < 
administationService  = Q
)  Q R
{!! 	"
_administrationService"" "
=""# $ 
administationService""% 9
;""9 :
_groups## 
=## 
new##  
ObservableCollection## .
<##. /

GroupModel##/ 9
>##9 :
(##: ;
)##; <
;##< =
LoadData$$ 
($$ 
)$$ 
;$$ 
_editUserCommand%% 
=%% 
new%% "
RelayCommand%%# /
<%%/ 0

GroupModel%%0 :
>%%: ;
(%%; <
	EditGroup%%< E
)%%E F
;%%F G
_addUserCommand&& 
=&& 
new&& !
RelayCommand&&" .
(&&. /
AddGroup&&/ 7
)&&7 8
;&&8 9
_deleteGroupCommand'' 
=''  !
new''" %
RelayCommand''& 2
<''2 3

GroupModel''3 =
>''= >
(''> ?
DeleteGroup''? J
)''J K
;''K L
}(( 	
public** 
RelayCommand** 
<** 

GroupModel** &
>**& '
EditUserCommand**( 7
{**8 9
get**: =
{**> ?
return**@ F
_editUserCommand**G W
;**W X
}**Y Z
}**[ \
public,, 
RelayCommand,, 
AddUserCommand,, *
{,,+ ,
get,,- 0
{,,1 2
return,,3 9
_addUserCommand,,: I
;,,I J
},,K L
},,M N
public.. 
RelayCommand.. 
<.. 

GroupModel.. &
>..& '
DeleteGroupCommand..( :
{..; <
get..= @
{..A B
return..C I
_deleteGroupCommand..J ]
;..] ^
}.._ `
}..a b
public00  
ObservableCollection00 #
<00# $

GroupModel00$ .
>00. /
Groups000 6
{11 	
get22 
=>22 
_groups22 
;22 
set33 
{44 
try55 
{66 
_groups77 
=77 
value77 #
;77# $
base88 
.88  
RaisePropertyChanged88 -
(88- .
)88. /
;88/ 0
}99 
catch:: 
(:: "
NullReferenceException:: -
ex::. 0
)::0 1
{;; 

MessageBox<< 
.<< 
Show<< #
(<<# $
ex<<$ &
.<<& '

StackTrace<<' 1
)<<1 2
;<<2 3
}== 
}>> 
}?? 	
privateAA 
voidAA 
DeleteGroupAA  
(AA  !

GroupModelAA! +
groupAA, 1
)AA1 2
{BB 	
ifCC 
(CC 
groupCC 
!=CC 
nullCC 
)CC 
{DD 
ifEE 
(EE 
groupEE 
.EE 
ParentIdEE "
==EE# %
nullEE& *
)EE* +
{FF 
foreachGG 
(GG 
varGG  
itemGG! %
inGG& (
groupGG) .
.GG. /
GroupsGG/ 5
)GG5 6
{HH 
GroupsII 
.II 
AddII "
(II" #
itemII# '
)II' (
;II( )
}JJ 
GroupsKK 
.KK 
RemoveKK !
(KK! "
groupKK" '
)KK' (
;KK( )
}LL 
elseMM 
{NN 
varOO 
parentOO 
=OO  
FindParentGroupOO! 0
(OO0 1
(OO1 2
intOO2 5
)OO5 6
groupOO6 ;
.OO; <
ParentIdOO< D
)OOD E
;OOE F
foreachPP 
(PP 
varPP  
itemPP! %
inPP& (
groupPP) .
.PP. /
GroupsPP/ 5
)PP5 6
{QQ 
parentRR 
.RR 
GroupsRR %
.RR% &
AddRR& )
(RR) *
itemRR* .
)RR. /
;RR/ 0
}SS 
parentTT 
.TT 
GroupsTT !
.TT! "
RemoveTT" (
(TT( )
groupTT) .
)TT. /
;TT/ 0
}UU "
_administrationServiceVV &
.VV& '
DeleteGroupVV' 2
(VV2 3
groupVV3 8
.VV8 9
GroupIdVV9 @
)VV@ A
;VVA B
}WW 
}XX 	
privateZZ 

GroupModelZZ 
FindParentGroupZZ *
(ZZ* +
intZZ+ .
idZZ/ 1
)ZZ1 2
{[[ 	

GroupModel\\ 
group\\ 
=\\ 
new\\ "

GroupModel\\# -
(\\- .
)\\. /
;\\/ 0
foreach]] 
(]] 
var]] 
item]] 
in]] 
Groups]]  &
)]]& '
{^^ 
if__ 
(__ 
item__ 
.__ 
GroupId__  
==__! #
id__$ &
)__& '
{`` 
groupaa 
=aa 
itemaa  
;aa  !
breakbb 
;bb 
}cc 
elsedd 
{ee 
varff 
findingff 
=ff  !
SearchBranchff" .
(ff. /
itemff/ 3
.ff3 4
Groupsff4 :
,ff: ;
idff< >
)ff> ?
;ff? @
ifgg 
(gg 
!gg 
stringgg 
.gg  
IsNullOrEmptygg  -
(gg- .
findinggg. 5
.gg5 6
	GroupNamegg6 ?
)gg? @
)gg@ A
{hh 
groupii 
=ii 
findingii  '
;ii' (
breakjj 
;jj 
}kk 
}ll 
}mm 
returnnn 
groupnn 
;nn 
}oo 	
privateqq 

GroupModelqq 
SearchBranchqq '
(qq' (
ICollectionqq( 3
<qq3 4

GroupModelqq4 >
>qq> ?
groupsqq@ F
,qqF G
intqqH K
idqqL N
)qqN O
{rr 	

GroupModelss 
groupss 
=ss 
newss "

GroupModelss# -
(ss- .
)ss. /
;ss/ 0
foreachtt 
(tt 
vartt 
itemtt 
intt  
groupstt! '
)tt' (
{uu 
ifvv 
(vv 
itemvv 
.vv 
GroupIdvv  
==vv! #
idvv$ &
)vv& '
{ww 
groupxx 
=xx 
itemxx  
;xx  !
breakyy 
;yy 
}zz 
else{{ 
{|| 
var}} 
finding}} 
=}}  !
SearchBranch}}" .
(}}. /
item}}/ 3
.}}3 4
Groups}}4 :
,}}: ;
id}}< >
)}}> ?
;}}? @
if~~ 
(~~ 
finding~~ 
!=~~  "
null~~# '
)~~' (
{ 
group
ÄÄ 
=
ÄÄ 
finding
ÄÄ  '
;
ÄÄ' (
break
ÅÅ 
;
ÅÅ 
}
ÇÇ 
}
ÉÉ 
}
ÑÑ 
return
ÖÖ 
group
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
private
àà 
void
àà 
AddGroup
àà 
(
àà 
)
àà 
{
ââ 	
	Messenger
ää 
.
ää 
Default
ää 
.
ää 
Send
ää "
(
ää" #
new
ää# &!
NotificationMessage
ää' :
(
ää: ;
$str
ää; K
)
ääK L
)
ääL M
;
ääM N
LoadData
ãã 
(
ãã 
)
ãã 
;
ãã 
}
åå 	
private
éé 
void
éé 
	EditGroup
éé 
(
éé 

GroupModel
éé )
group
éé* /
)
éé/ 0
{
èè 	
if
êê 
(
êê 
group
êê 
!=
êê 
null
êê 
)
êê 
{
ëë 
	Messenger
íí 
.
íí 
Default
íí !
.
íí! "
Send
íí" &
<
íí& '

GroupModel
íí' 1
>
íí1 2
(
íí2 3
group
íí3 8
)
íí8 9
;
íí9 :
LoadData
ìì 
(
ìì 
)
ìì 
;
ìì 
}
†† 
}
°° 	
private
££ 
void
££ 
LoadData
££ 
(
££ 
)
££ 
{
§§ 	
Groups
•• 
=
•• 
new
•• "
ObservableCollection
•• -
<
••- .

GroupModel
••. 8
>
••8 9
(
••9 :
Mapper
••: @
.
••@ A
Map
••A D
<
••D E
IEnumerable
••E P
<
••P Q
GroupDTO
••Q Y
>
••Y Z
,
••Z [
ICollection
••\ g
<
••g h

GroupModel
••h r
>
••r s
>
••s t
(
••t u%
_administrationService••u ã
.••ã å(
GetGroupsWithNoAncestors••å §
(••§ •
)••• ¶
)••¶ ß
)••ß ®
;••® ©
var
¶¶ 
	allGroups
¶¶ 
=
¶¶ 
Mapper
¶¶ "
.
¶¶" #
Map
¶¶# &
<
¶¶& '
IEnumerable
¶¶' 2
<
¶¶2 3
GroupDTO
¶¶3 ;
>
¶¶; <
,
¶¶< =
ICollection
¶¶> I
<
¶¶I J

GroupModel
¶¶J T
>
¶¶T U
>
¶¶U V
(
¶¶V W$
_administrationService
¶¶W m
.
¶¶m n
	GetGroups
¶¶n w
(
¶¶w x
)
¶¶x y
)
¶¶y z
;
¶¶z {
foreach
ßß 
(
ßß 
var
ßß 
item
ßß 
in
ßß 
Groups
ßß  &
)
ßß& '
{
®® 
foreach
©© 
(
©© 
var
©© 
group
©© !
in
©©" $
	allGroups
©©% .
.
©©. /
ToList
©©/ 5
(
©©5 6
)
©©6 7
)
©©7 8
{
™™ 
if
´´ 
(
´´ 
item
´´ 
.
´´ 
GroupId
´´ $
==
´´% '
group
´´( -
.
´´- .
GroupId
´´. 5
)
´´5 6
	allGroups
¨¨ !
.
¨¨! "
Remove
¨¨" (
(
¨¨( )
group
¨¨) .
)
¨¨. /
;
¨¨/ 0
}
≠≠ 
}
ÆÆ 
while
ØØ 
(
ØØ 
	allGroups
ØØ 
.
ØØ 
Any
ØØ  
(
ØØ  !
)
ØØ! "
)
ØØ" #
{
∞∞ 
foreach
±± 
(
±± 
var
±± 
item
±± !
in
±±" $
Groups
±±% +
)
±±+ ,
{
≤≤ 
	allGroups
≥≥ 
=
≥≥ 
FillChildrens
≥≥  -
(
≥≥- .
	allGroups
≥≥. 7
,
≥≥7 8
item
≥≥9 =
.
≥≥= >
Groups
≥≥> D
)
≥≥D E
.
≥≥E F
ToList
≥≥F L
(
≥≥L M
)
≥≥M N
;
≥≥N O
}
¥¥ 
}
µµ 
}
∂∂ 	
private
∏∏ 
IEnumerable
∏∏ 
<
∏∏ 

GroupModel
∏∏ &
>
∏∏& '
FillChildrens
∏∏( 5
(
∏∏5 6
ICollection
∏∏6 A
<
∏∏A B

GroupModel
∏∏B L
>
∏∏L M
	allGroups
∏∏N W
,
∏∏W X
ICollection
∏∏Y d
<
∏∏d e

GroupModel
∏∏e o
>
∏∏o p

groupModel
∏∏q {
)
∏∏{ |
{
ππ 	
if
∫∫ 
(
∫∫ 

groupModel
∫∫ 
!=
∫∫ 
null
∫∫ "
)
∫∫" #
{
ªª 
foreach
ºº 
(
ºº 
var
ºº 
item
ºº !
in
ºº" $

groupModel
ºº% /
)
ºº/ 0
{
ΩΩ 
	allGroups
ææ 
=
ææ 
	allGroups
ææ  )
.
ææ) *
Where
ææ* /
(
ææ/ 0
g
ææ0 1
=>
ææ2 4
g
ææ5 6
.
ææ6 7
GroupId
ææ7 >
!=
ææ? A
item
ææB F
.
ææF G
GroupId
ææG N
)
ææN O
.
ææO P
ToList
ææP V
(
ææV W
)
ææW X
;
ææX Y
var
øø 
groups
øø 
=
øø  $
_administrationService
øø! 7
.
øø7 8%
GetGroupFirstGeneration
øø8 O
(
øøO P
item
øøP T
.
øøT U
GroupId
øøU \
)
øø\ ]
;
øø] ^
if
¿¿ 
(
¿¿ 
groups
¿¿ 
.
¿¿ 
Any
¿¿ "
(
¿¿" #
)
¿¿# $
)
¿¿$ %
{
¡¡ 
item
¬¬ 
.
¬¬ 
Groups
¬¬ #
=
¬¬$ %
new
¬¬& )"
ObservableCollection
¬¬* >
<
¬¬> ?

GroupModel
¬¬? I
>
¬¬I J
(
¬¬J K
Mapper
¬¬K Q
.
¬¬Q R
Map
¬¬R U
<
¬¬U V
IEnumerable
¬¬V a
<
¬¬a b
GroupDTO
¬¬b j
>
¬¬j k
,
¬¬k l
ICollection
¬¬m x
<
¬¬x y

GroupModel¬¬y É
>¬¬É Ñ
>¬¬Ñ Ö
(¬¬Ö Ü
groups¬¬Ü å
)¬¬å ç
)¬¬ç é
;¬¬é è
foreach
√√ 
(
√√  !
var
√√! $
temp
√√% )
in
√√* ,
item
√√- 1
.
√√1 2
Groups
√√2 8
)
√√8 9
{
ƒƒ 
foreach
≈≈ #
(
≈≈$ %
var
≈≈% (
group
≈≈) .
in
≈≈/ 1
	allGroups
≈≈2 ;
.
≈≈; <
ToList
≈≈< B
(
≈≈B C
)
≈≈C D
)
≈≈D E
{
∆∆ 
if
««  "
(
««# $
temp
««$ (
.
««( )
GroupId
««) 0
==
««1 3
group
««4 9
.
««9 :
GroupId
««: A
)
««A B
	allGroups
»»$ -
.
»»- .
Remove
»». 4
(
»»4 5
group
»»5 :
)
»»: ;
;
»»; <
}
…… 
}
   
	allGroups
ÀÀ !
=
ÀÀ" #
FillChildrens
ÀÀ$ 1
(
ÀÀ1 2
	allGroups
ÀÀ2 ;
,
ÀÀ; <
item
ÀÀ= A
.
ÀÀA B
Groups
ÀÀB H
)
ÀÀH I
.
ÀÀI J
ToList
ÀÀJ P
(
ÀÀP Q
)
ÀÀQ R
;
ÀÀR S
}
ÃÃ 
}
ÕÕ 
}
ŒŒ 
return
œœ 
	allGroups
œœ 
;
œœ 
}
—— 	
}
““ 
}”” » 
xC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\Groups\EditGroupViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Administration -
.- .
Groups. 4
{ 
public 

class 
EditGroupViewModel #
:$ %
ViewModelBase& 3
{ 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
private 
bool 
_editor 
; 
private 
string 
_oldName 
;  
private 
ICollection 
< 

GroupModel &
>& '!
_hiddenGroupAncestors( =
;= >
private 
ICollection 
< 

GroupModel &
>& '"
_groupsWithNoAncestors( >
;> ?
private  
ObservableCollection $
<$ %

GroupModel% /
>/ 0

_groupList1 ;
;; <
private  
ObservableCollection $
<$ %
UserDTO% ,
>, -
	_userList. 7
;7 8
private 
ICollection 
< 

GroupModel &
>& '
_groupsForComboBox( :
;: ;
public 
ICollection 
< 

GroupModel %
>% &
GroupsForComboBox' 8
{ 	
get   
=>   
_groupsForComboBox   %
;  % &
set!! 
{"" 
_groupsForComboBox## "
=### $
value##% *
;##* +
}$$ 
}%% 	
private'' 

GroupModel'' 
_groupNameForFilter'' .
;''. /
public)) 

GroupModel)) 
GroupNameForFilter)) ,
{** 	
get++ 
=>++ 
_groupNameForFilter++ &
;++& '
set,, 
{-- 
_groupNameForFilter.. #
=..$ %
value..& +
;..+ ,
FilterGroupList// 
(//  
_groupNameForFilter//  3
)//3 4
;//4 5
base00 
.00  
RaisePropertyChanged00 )
(00) *
)00* +
;00+ ,
}11 
}22 	
private44 
void44 
FilterGroupList44 $
(44$ %

GroupModel44% /
group440 5
)445 6
{55 	
if66 
(66 
_editor66 
)66 
{77 
if88 
(88 
group88 
.88 
	GroupName88 #
!=88$ &
$str88' ,
)88, -
{99 
Group:: 
.:: 
ParentId:: "
=::# $
group::% *
.::* +
GroupId::+ 2
;::2 3
ICollection;; 
<;;  
string;;  &
>;;& '
groupNameList;;( 5
=;;6 7"
_administrationService;;8 N
.;;N O
GetGroupAncestors;;O `
(;;` a
group;;a f
.;;f g
	GroupName;;g p
);;p q
;;;q r
if<< 
(<< !
_hiddenGroupAncestors<< -
.<<- .
Any<<. 1
(<<1 2
)<<2 3
)<<3 4
{== 
foreach>> 
(>>  !
var>>! $
item>>% )
in>>* ,!
_hiddenGroupAncestors>>- B
.>>B C
GroupBy>>C J
(>>J K
g>>K L
=>>>M O
g>>P Q
.>>Q R
GroupId>>R Y
)>>Y Z
.>>Z [
First>>[ `
(>>` a
)>>a b
.>>b c
ToList>>c i
(>>i j
)>>j k
)>>k l
{?? 
	GroupList@@ %
.@@% &
Add@@& )
(@@) *
item@@* .
)@@. /
;@@/ 0!
_hiddenGroupAncestorsAA 1
.AA1 2
RemoveAA2 8
(AA8 9
itemAA9 =
)AA= >
;AA> ?
}BB 
}CC 
foreachDD 
(DD 
varDD  
	groupNameDD! *
inDD+ -
groupNameListDD. ;
)DD; <
{EE 
foreachFF 
(FF  !
varFF! $
itemFF% )
inFF* ,
	GroupListFF- 6
.FF6 7
ToListFF7 =
(FF= >
)FF> ?
)FF? @
{GG 
ifHH 
(HH  
itemHH  $
.HH$ %
	GroupNameHH% .
==HH/ 1
	groupNameHH2 ;
)HH; <
{II 
	GroupListJJ  )
.JJ) *
RemoveJJ* 0
(JJ0 1
itemJJ1 5
)JJ5 6
;JJ6 7!
_hiddenGroupAncestorsKK  5
.KK5 6
AddKK6 9
(KK9 :
itemKK: >
)KK> ?
;KK? @
}LL 
}MM 
}NN 
foreachOO 
(OO 
varOO  
itemOO! %
inOO& (!
_hiddenGroupAncestorsOO) >
.OO> ?
SelectOO? E
(OOE F
gOOF G
=>OOH J
gOOK L
.OOL M
	GroupNameOOM V
)OOV W
.OOW X
ExceptOOX ^
(OO^ _
groupNameListOO_ l
)OOl m
.OOm n
ToListOOn t
(OOt u
)OOu v
)OOv w
{PP 
varQQ 
tempQQ  
=QQ! "!
_hiddenGroupAncestorsQQ# 8
.QQ8 9
FirstOrDefaultQQ9 G
(QQG H
xQQH I
=>QQJ L
xQQM N
.QQN O
	GroupNameQQO X
==QQY [
itemQQ\ `
)QQ` a
;QQa b!
_hiddenGroupAncestorsRR -
.RR- .
RemoveRR. 4
(RR4 5
tempRR5 9
)RR9 :
;RR: ;
	GroupListSS !
.SS! "
AddSS" %
(SS% &
tempSS& *
)SS* +
;SS+ ,
}TT 
GroupUU 
.UU 
GroupsUU  
=UU! "
newUU# & 
ObservableCollectionUU' ;
<UU; <

GroupModelUU< F
>UUF G
(UUG H
)UUH I
;UUI J
}VV 
elseWW 
{XX "
_groupsWithNoAncestorsYY *
=YY* +"
_groupsWithNoAncestorsYY, B
.YYB C
GroupByYYC J
(YYJ K
gYYK L
=>YYM O
gYYP Q
.YYQ R
GroupIdYYR Y
)YYY Z
.YYZ [
SelectYY[ a
(YYa b
xYYb c
=>YYd f
xYYg h
.YYh i
FirstYYi n
(YYn o
)YYo p
)YYp q
.YYq r
ToListYYr x
(YYx y
)YYy z
;YYz {
GroupZZ 
.ZZ 
ParentIdZZ "
=ZZ# $
nullZZ% )
;ZZ) *
foreach[[ 
([[ 
var[[  
item[[! %
in[[& (!
_hiddenGroupAncestors[[) >
.[[> ?
ToList[[? E
([[E F
)[[F G
)[[G H
{\\ !
_hiddenGroupAncestors]] -
.]]- .
Remove]]. 4
(]]4 5
item]]5 9
)]]9 :
;]]: ;
foreach^^ 
(^^  
var^^  #
temp^^$ (
in^^) +"
_groupsWithNoAncestors^^, B
.^^B C
ToList^^C I
(^^I J
)^^J K
)^^K L
{__ 
if`` 
(`` 
temp`` #
.``# $
GroupId``$ +
==``, .
item``/ 3
.``3 4
GroupId``4 ;
)``; <
{aa "
_groupsWithNoAncestorsbb  6
.bb6 7
Removebb7 =
(bb= >
tempbb> B
)bbB C
;bbC D
	GroupListcc  )
.cc) *
Addcc* -
(cc- .
itemcc. 2
)cc2 3
;cc3 4
}dd 
}ee 
}ff 
}gg 
}hh 
elseii 
{jj 
_editorkk 
=kk 
truekk 
;kk 
ifll 
(ll 
Groupll 
.ll 
ParentIdll "
!=ll# %
nullll& *
)ll* +
{mm 
ICollectionnn 
<nn  
stringnn  &
>nn& '
groupNameListnn( 5
=nn6 7"
_administrationServicenn8 N
.nnN O
GetGroupAncestorsnnO `
(nn` a
Groupnna f
.nnf g
	GroupNamenng p
)nnp q
;nnq r
foreachoo 
(oo 
varoo  
ancestoroo! )
inoo* ,
groupNameListoo- :
)oo: ;
{pp 
foreachqq 
(qq  !
varqq! $
itemqq% )
inqq* ,
	GroupListqq- 6
.qq6 7
ToListqq7 =
(qq= >
)qq> ?
)qq? @
{rr 
ifss 
(ss  
itemss  $
.ss$ %
	GroupNamess% .
==ss/ 1
ancestorss2 :
)ss: ;
{tt 
	GroupListuu  )
.uu) *
Removeuu* 0
(uu0 1
itemuu1 5
)uu5 6
;uu6 7!
_hiddenGroupAncestorsvv  5
.vv5 6
Addvv6 9
(vv9 :
itemvv: >
)vv> ?
;vv? @
}ww 
}xx 
}yy 
}zz 
	GroupList{{ 
.{{ 
Remove{{  
({{  !
	GroupList{{! *
.{{* +
FirstOrDefault{{+ 9
({{9 :
g{{: ;
=>{{; =
g{{= >
.{{> ?
GroupId{{? F
=={{G I
Group{{J O
.{{O P
GroupId{{P W
){{W X
){{X Y
;{{Y Z
}|| 
}}} 	
private 

GroupModel 
_group !
;! "
public
ÅÅ 

GroupModel
ÅÅ 
Group
ÅÅ 
{
ÇÇ 	
get
ÉÉ 
=>
ÉÉ 
_group
ÉÉ 
;
ÉÉ 
set
ÑÑ 
{
ÖÖ 
if
ÜÜ 
(
ÜÜ 
value
ÜÜ 
!=
ÜÜ 
null
ÜÜ !
)
ÜÜ! "
{
áá 
_group
àà 
=
àà 
value
àà "
;
àà" #
base
àà$ (
.
àà( )"
RaisePropertyChanged
àà) =
(
àà= >
)
àà> ?
;
àà? @
}
ââ 
}
ää 
}
ãã 	
public
çç  
EditGroupViewModel
çç !
(
çç! "$
IAdministrationService
çç" 8#
administrationService
çç9 N
)
ççN O
{
éé 	
	Messenger
èè 
.
èè 
Default
èè 
.
èè 
Register
èè &
<
èè& '

GroupModel
èè' 1
>
èè1 2
(
èè2 3
this
èè3 7
,
èè7 8
group
èè9 >
=>
èè? A
{
êê 
if
ëë 
(
ëë 
group
ëë 
!=
ëë 
null
ëë !
)
ëë! "
{
íí 
Group
ìì 
=
ìì 
group
ìì !
;
ìì! "
_oldName
îî 
=
îî 
group
îî $
.
îî$ %
	GroupName
îî% .
;
îî. /
UserList
ññ 
=
ññ 
new
ññ ""
ObservableCollection
ññ# 7
<
ññ7 8
UserDTO
ññ8 ?
>
ññ? @
(
ññ@ A$
_administrationService
ññA W
.
ññW X
GetUsers
ññX `
(
ññ` a
)
ñña b
)
ññb c
;
ññc d
foreach
óó 
(
óó 
var
óó  
item
óó! %
in
óó& (
Group
óó) .
.
óó. /
Users
óó/ 4
)
óó4 5
{
òò 
foreach
ôô 
(
ôô  !
var
ôô! $
temp
ôô% )
in
ôô* ,
UserList
ôô- 5
.
ôô5 6
ToList
ôô6 <
(
ôô< =
)
ôô= >
)
ôô> ?
{
öö 
if
õõ 
(
õõ  
item
õõ  $
.
õõ$ %
Name
õõ% )
==
õõ* ,
temp
õõ- 1
.
õõ1 2
Name
õõ2 6
)
õõ6 7
{
úú 
UserList
ùù  (
.
ùù( )
Remove
ùù) /
(
ùù/ 0
temp
ùù0 4
)
ùù4 5
;
ùù5 6
}
ûû 
}
üü 
}
†† 
	GroupList
¢¢ 
=
¢¢ 
new
¢¢  #"
ObservableCollection
¢¢$ 8
<
¢¢8 9

GroupModel
¢¢9 C
>
¢¢C D
(
¢¢D E$
_groupsWithNoAncestors
¢¢E [
)
¢¢[ \
;
¢¢\ ] 
_groupsForComboBox
§§ &
.
§§& '
Remove
§§' -
(
§§- . 
_groupsForComboBox
§§. @
.
§§@ A
FirstOrDefault
§§A O
(
§§O P
g
§§P Q
=>
§§R T
g
§§U V
.
§§V W
GroupId
§§W ^
==
§§_ a
Group
§§b g
.
§§g h
GroupId
§§h o
)
§§o p
)
§§p q
;
§§q r 
GroupNameForFilter
•• &
=
••' ( 
_groupsForComboBox
••) ;
.
••; <
FirstOrDefault
••< J
(
••J K
g
••K L
=>
••M O
g
••P Q
.
••Q R
GroupId
••R Y
==
••Z \
group
••] b
.
••b c
ParentId
••c k
)
••k l
;
••l m
	Messenger
¶¶ 
.
¶¶ 
Default
¶¶ %
.
¶¶% &

Unregister
¶¶& 0
<
¶¶0 1

GroupModel
¶¶1 ;
>
¶¶; <
(
¶¶< =
this
¶¶= A
)
¶¶A B
;
¶¶B C
}
ßß 
}
®® 
)
®® 
;
®® $
_administrationService
™™ "
=
™™# $#
administrationService
™™% :
;
™™: ;
_editor
´´ 
=
´´ 
false
´´ 
;
´´ #
_hiddenGroupAncestors
¨¨ !
=
¨¨" #
new
¨¨$ '
List
¨¨( ,
<
¨¨, -

GroupModel
¨¨- 7
>
¨¨7 8
(
¨¨8 9
)
¨¨9 :
;
¨¨: ;$
_groupsWithNoAncestors
≠≠ "
=
≠≠# $
Mapper
≠≠% +
.
≠≠+ ,
Map
≠≠, /
<
≠≠/ 0
IEnumerable
≠≠0 ;
<
≠≠; <
GroupDTO
≠≠< D
>
≠≠D E
,
≠≠E F
ICollection
≠≠G R
<
≠≠R S

GroupModel
≠≠T ^
>
≠≠^ _
>
≠≠_ `
(
≠≠` a$
_administrationService
≠≠a w
.
≠≠w x'
GetGroupsWithNoAncestors≠≠x ê
(≠≠ê ë
)≠≠ë í
)≠≠í ì
;≠≠ì î 
_groupsForComboBox
ØØ 
=
ØØ  
Mapper
ØØ! '
.
ØØ' (
Map
ØØ( +
<
ØØ+ ,
IEnumerable
ØØ, 7
<
ØØ7 8
GroupDTO
ØØ8 @
>
ØØ@ A
,
ØØA B
ICollection
ØØC N
<
ØØN O

GroupModel
ØØO Y
>
ØØY Z
>
ØØZ [
(
ØØ[ \$
_administrationService
ØØ\ r
.
ØØr s
	GetGroups
ØØs |
(
ØØ| }
)
ØØ} ~
)
ØØ~ 
;ØØ Ä 
_groupsForComboBox
∞∞ 
.
∞∞ 
Add
∞∞ "
(
∞∞" #
new
∞∞# &

GroupModel
∞∞' 1
{
∞∞2 3
	GroupName
∞∞4 =
=
∞∞> ?
$str
∞∞@ E
}
∞∞F G
)
∞∞G H
;
∞∞H I
_addUserCommand
≤≤ 
=
≤≤ 
new
≤≤ !
RelayCommand
≤≤" .
<
≤≤. /
UserDTO
≤≤/ 6
>
≤≤6 7
(
≤≤7 8
AddUser
≤≤8 ?
)
≤≤? @
;
≤≤@ A 
_removeUserCommand
≥≥ 
=
≥≥  
new
≥≥! $
RelayCommand
≥≥% 1
<
≥≥1 2
UserDTO
≥≥2 9
>
≥≥9 :
(
≥≥: ;

RemoveUser
≥≥; E
)
≥≥E F
;
≥≥F G
_addGroupCommand
¥¥ 
=
¥¥ 
new
¥¥ "
RelayCommand
¥¥# /
<
¥¥/ 0

GroupModel
¥¥0 :
>
¥¥: ;
(
¥¥; <
AddGroup
¥¥< D
)
¥¥D E
;
¥¥E F!
_removeGroupCommand
µµ 
=
µµ  !
new
µµ" %
RelayCommand
µµ& 2
<
µµ2 3

GroupModel
µµ3 =
>
µµ= >
(
µµ> ?
RemoveGroup
µµ? J
)
µµJ K
;
µµK L!
_createGroupCommand
∂∂ 
=
∂∂  !
new
∂∂" %
RelayCommand
∂∂& 2
<
∂∂2 3
Window
∂∂3 9
>
∂∂9 :
(
∂∂: ;
CreateGroup
∂∂; F
)
∂∂F G
;
∂∂G H
}
∑∑ 	
public
ππ "
ObservableCollection
ππ #
<
ππ# $
UserDTO
ππ$ +
>
ππ+ ,
UserList
ππ- 5
{
∫∫ 	
get
ªª 
=>
ªª 
	_userList
ªª 
;
ªª 
set
ºº 
{
ΩΩ 
if
ææ 
(
ææ 
value
ææ 
!=
ææ 
	_userList
ææ &
)
ææ& '
{
øø 
	_userList
¿¿ 
=
¿¿ 
value
¿¿  %
;
¿¿% &
base
¡¡ 
.
¡¡ "
RaisePropertyChanged
¡¡ -
(
¡¡- .
)
¡¡. /
;
¡¡/ 0
}
¬¬ 
}
√√ 
}
ƒƒ 	
public
«« "
ObservableCollection
«« #
<
««# $

GroupModel
««$ .
>
««. /
	GroupList
««0 9
{
»» 	
get
…… 
=>
…… 

_groupList
…… 
;
…… 
set
   
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
value
ÃÃ 
!=
ÃÃ 

_groupList
ÃÃ '
)
ÃÃ' (
{
ÕÕ 

_groupList
ŒŒ 
=
ŒŒ  
value
ŒŒ! &
;
ŒŒ& '
base
œœ 
.
œœ "
RaisePropertyChanged
œœ -
(
œœ- .
)
œœ. /
;
œœ/ 0
}
–– 
}
—— 
}
““ 	
private
‘‘ 
RelayCommand
‘‘ 
<
‘‘ 
UserDTO
‘‘ $
>
‘‘$ %
_addUserCommand
‘‘& 5
;
‘‘5 6
private
’’ 
RelayCommand
’’ 
<
’’ 
UserDTO
’’ $
>
’’$ % 
_removeUserCommand
’’& 8
;
’’8 9
public
◊◊ 
RelayCommand
◊◊ 
<
◊◊ 
UserDTO
◊◊ #
>
◊◊# $
AddUserCommand
◊◊% 3
{
◊◊4 5
get
◊◊6 9
{
◊◊: ;
return
◊◊< B
_addUserCommand
◊◊C R
;
◊◊R S
}
◊◊T U
}
◊◊V W
public
ÿÿ 
RelayCommand
ÿÿ 
<
ÿÿ 
UserDTO
ÿÿ #
>
ÿÿ# $
RemoveUserCommand
ÿÿ% 6
{
ÿÿ7 8
get
ÿÿ9 <
{
ÿÿ= >
return
ÿÿ? E 
_removeUserCommand
ÿÿF X
;
ÿÿX Y
}
ÿÿZ [
}
ÿÿ\ ]
public
⁄⁄ 
void
⁄⁄ 
AddUser
⁄⁄ 
(
⁄⁄ 
UserDTO
⁄⁄ #
user
⁄⁄$ (
)
⁄⁄( )
{
€€ 	
Group
‹‹ 
.
‹‹ 
Users
‹‹ 
.
‹‹ 
Add
‹‹ 
(
‹‹ 
user
‹‹  
)
‹‹  !
;
‹‹! "
UserList
›› 
.
›› 
Remove
›› 
(
›› 
user
››  
)
››  !
;
››! "
base
ﬁﬁ 
.
ﬁﬁ "
RaisePropertyChanged
ﬁﬁ %
(
ﬁﬁ% &
)
ﬁﬁ& '
;
ﬁﬁ' (
}
ﬂﬂ 	
public
·· 
void
·· 

RemoveUser
·· 
(
·· 
UserDTO
·· &
user
··' +
)
··+ ,
{
‚‚ 	
UserList
„„ 
.
„„ 
Add
„„ 
(
„„ 
user
„„ 
)
„„ 
;
„„ 
Group
‰‰ 
.
‰‰ 
Users
‰‰ 
.
‰‰ 
Remove
‰‰ 
(
‰‰ 
user
‰‰ #
)
‰‰# $
;
‰‰$ %
base
ÂÂ 
.
ÂÂ "
RaisePropertyChanged
ÂÂ %
(
ÂÂ% &
)
ÂÂ& '
;
ÂÂ' (
}
ÊÊ 	
private
ÈÈ 
RelayCommand
ÈÈ 
<
ÈÈ 

GroupModel
ÈÈ '
>
ÈÈ' (
_addGroupCommand
ÈÈ) 9
;
ÈÈ9 :
private
ÍÍ 
RelayCommand
ÍÍ 
<
ÍÍ 

GroupModel
ÍÍ '
>
ÍÍ' (!
_removeGroupCommand
ÍÍ) <
;
ÍÍ< =
public
ÏÏ 
RelayCommand
ÏÏ 
<
ÏÏ 

GroupModel
ÏÏ &
>
ÏÏ& '
AddGroupCommand
ÏÏ( 7
{
ÏÏ8 9
get
ÏÏ: =
{
ÏÏ> ?
return
ÏÏ@ F
_addGroupCommand
ÏÏG W
;
ÏÏW X
}
ÏÏY Z
}
ÏÏ[ \
public
ÌÌ 
RelayCommand
ÌÌ 
<
ÌÌ 

GroupModel
ÌÌ &
>
ÌÌ& ' 
RemoveGroupCommand
ÌÌ( :
{
ÌÌ; <
get
ÌÌ= @
{
ÌÌA B
return
ÌÌC I!
_removeGroupCommand
ÌÌJ ]
;
ÌÌ] ^
}
ÌÌ_ `
}
ÌÌa b
public
ÔÔ 
void
ÔÔ 
AddGroup
ÔÔ 
(
ÔÔ 

GroupModel
ÔÔ '
group
ÔÔ( -
)
ÔÔ- .
{
 	
if
ÒÒ 
(
ÒÒ 
group
ÒÒ 
!=
ÒÒ 
null
ÒÒ 
)
ÒÒ 
{
ÚÚ 
Group
ÛÛ 
.
ÛÛ 
Groups
ÛÛ 
.
ÛÛ 
Add
ÛÛ  
(
ÛÛ  !
group
ÛÛ! &
)
ÛÛ& '
;
ÛÛ' (
	GroupList
ÙÙ 
.
ÙÙ 
Remove
ÙÙ  
(
ÙÙ  !
group
ÙÙ! &
)
ÙÙ& '
;
ÙÙ' (
base
ıı 
.
ıı "
RaisePropertyChanged
ıı )
(
ıı) *
)
ıı* +
;
ıı+ ,
}
ˆˆ 
}
˜˜ 	
public
˘˘ 
void
˘˘ 
RemoveGroup
˘˘ 
(
˘˘  

GroupModel
˘˘  *
group
˘˘+ 0
)
˘˘0 1
{
˙˙ 	
if
˚˚ 
(
˚˚ 
group
˚˚ 
!=
˚˚ 
null
˚˚ 
)
˚˚ 
{
¸¸ 
Group
˝˝ 
.
˝˝ 
Groups
˝˝ 
.
˝˝ 
Remove
˝˝ #
(
˝˝# $
group
˝˝$ )
)
˝˝) *
;
˝˝* +
	GroupList
˛˛ 
.
˛˛ 
Add
˛˛ 
(
˛˛ 
group
˛˛ #
)
˛˛# $
;
˛˛$ %
base
ˇˇ 
.
ˇˇ "
RaisePropertyChanged
ˇˇ )
(
ˇˇ) *
)
ˇˇ* +
;
ˇˇ+ ,
}
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
RelayCommand
ÉÉ 
<
ÉÉ 
Window
ÉÉ #
>
ÉÉ# $!
_createGroupCommand
ÉÉ% 8
;
ÉÉ8 9
public
ÖÖ 
RelayCommand
ÖÖ 
<
ÖÖ 
Window
ÖÖ "
>
ÖÖ" # 
CreateGroupCommand
ÖÖ$ 6
{
ÖÖ7 8
get
ÖÖ9 <
{
ÖÖ= >
return
ÖÖ? E!
_createGroupCommand
ÖÖF Y
;
ÖÖY Z
}
ÖÖ[ \
}
ÖÖ] ^
public
áá 
void
áá 
CreateGroup
áá 
(
áá  
Window
áá  &
window
áá' -
)
áá- .
{
àà 	
if
ââ 
(
ââ 
Group
ââ 
.
ââ 
	GroupName
ââ 
==
ââ  "
_oldName
ââ# +
)
ââ+ ,
{
ää $
_administrationService
ãã &
.
ãã& '
	EditGroup
ãã' 0
(
ãã0 1
Mapper
ãã1 7
.
ãã7 8
Map
ãã8 ;
<
ãã; <

GroupModel
ãã< F
,
ããF G
GroupDTO
ããH P
>
ããP Q
(
ããQ R
Group
ããR W
)
ããW X
,
ããX Y
Mapper
ããZ `
.
ãã` a
Map
ããa d
<
ããd e
IEnumerable
ããe p
<
ããp q

GroupModel
ããq {
>
ãã{ |
,
ãã| }
ICollectionãã~ â
<ããâ ä
GroupDTOããä í
>ããí ì
>ããì î
(ããî ï
Groupããï ö
.ããö õ
Groupsããõ °
)ãã° ¢
,ãã¢ £
Groupãã§ ©
.ãã© ™
Usersãã™ Ø
)ããØ ∞
;ãã∞ ±
window
åå 
.
åå 
Close
åå 
(
åå 
)
åå 
;
åå 
}
çç 
else
éé 
{
èè 
if
êê 
(
êê 
Group
êê 
.
êê 
	GroupName
êê #
!=
êê$ &
null
êê' +
)
êê+ ,
{
ëë 
if
íí 
(
íí $
_administrationService
íí -
.
íí- .

CheckGroup
íí. 8
(
íí8 9
Group
íí9 >
.
íí> ?
	GroupName
íí? H
)
ííH I
)
ííI J
{
ìì $
_administrationService
îî .
.
îî. /
	EditGroup
îî/ 8
(
îî8 9
Mapper
îî9 ?
.
îî? @
Map
îî@ C
<
îîC D

GroupModel
îîD N
,
îîN O
GroupDTO
îîO W
>
îîW X
(
îîX Y
Group
îîY ^
)
îî^ _
,
îî_ `
Mapper
îîa g
.
îîg h
Map
îîh k
<
îîk l
IEnumerable
îîl w
<
îîw x

GroupModelîîx Ç
>îîÇ É
,îîÉ Ñ
ICollectionîîÖ ê
<îîê ë
GroupDTOîîë ô
>îîô ö
>îîö õ
(îîõ ú
Groupîîú °
.îî° ¢
Groupsîî¢ ®
)îî® ©
,îî© ™
Groupîî´ ∞
.îî∞ ±
Usersîî± ∂
)îî∂ ∑
;îî∑ ∏
window
ïï 
.
ïï 
Close
ïï $
(
ïï$ %
)
ïï% &
;
ïï& '
}
ññ 
else
óó 
{
óó 

MessageBox
óó %
.
óó% &
Show
óó& *
(
óó* +
$str
óó+ E
)
óóE F
;
óóF G
}
óóH I
}
òò 
else
ôô 
{
öö 

MessageBox
õõ 
.
õõ 
Show
õõ #
(
õõ# $
$str
õõ$ 8
)
õõ8 9
;
õõ9 :
}
úú 
}
ùù 
}
ûû 	
}
üü 
}†† ´N
uC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\Users\AddUserViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Administration -
.- .
Users. 3
{ 
public 

class 
AddUserViewModel !
:" #
ViewModelBase$ 1
{ 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
private  
ObservableCollection $
<$ %
RoleDTO% ,
>, -
	_roleList. 7
;7 8
private  
ObservableCollection $
<$ %
GroupDTO% -
>- .

_groupList/ 9
;9 :
public 
	UserModel 
User 
{ 
get  #
;# $
set% (
;( )
}* +
public 
AddUserViewModel 
(  "
IAdministrationService  6!
administrationService7 L
)L M
{ 	"
_administrationService "
=# $!
administrationService% :
;: ;
	_roleList 
= 
new  
ObservableCollection 0
<0 1
RoleDTO1 8
>8 9
(9 :"
_administrationService: P
.P Q
GetRolesQ Y
(Y Z
)Z [
)[ \
;\ ]

_groupList 
= 
new  
ObservableCollection 1
<1 2
GroupDTO2 :
>: ;
(; <"
_administrationService< R
.R S
	GetGroupsS \
(\ ]
)] ^
)^ _
;_ `
_addRoleCommand 
= 
new !
RelayCommand" .
<. /
RoleDTO/ 6
>6 7
(7 8
AddRole8 ?
)? @
;@ A
_removeRoleCommand 
=  
new! $
RelayCommand% 1
<1 2
RoleDTO2 9
>9 :
(: ;

RemoveRole; E
)E F
;F G
_addGroupCommand   
=   
new   "
RelayCommand  # /
<  / 0
GroupDTO  0 8
>  8 9
(  9 :
AddGroup  : B
)  B C
;  C D
_removeGroupCommand!! 
=!!  !
new!!" %
RelayCommand!!& 2
<!!2 3
GroupDTO!!3 ;
>!!; <
(!!< =
RemoveGroup!!= H
)!!H I
;!!I J
_createUserCommand"" 
=""  
new""! $
RelayCommand""% 1
<""1 2
Window""2 8
>""8 9
(""9 :

CreateUser"": D
)""D E
;""E F
User$$ 
=$$ 
new$$ 
	UserModel$$  
($$  !
)$$! "
;$$" #
}%% 	
public''  
ObservableCollection'' #
<''# $
RoleDTO''$ +
>''+ ,
RoleList''- 5
{(( 	
get)) 
=>)) 
	_roleList)) 
;)) 
set** 
{++ 
if,, 
(,, 
value,, 
!=,, 
	_roleList,, %
),,% &
{-- 
	_roleList.. 
=.. 
value..  %
;..% &
base// 
.//  
RaisePropertyChanged// -
(//- .
)//. /
;/// 0
}00 
}11 
}22 	
public44  
ObservableCollection44 #
<44# $
GroupDTO44$ ,
>44, -
	GroupList44. 7
{55 	
get66 
=>66 

_groupList66 
;66 
set77 
{88 
if99 
(99 
value99 
!=99 

_groupList99 '
)99' (
{:: 

_groupList;; 
=;;  
value;;! &
;;;& '
base<< 
.<<  
RaisePropertyChanged<< -
(<<- .
)<<. /
;<</ 0
}== 
}>> 
}?? 	
privateAA 
RelayCommandAA 
<AA 
RoleDTOAA $
>AA$ %
_addRoleCommandAA& 5
;AA5 6
privateBB 
RelayCommandBB 
<BB 
RoleDTOBB $
>BB$ %
_removeRoleCommandBB& 8
;BB8 9
publicDD 
RelayCommandDD 
<DD 
RoleDTODD #
>DD# $
AddRoleCommandDD% 3
{DD4 5
getDD6 9
{DD: ;
returnDD< B
_addRoleCommandDDC R
;DDR S
}DDT U
}DDV W
publicEE 
RelayCommandEE 
<EE 
RoleDTOEE #
>EE# $
RemoveRoleCommandEE% 6
{EE7 8
getEE9 <
{EE= >
returnEE? E
_removeRoleCommandEEF X
;EEX Y
}EEZ [
}EE\ ]
publicGG 
voidGG 
AddRoleGG 
(GG 
RoleDTOGG #
roleGG$ (
)GG( )
{HH 	
UserII 
.II 
RolesII 
.II 
AddII 
(II 
roleII 
)II  
;II  !
RoleListJJ 
.JJ 
RemoveJJ 
(JJ 
roleJJ  
)JJ  !
;JJ! "
baseKK 
.KK  
RaisePropertyChangedKK %
(KK% &
)KK& '
;KK' (
}LL 	
publicNN 
voidNN 

RemoveRoleNN 
(NN 
RoleDTONN &
roleNN' +
)NN+ ,
{OO 	
RoleListPP 
.PP 
AddPP 
(PP 
rolePP 
)PP 
;PP 
UserQQ 
.QQ 
RolesQQ 
.QQ 
RemoveQQ 
(QQ 
roleQQ "
)QQ" #
;QQ# $
baseRR 
.RR  
RaisePropertyChangedRR %
(RR% &
)RR& '
;RR' (
}SS 	
privateVV 
RelayCommandVV 
<VV 
GroupDTOVV %
>VV% &
_addGroupCommandVV' 7
;VV7 8
privateWW 
RelayCommandWW 
<WW 
GroupDTOWW %
>WW% &
_removeGroupCommandWW' :
;WW: ;
publicYY 
RelayCommandYY 
<YY 
GroupDTOYY $
>YY$ %
AddGroupCommandYY& 5
{YY6 7
getYY8 ;
{YY< =
returnYY> D
_addGroupCommandYYE U
;YYU V
}YYW X
}YYY Z
publicZZ 
RelayCommandZZ 
<ZZ 
GroupDTOZZ $
>ZZ$ %
RemoveGroupCommandZZ& 8
{ZZ9 :
getZZ; >
{ZZ? @
returnZZA G
_removeGroupCommandZZH [
;ZZ[ \
}ZZ] ^
}ZZ_ `
public\\ 
void\\ 
AddGroup\\ 
(\\ 
GroupDTO\\ %
group\\& +
)\\+ ,
{]] 	
User^^ 
.^^ 
Groups^^ 
.^^ 
Add^^ 
(^^ 
group^^ !
)^^! "
;^^" #
	GroupList__ 
.__ 
Remove__ 
(__ 
group__ "
)__" #
;__# $
base`` 
.``  
RaisePropertyChanged`` %
(``% &
)``& '
;``' (
}aa 	
publiccc 
voidcc 
RemoveGroupcc 
(cc  
GroupDTOcc  (
groupcc) .
)cc. /
{dd 	
	GroupListee 
.ee 
Addee 
(ee 
groupee 
)ee  
;ee  !
Userff 
.ff 
Groupsff 
.ff 
Removeff 
(ff 
groupff $
)ff$ %
;ff% &
basegg 
.gg  
RaisePropertyChangedgg %
(gg% &
)gg& '
;gg' (
}hh 	
privatejj 
RelayCommandjj 
<jj 
Windowjj #
>jj# $
_createUserCommandjj% 7
;jj7 8
publicll 
RelayCommandll 
<ll 
Windowll "
>ll" #
CreateUserCommandll$ 5
{ll6 7
getll8 ;
{ll< =
returnll> D
_createUserCommandllE W
;llW X
}llY Z
}ll[ \
publicnn 
voidnn 

CreateUsernn 
(nn 
Windownn %
windownn& ,
)nn, -
{oo 	
ifpp 
(pp 
Userpp 
.pp 
UserNamepp 
!=pp  
nullpp! %
&&pp& (
Userpp) -
.pp- .
Passwordpp. 6
!=pp7 9
nullpp: >
)pp> ?
{qq 
ifrr 
(rr "
_administrationServicerr *
.rr* +
	CheckUserrr+ 4
(rr4 5
Userrr5 9
.rr9 :
UserNamerr: B
)rrB C
)rrC D
{ss "
_administrationServicett *
.tt* +

CreateUsertt+ 5
(tt5 6
Mappertt6 <
.tt< =
Maptt= @
<tt@ A
	UserModelttA J
,ttJ K
UserDTOttL S
>ttS T
(ttT U
UserttU Y
)ttY Z
,ttZ [
Usertt\ `
.tt` a
Groupstta g
,ttg h
Usertti m
.ttm n
Rolesttn s
)tts t
;ttt u
windowuu 
.uu 
Closeuu  
(uu  !
)uu! "
;uu" #
}vv 
elseww 
{xx 

MessageBoxyy 
.yy 
Showyy #
(yy# $
$stryy$ M
)yyM N
;yyN O
}zz 
}{{ 
else{{ 
{|| 

MessageBox}} 
.}} 
Show}} 
(}}  
$str}}  4
)}}4 5
;}}5 6
}~~ 
} 	
}
ÅÅ 
}ÇÇ ûz
vC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\Users\EditUserViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Administration -
.- .
Users. 3
{ 
public 

class 
EditUserViewModel "
:# $
ViewModelBase% 2
{ 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
private 
	UserModel 
_user 
;  
private 
string 
_oldUserName #
;# $
private 
string 
_oldPassword #
;# $
private 
string 
	_password  
;  !
private  
ObservableCollection $
<$ %
RoleDTO% ,
>, -
	_roleList. 7
;7 8
private  
ObservableCollection $
<$ %
GroupDTO% -
>- .

_groupList/ 9
;9 :
public 
	UserModel 
User 
{   	
get!! 
=>!! 
_user!! 
;!! 
set"" 
{## 
if$$ 
($$ 
value$$ 
!=$$ 
null$$ !
)$$! "
{%% 
_user&& 
=&& 
value&& !
;&&! "
base&&# '
.&&' ( 
RaisePropertyChanged&&( <
(&&< =
)&&= >
;&&> ?
}'' 
}(( 
})) 	
public++  
ObservableCollection++ #
<++# $
RoleDTO++$ +
>+++ ,
RoleList++- 5
{,, 	
get-- 
=>-- 
	_roleList-- 
;-- 
set.. 
{// 
if00 
(00 
value00 
!=00 
null00 !
)00! "
{11 
	_roleList22 
=22 
value22  %
;22% &
base33 
.33  
RaisePropertyChanged33 -
(33- .
)33. /
;33/ 0
}44 
}55 
}66 	
public88  
ObservableCollection88 #
<88# $
GroupDTO88$ ,
>88, -
	GroupList88. 7
{99 	
get:: 
=>:: 

_groupList:: 
;:: 
set;; 
{<< 
if== 
(== 
value== 
!=== 
null== !
)==! "
{>> 

_groupList?? 
=??  
value??! &
;??& '
base@@ 
.@@  
RaisePropertyChanged@@ -
(@@- .
)@@. /
;@@/ 0
}AA 
}BB 
}CC 	
privateEE 
RelayCommandEE 
<EE 
RoleDTOEE $
>EE$ %
_addRoleCommandEE& 5
;EE5 6
privateFF 
RelayCommandFF 
<FF 
RoleDTOFF $
>FF$ %
_removeRoleCommandFF& 8
;FF8 9
publicHH 
RelayCommandHH 
<HH 
RoleDTOHH #
>HH# $
AddRoleCommandHH% 3
{HH4 5
getHH6 9
{HH: ;
returnHH< B
_addRoleCommandHHC R
;HHR S
}HHT U
}HHV W
publicII 
RelayCommandII 
<II 
RoleDTOII #
>II# $
RemoveRoleCommandII% 6
{II7 8
getII9 <
{II= >
returnII? E
_removeRoleCommandIIF X
;IIX Y
}IIZ [
}II\ ]
publicKK 
voidKK 
AddRoleKK 
(KK 
RoleDTOKK #
roleKK$ (
)KK( )
{LL 	
UserMM 
.MM 
RolesMM 
.MM 
AddMM 
(MM 
roleMM 
)MM  
;MM  !
RoleListNN 
.NN 
RemoveNN 
(NN 
roleNN  
)NN  !
;NN! "
baseOO 
.OO  
RaisePropertyChangedOO %
(OO% &
)OO& '
;OO' (
}PP 	
publicRR 
voidRR 

RemoveRoleRR 
(RR 
RoleDTORR &
roleRR' +
)RR+ ,
{SS 	
ifTT 
(TT 
roleTT 
.TT 
NameTT 
.TT 
EqualsTT  
(TT  !
$strTT! (
)TT( )
&&TT* ,"
_administrationServiceTT- C
.TTC D
GetNumberOfAdminsTTD U
(TTU V
)TTV W
==TTX Z
$numTT[ \
&&TT] _
UserTT` d
.TTd e
IsActiveTTe m
)TTm n
{UU 

MessageBoxVV 
.VV 
ShowVV 
(VV  
$strVV  X
)VVX Y
;VVY Z
}WW 
elseXX 
{YY 
RoleListZZ 
.ZZ 
AddZZ 
(ZZ 
roleZZ !
)ZZ! "
;ZZ" #
User[[ 
.[[ 
Roles[[ 
.[[ 
Remove[[ !
([[! "
role[[" &
)[[& '
;[[' (
base\\ 
.\\  
RaisePropertyChanged\\ )
(\\) *
)\\* +
;\\+ ,
}]] 
}^^ 	
privateaa 
RelayCommandaa 
<aa 
GroupDTOaa %
>aa% &
_addGroupCommandaa' 7
;aa7 8
privatebb 
RelayCommandbb 
<bb 
GroupDTObb %
>bb% &
_removeGroupCommandbb' :
;bb: ;
publicdd 
RelayCommanddd 
<dd 
GroupDTOdd $
>dd$ %
AddGroupCommanddd& 5
{dd6 7
getdd8 ;
{dd< =
returndd> D
_addGroupCommandddE U
;ddU V
}ddW X
}ddY Z
publicee 
RelayCommandee 
<ee 
GroupDTOee $
>ee$ %
RemoveGroupCommandee& 8
{ee9 :
getee; >
{ee? @
returneeA G
_removeGroupCommandeeH [
;ee[ \
}ee] ^
}ee_ `
publicgg 
voidgg 
AddGroupgg 
(gg 
GroupDTOgg %
groupgg& +
)gg+ ,
{hh 	
Userii 
.ii 
Groupsii 
.ii 
Addii 
(ii 
groupii !
)ii! "
;ii" #
	GroupListjj 
.jj 
Removejj 
(jj 
groupjj "
)jj" #
;jj# $
basekk 
.kk  
RaisePropertyChangedkk %
(kk% &
)kk& '
;kk' (
}ll 	
publicnn 
voidnn 
RemoveGroupnn 
(nn  
GroupDTOnn  (
groupnn) .
)nn. /
{oo 	
	GroupListpp 
.pp 
Addpp 
(pp 
grouppp 
)pp  
;pp  !
Userqq 
.qq 
Groupsqq 
.qq 
Removeqq 
(qq 
groupqq $
)qq$ %
;qq% &
baserr 
.rr  
RaisePropertyChangedrr %
(rr% &
)rr& '
;rr' (
}ss 	
privateuu 
RelayCommanduu 
<uu 
Windowuu #
>uu# $
_editUserCommanduu% 5
;uu5 6
publicww 
RelayCommandww 
<ww 
Windowww "
>ww" #
EditUserCommandww$ 3
{ww4 5
getww6 9
{ww: ;
returnww< B
_editUserCommandwwC S
;wwS T
}wwU V
}wwW X
publicyy 
voidyy 
EditUseryy 
(yy 
Windowyy #
windowyy$ *
)yy* +
{zz 	
if{{ 
({{ 
	_password{{ 
.{{ 
Equals{{  
({{  !
User{{! %
.{{% &
Password{{& .
){{. /
){{/ 0
{|| 
User}} 
.}} 
Password}} 
=}} 
_oldPassword}}  ,
;}}, -
}~~ 
if 
( 
_oldUserName 
== 
User  $
.$ %
UserName% -
&&. 0
User1 5
.5 6
Password6 >
!=? A
nullA E
)E F
{
ÄÄ $
_administrationService
ÅÅ &
.
ÅÅ& '
EditUser
ÅÅ' /
(
ÅÅ/ 0
Mapper
ÅÅ0 6
.
ÅÅ6 7
Map
ÅÅ7 :
<
ÅÅ: ;
	UserModel
ÅÅ; D
,
ÅÅD E
UserDTO
ÅÅF M
>
ÅÅM N
(
ÅÅN O
User
ÅÅO S
)
ÅÅS T
,
ÅÅT U
User
ÅÅV Z
.
ÅÅZ [
Groups
ÅÅ[ a
,
ÅÅa b
User
ÅÅc g
.
ÅÅg h
Roles
ÅÅh m
)
ÅÅm n
;
ÅÅn o
window
ÇÇ 
.
ÇÇ 
Close
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
if
ÜÜ 
(
ÜÜ 
User
ÜÜ 
.
ÜÜ 
UserName
ÜÜ !
!=
ÜÜ" $
null
ÜÜ% )
&&
ÜÜ* ,
User
ÜÜ- 1
.
ÜÜ1 2
Password
ÜÜ2 :
!=
ÜÜ: <
null
ÜÜ< @
)
ÜÜ@ A
{
áá 
if
àà 
(
àà $
_administrationService
àà .
.
àà. /
	CheckUser
àà/ 8
(
àà8 9
User
àà9 =
.
àà= >
UserName
àà> F
)
ààF G
)
ààG H
{
ââ $
_administrationService
ää .
.
ää. /
EditUser
ää/ 7
(
ää7 8
Mapper
ää8 >
.
ää> ?
Map
ää? B
<
ääB C
	UserModel
ääC L
,
ääL M
UserDTO
ääN U
>
ääU V
(
ääV W
User
ääW [
)
ää[ \
,
ää\ ]
User
ää^ b
.
ääb c
Groups
ääc i
,
ääi j
User
ääk o
.
ääo p
Roles
ääp u
)
ääu v
;
ääv w
window
ãã 
.
ãã 
Close
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
}
åå 
else
çç 
{
éé 

MessageBox
èè "
.
èè" #
Show
èè# '
(
èè' (
$str
èè( L
)
èèL M
;
èèM N
}
êê 
}
ëë 
else
íí 
{
ìì 

MessageBox
îî 
.
îî 
Show
îî #
(
îî# $
$str
îî$ 8
)
îî8 9
;
îî9 :
}
ïï 
}
ññ 
}
óó 	
public
öö 
EditUserViewModel
öö  
(
öö  !$
IAdministrationService
öö! 7#
administrationService
öö8 M
)
ööM N
{
õõ 	
	_password
úú 
=
úú 
$str
úú 6
;
úú6 7
	Messenger
ùù 
.
ùù 
Default
ùù 
.
ùù 
Register
ùù &
<
ùù& '
	UserModel
ùù' 0
>
ùù0 1
(
ùù1 2
this
ùù2 6
,
ùù6 7
user
ùù8 <
=>
ùù= ?
{
ûû 
if
üü 
(
üü 
user
üü 
!=
üü 
null
üü  
)
üü  !
{
†† 
User
°° 
=
°° 
user
°° 
;
°°  
_oldUserName
¢¢  
=
¢¢! "
user
¢¢# '
.
¢¢' (
UserName
¢¢( 0
;
¢¢0 1
_oldPassword
££  
=
££! "
user
££# '
.
££' (
Password
££( 0
;
££0 1
User
§§ 
.
§§ 
Password
§§ !
=
§§" #
	_password
§§$ -
;
§§- .
RoleList
¶¶ 
=
¶¶ 
new
¶¶ ""
ObservableCollection
¶¶# 7
<
¶¶7 8
RoleDTO
¶¶8 ?
>
¶¶? @
(
¶¶@ A$
_administrationService
¶¶A W
.
¶¶W X
GetRoles
¶¶X `
(
¶¶` a
)
¶¶a b
)
¶¶b c
;
¶¶c d
foreach
ßß 
(
ßß 
var
ßß  
item
ßß! %
in
ßß& (
User
ßß) -
.
ßß- .
Roles
ßß. 3
)
ßß3 4
{
®® 
foreach
©© 
(
©©  
var
©©  #
temp
©©$ (
in
©©) +
RoleList
©©, 4
.
©©4 5
ToList
©©5 ;
(
©©; <
)
©©< =
)
©©= >
{
™™ 
if
´´ 
(
´´ 
item
´´ #
.
´´# $
Name
´´$ (
==
´´) +
temp
´´, 0
.
´´0 1
Name
´´1 5
)
´´5 6
{
¨¨ 
RoleList
≠≠  (
.
≠≠( )
Remove
≠≠) /
(
≠≠/ 0
temp
≠≠0 4
)
≠≠4 5
;
≠≠5 6
}
ÆÆ 
}
ØØ 
}
∞∞ 
	GroupList
≤≤ 
=
≤≤ 
new
≤≤  #"
ObservableCollection
≤≤$ 8
<
≤≤8 9
GroupDTO
≤≤9 A
>
≤≤A B
(
≤≤B C$
_administrationService
≤≤C Y
.
≤≤Y Z
	GetGroups
≤≤Z c
(
≤≤c d
)
≤≤d e
)
≤≤e f
;
≤≤f g
foreach
≥≥ 
(
≥≥ 
var
≥≥  
item
≥≥! %
in
≥≥& (
User
≥≥) -
.
≥≥- .
Groups
≥≥. 4
)
≥≥4 5
{
¥¥ 
foreach
µµ 
(
µµ  !
var
µµ! $
temp
µµ% )
in
µµ* ,
	GroupList
µµ- 6
.
µµ6 7
ToList
µµ7 =
(
µµ= >
)
µµ> ?
)
µµ? @
{
∂∂ 
if
∑∑ 
(
∑∑  
item
∑∑  $
.
∑∑$ %
	GroupName
∑∑% .
==
∑∑/ 1
temp
∑∑2 6
.
∑∑6 7
	GroupName
∑∑7 @
)
∑∑@ A
{
∏∏ 
	GroupList
ππ  )
.
ππ) *
Remove
ππ* 0
(
ππ0 1
temp
ππ1 5
)
ππ5 6
;
ππ6 7
}
∫∫ 
}
ªª 
}
ºº 
	Messenger
ΩΩ 
.
ΩΩ 
Default
ΩΩ %
.
ΩΩ% &

Unregister
ΩΩ& 0
<
ΩΩ0 1
	UserModel
ΩΩ1 :
>
ΩΩ: ;
(
ΩΩ; <
this
ΩΩ< @
)
ΩΩ@ A
;
ΩΩA B
}
ææ 
}
øø 
)
øø 
;
øø $
_administrationService
¿¿ "
=
¿¿# $#
administrationService
¿¿% :
;
¿¿: ;
_addRoleCommand
¬¬ 
=
¬¬ 
new
¬¬ !
RelayCommand
¬¬" .
<
¬¬. /
RoleDTO
¬¬/ 6
>
¬¬6 7
(
¬¬7 8
AddRole
¬¬8 ?
)
¬¬? @
;
¬¬@ A 
_removeRoleCommand
√√ 
=
√√  
new
√√! $
RelayCommand
√√% 1
<
√√1 2
RoleDTO
√√2 9
>
√√9 :
(
√√: ;

RemoveRole
√√; E
)
√√E F
;
√√F G
_addGroupCommand
ƒƒ 
=
ƒƒ 
new
ƒƒ "
RelayCommand
ƒƒ# /
<
ƒƒ/ 0
GroupDTO
ƒƒ0 8
>
ƒƒ8 9
(
ƒƒ9 :
AddGroup
ƒƒ: B
)
ƒƒB C
;
ƒƒC D!
_removeGroupCommand
≈≈ 
=
≈≈  !
new
≈≈" %
RelayCommand
≈≈& 2
<
≈≈2 3
GroupDTO
≈≈3 ;
>
≈≈; <
(
≈≈< =
RemoveGroup
≈≈= H
)
≈≈H I
;
≈≈I J
_editUserCommand
∆∆ 
=
∆∆ 
new
∆∆ "
RelayCommand
∆∆# /
<
∆∆/ 0
Window
∆∆0 6
>
∆∆6 7
(
∆∆7 8
EditUser
∆∆8 @
)
∆∆@ A
;
∆∆A B
}
«« 	
}
»» 
}…… ü5
zC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Administration\Users\ShowAllUsersViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Administration -
.- .
Users. 3
{ 
public 

class !
ShowAllUsersViewModel &
:& '
ViewModelBase( 5
{ 
private 
readonly "
IAdministrationService /"
_administrationService0 F
;F G
private  
ObservableCollection $
<$ %
	UserModel% .
>. /
_users0 6
;6 7
private 
RelayCommand 
< 
	UserModel &
>& '
_editUserCommand( 8
{9 :
get; >
;> ?
}@ A
private 
RelayCommand 
_addUserCommand ,
{- .
get/ 2
;2 3
}4 5
private 
RelayCommand 
< 
	UserModel &
>& '"
_deactivateUserCommand( >
{? @
getA D
;D E
}F G
public !
ShowAllUsersViewModel $
($ %"
IAdministrationService% ;!
administrationService< Q
)Q R
{ 	"
_administrationService "
=# $!
administrationService% :
;: ;
LoadData   
(   
)   
;   
_editUserCommand!! 
=!! 
new!! "
RelayCommand!!# /
<!!/ 0
	UserModel!!0 9
>!!9 :
(!!: ;
EditUser!!; C
)!!C D
;!!D E
_addUserCommand"" 
="" 
new"" !
RelayCommand""" .
("". /
AddUser""/ 6
)""6 7
;""7 8"
_deactivateUserCommand## "
=### $
new##% (
RelayCommand##) 5
<##5 6
	UserModel##6 ?
>##? @
(##@ A
DeactivateUser##A O
)##O P
;##P Q
}$$ 	
public&& 
RelayCommand&& 
<&& 
	UserModel&& %
>&&% &
EditUserCommand&&' 6
{&&7 8
get&&9 <
{&&= >
return&&? E
_editUserCommand&&F V
;&&V W
}&&X Y
}&&Z [
public(( 
RelayCommand(( 
AddUserCommand(( *
{((+ ,
get((- 0
{((1 2
return((3 9
_addUserCommand((: I
;((I J
}((K L
}((M N
public** 
RelayCommand** 
<** 
	UserModel** %
>**% &!
DeactivateUserCommand**' <
{**= >
get**? B
{**C D
return**E K"
_deactivateUserCommand**L b
;**b c
}**d e
}**f g
public,,  
ObservableCollection,, #
<,,# $
	UserModel,,$ -
>,,- .
Users,,/ 4
{-- 	
get.. 
=>.. 
_users.. 
;.. 
set// 
{00 
if11 
(11 
value11 
!=11 
null11 !
)11! "
{22 
_users33 
=33 
value33 "
;33" #
base44 
.44  
RaisePropertyChanged44 -
(44- .
)44. /
;44/ 0
}55 
}66 
}77 	
private99 
void99 
DeactivateUser99 #
(99# $
	UserModel99$ -
user99. 2
)992 3
{:: 	
if;; 
(;; 
user;; 
.;; 
Roles;; 
.;; 
Any;; 
(;; 
r;;  
=>;;! #
r;;$ %
.;;% &
Name;;& *
.;;* +
Equals;;+ 1
(;;1 2
$str;;2 9
);;9 :
);;: ;
&&;;< >"
_administrationService;;? U
.;;U V
GetNumberOfAdmins;;V g
(;;g h
);;h i
==;;j l
$num;;m n
&&;;o q
user;;r v
.;;v w
IsActive;;w 
)	;; Ä
{<< 

MessageBox== 
.== 
Show== 
(==  
$str==  X
)==X Y
;==Y Z
}>> 
else?? 
{@@ "
_administrationServiceAA &
.AA& '
DeactivateUserAA' 5
(AA5 6
userAA6 :
.AA: ;
UserIdAA; A
)AAA B
;AAB C
ifBB 
(BB 
userBB 
.BB 
IsActiveBB !
==BB" $
trueBB% )
)BB) *
{CC 
userDD 
.DD 
IsActiveDD !
=DD" #
falseDD$ )
;DD) *
}EE 
elseFF 
{GG 
userHH 
.HH 
IsActiveHH !
=HH" #
trueHH$ (
;HH( )
}II 
}JJ 
}KK 	
privateMM 
voidMM 
AddUserMM 
(MM 
)MM 
{NN 	
	MessengerOO 
.OO 
DefaultOO 
.OO 
SendOO "
<OO" #
NotificationMessageOO# 6
>OO6 7
(OO7 8
newOO8 ;
NotificationMessageOO< O
(OOO P
$strOOP _
)OO_ `
)OO` a
;OOa b
LoadDataPP 
(PP 
)PP 
;PP 
UsersQQ 
=QQ 
_usersQQ 
;QQ 
}RR 	
privateTT 
voidTT 
EditUserTT 
(TT 
	UserModelTT '
userTT( ,
)TT, -
{UU 	
ifVV 
(VV 
userVV 
!=VV 
nullVV 
)VV 
{WW 
	MessengerXX 
.XX 
DefaultXX !
.XX! "
SendXX" &
<XX& '
	UserModelXX' 0
>XX0 1
(XX1 2
userXX2 6
)XX6 7
;XX7 8
}YY 
}ZZ 	
private\\ 
void\\ 
LoadData\\ 
(\\ 
)\\ 
{]] 	
_users^^ 
=^^ 
new^^  
ObservableCollection^^ -
<^^- .
	UserModel^^. 7
>^^7 8
(^^8 9
Mapper^^9 ?
.^^? @
Map^^@ C
<^^C D
IEnumerable^^D O
<^^O P
UserDTO^^P W
>^^W X
,^^X Y
ICollection^^Y d
<^^d e
	UserModel^^e n
>^^n o
>^^o p
(^^p q#
_administrationService	^^q á
.
^^á à
GetUsers
^^à ê
(
^^ê ë
)
^^ë í
)
^^í ì
)
^^ì î
;
^^î ï
}__ 	
}`` 
}aa Ó
|C:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Appointments\AllAppByLocationWindowViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Appointments +
{ 
public 

class +
AllAppByLocationWindowViewModel 0
:1 2
ViewModelBase3 @
{ 
private  
ObservableCollection $
<$ %
AppointmentModel% 5
>5 6
_appointments7 D
;D E
public  
ObservableCollection #
<# $
AppointmentModel$ 4
>4 5
Appointments6 B
{ 	
get 
=> 
_appointments  
;  !
private 
set 
{ 
if 
( 
value 
!= 
_appointments *
)* +
{ 
_appointments !
=" #
value$ )
;) *
base 
.  
RaisePropertyChanged -
(- .
). /
;/ 0
} 
} 
} 	
public +
AllAppByLocationWindowViewModel .
(. /
IBLLServiceMain/ >
service? F
)F G
{   	
	Messenger!! 
.!! 
Default!! 
.!! 
Register!! &
<!!& '
OpenWindowMessage!!' 8
>!!8 9
(!!9 :
this!!: >
,!!> ?
message!!@ G
=>!!H J
{"" 
if## 
(## 
message## 
.## 
Type##  
==##! #

WindowType##$ .
.##. /
LoadLocations##/ <
&&##= ?
message##@ G
.##G H
Argument##H P
!=##Q S
null##T X
)##X Y
{$$ 
Appointments%%  
=%%! "
new%%# & 
ObservableCollection%%' ;
<%%; <
AppointmentModel%%< L
>%%L M
(%%M N
Mapper%%N T
.%%T U
Map%%U X
<%%X Y
IEnumerable%%Y d
<%%d e
AppointmentDTO%%e s
>%%s t
,%%t u
ICollection	%%v Å
<
%%Å Ç
AppointmentModel
%%Ç í
>
%%í ì
>
%%ì î
(
%%î ï
service
%%ï ú
.
%%ú ù
GetAppsByLocation
%%ù Æ
(
%%Æ Ø
Int32
%%Ø ¥
.
%%¥ µ
Parse
%%µ ∫
(
%%∫ ª
message
%%ª ¬
.
%%¬ √
Argument
%%√ À
)
%%À Ã
)
%%Ã Õ
)
%%Õ Œ
)
%%Œ œ
;
%%œ –
}&& 
}'' 
)'' 
;'' 
}(( 	
})) 
}** —
oC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Authenication\AnonymousIdentity.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Authenication ,
{ 
public		 

class		 
AnonymousIdentity		 "
:		# $
CustomIdentity		% 3
{

 
public 
AnonymousIdentity  
(  !
)! "
: 
base 
( 
$num 
, 
string 
. 
Empty "
," #
string$ *
.* +
Empty+ 0
,0 1
new2 5
string6 <
[< =
]= >
{? @
}A B
)B C
{ 	
}
 
} 
} ˇh
uC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Authenication\AuthenticationViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Authenication ,
{ 
public 

class #
AuthenticationViewModel (
:) *
ViewModelBase+ 8
,8 9"
INotifyPropertyChanged; Q
{ 
private 
readonly "
IAuthenticationService /"
_authenticationService0 F
;F G
private 
readonly 
RelayCommand %
<% &
object& ,
>, -
_loginCommand. ;
;; <
private 
string 
	_username  
;  !
private 
string 
_status 
; 
private 
int 
_progressBarValue %
;% &
private 
string 
_progressText $
;$ %
private 

Visibility 
_progressVisibility .
;. /
public 
string 
ProgressText "
{ 	
get 
=> 
_progressText  
;  !
set 
{ 
_progressText 
=  !
value" '
;' (!
NotifyPropertyChanged) >
(> ?
$str? M
)M N
;N O
}P Q
} 	
public 
int 
ProgressBarValue #
{ 	
get 
=> 
_progressBarValue $
;$ %
set   
{   
_progressBarValue   #
=  $ %
value  & +
;  + ,!
NotifyPropertyChanged  - B
(  B C
$str  C U
)  U V
;  V W
}  X Y
}!! 	
public"" 

Visibility"" 
ProgressVisibility"" ,
{## 	
get$$ 
=>$$ 
_progressVisibility$$ &
;$$& '
set%% 
{%% 
_progressVisibility%% %
=%%& '
value%%( -
;%%- .!
NotifyPropertyChanged%%/ D
(%%D E
$str%%E Y
)%%Y Z
;%%Z [
}%%\ ]
}&& 	
public(( #
AuthenticationViewModel(( &
(((& '"
IAuthenticationService((' =!
authenticationService((> S
)((S T
{)) 	
	Messenger** 
.** 
Default** 
.** 
Register** &
<**& '
NotificationMessage**' :
>**: ;
(**; <
this**< @
,**@ A
e**B C
=>**D F
{++ 
if,, 
(,, 
e,, 
.,, 
Notification,, "
.,," #
Equals,,# )
(,,) *
$str,,* 2
),,2 3
),,3 4
{-- 
ProgressVisibility.. &
=..' (

Visibility..) 3
...3 4
Hidden..4 :
;..: ;!
NotifyPropertyChanged// )
(//) *
$str//* ;
)//; <
;//< =!
NotifyPropertyChanged00 )
(00) *
$str00* =
)00= >
;00> ?
}11 
}22 
)22 
;22 "
_authenticationService33 "
=33# $!
authenticationService33% :
;33: ;
_loginCommand44 
=44 
new44 
RelayCommand44  ,
<44, -
object44- 3
>443 4
(444 5
Login445 :
,44: ;
CanLogin44< D
)44D E
;44E F
Username55 
=55 
$str55 
;55 
ProgressVisibility66 
=66  

Visibility66! +
.66+ ,
Hidden66, 2
;662 3
ProgressBarValue77 
=77 
$num77  
;77  !
ProgressText88 
=88 
$str88 /
;88/ 0
}99 	
public;; 
RelayCommand;; 
<;; 
object;; "
>;;" #
LoginCommand;;$ 0
{;;1 2
get;;3 6
{;;7 8
return;;9 ?
_loginCommand;;@ M
;;;M N
};;O P
};;Q R
public== 
string== 
Username== 
{>> 	
get?? 
{?? 
return?? 
	_username?? "
;??" #
}??$ %
set@@ 
{@@ 
	_username@@ 
=@@ 
value@@ #
;@@# $!
NotifyPropertyChanged@@% :
(@@: ;
$str@@; E
)@@E F
;@@F G
}@@H I
}AA 	
publicCC 
stringCC 
StatusCC 
{DD 	
getEE 
{EE 
returnEE 
_statusEE  
;EE  !
}EE" #
setFF 
{FF 
_statusFF 
=FF 
valueFF !
;FF! "!
NotifyPropertyChangedFF# 8
(FF8 9
$strFF9 A
)FFA B
;FFB C
}FFD E
}GG 	
publicII 
stringII 
AuthenticatedUserII '
{JJ 	
getKK 
{LL 
ifMM 
(MM 
IsAuthenticatedMM #
)MM# $
{NN 
	MessengerOO 
.OO 
DefaultOO %
.OO% &
SendOO& *
(OO* +
newOO+ .
NotificationMessageOO/ B
(OOB C
$strOOC Q
)OOQ R
)OOR S
;OOS T
returnPP 
stringPP !
.PP! "
FormatPP" (
(PP( )
$strPP) ;
,PP; <
ThreadPP= C
.PPC D
CurrentPrincipalPPD T
.PPT U
IdentityPPU ]
.PP] ^
NamePP^ b
)PPb c
;PPc d
}RR 
elseSS 
returnSS 
$strSS 8
;SS8 9
}TT 
}UU 	
privateWW 
voidWW 
workerLogin_DoWorkWW '
(WW' (
objectWW( .
senderWW/ 5
,WW5 6
DoWorkEventArgsWW7 F
eWWG H
)WWH I
{XX 	
PasswordBoxYY 
passwordBoxYY #
=YY$ %
eYY& '
.YY' (
ArgumentYY( 0
asYY1 3
PasswordBoxYY4 ?
;YY? @
stringZZ 
clearTextPasswordZZ $
=ZZ% &
passwordBoxZZ' 2
.ZZ2 3
PasswordZZ3 ;
;ZZ; <
try[[ 
{\\ 
UserDTO]] 
user]] 
=]] "
_authenticationService]] 5
.]]5 6
AuthenticateUser]]6 F
(]]F G
Username]]G O
,]]O P
clearTextPassword]]Q b
)]]b c
;]]c d
CustomPrincipal^^ 
customPrincipal^^  /
=^^0 1
Thread^^2 8
.^^8 9
CurrentPrincipal^^9 I
as^^J L
CustomPrincipal^^M \
;^^\ ]
customPrincipal__ 
=__  !
Thread__" (
.__( )
CurrentPrincipal__) 9
as__: <
CustomPrincipal__= L
;__L M
if`` 
(`` 
customPrincipal`` #
==``$ &
null``' +
)``+ ,
throwaa 
newaa 
ArgumentExceptionaa /
(aa/ 0
$str	aa0 ê
)
aaê ë
;
aaë í
customPrincipalbb 
.bb  
Identitybb  (
=bb) *
newbb+ .
CustomIdentitybb/ =
(bb= >
userbb> B
.bbB C
UserIdbbC I
,bbI J
userbbK O
.bbO P
UserNamebbP X
,bbX Y
userbbZ ^
.bb^ _
Namebb_ c
,bbc d"
_authenticationServicebbe {
.bb{ |
GetRoles	bb| Ñ
(
bbÑ Ö
user
bbÖ â
.
bbâ ä
UserId
bbä ê
)
bbê ë
)
bbë í
;
bbí ì
_loginCommandcc 
.cc "
RaiseCanExecuteChangedcc 4
(cc4 5
)cc5 6
;cc6 7
Statusdd 
=dd 
Stringdd 
.dd  
Emptydd  %
;dd% &!
NotifyPropertyChangedee %
(ee% &
$stree& .
)ee. /
;ee/ 0!
NotifyPropertyChangedff %
(ff% &
$strff& 7
)ff7 8
;ff8 9
ProgressBarValuegg  
=gg! "
$numgg# &
;gg& '
ProgressTexthh 
=hh 
$strhh /
;hh/ 0
Threadii 
.ii 
Sleepii 
(ii 
$numii  
)ii  !
;ii! "!
NotifyPropertyChangedjj %
(jj% &
$strjj& 9
)jj9 :
;jj: ;
}kk 
catchll 
(ll '
UnauthorizedAccessExceptionll .
)ll. /
{mm 
Statusnn 
=nn 
$strnn O
;nnO P
ProgressTextoo 
=oo 
$stroo .
;oo. /!
NotifyPropertyChangedpp %
(pp% &
$strpp& .
)pp. /
;pp/ 0
}qq 
catchrr 
(rr 
	Exceptionrr 
exrr 
)rr  
{ss 
Statustt 
=tt 
stringtt 
.tt  
Formattt  &
(tt& '
$strtt' 3
,tt3 4
extt5 7
.tt7 8
Messagett8 ?
)tt? @
;tt@ A
ProgressTextuu 
=uu 
$struu .
;uu. /!
NotifyPropertyChangedvv %
(vv% &
$strvv& .
)vv. /
;vv/ 0
}ww 
}xx 	
privatezz 
voidzz $
workerProgressBar_DoWorkzz -
(zz- .
objectzz. 4
senderzz5 ;
,zz; <
DoWorkEventArgszz= L
ezzM N
)zzN O
{{{ 	
ProgressVisibility|| 
=||  

Visibility||! +
.||+ ,
Visible||, 3
;||3 4
for~~ 
(~~ 
int~~ 
i~~ 
=~~ 
$num~~ 
;~~ 
i~~ 
<~~  
$num~~! $
;~~$ %
i~~& '
=~~( )
i~~* +
+~~, -
$num~~. 0
)~~0 1
{ 
if
ÄÄ 
(
ÄÄ 
ProgressText
ÄÄ  
!=
ÄÄ! #
$str
ÄÄ$ 3
)
ÄÄ3 4
{
ÅÅ 
if
ÇÇ 
(
ÇÇ 
i
ÇÇ 
==
ÇÇ 
$num
ÇÇ 
)
ÇÇ  
{
ÉÉ 
ProgressText
ÑÑ $
=
ÑÑ% &
$str
ÑÑ' 9
;
ÑÑ9 :
}
ÖÖ 
ProgressBarValue
ÜÜ $
=
ÜÜ% &
i
ÜÜ' (
;
ÜÜ( )
Thread
áá 
.
áá 
Sleep
áá  
(
áá  !
$num
áá! $
)
áá$ %
;
áá% &
}
àà 
else
ââ 
{
ää 
break
ãã 
;
ãã 
}
åå 
}
çç 
}
éé 	
private
êê 
void
êê 
Login
êê 
(
êê 
object
êê !
	parameter
êê" +
)
êê+ ,
{
ëë 	
BackgroundWorker
íí 
workerLogin
íí (
=
íí) *
new
íí+ .
BackgroundWorker
íí/ ?
(
íí? @
)
íí@ A
;
ííA B
workerLogin
ìì 
.
ìì 
DoWork
ìì 
+=
ìì ! 
workerLogin_DoWork
ìì" 4
;
ìì4 5
workerLogin
îî 
.
îî 
RunWorkerAsync
îî &
(
îî& '
	parameter
îî' 0
)
îî0 1
;
îî1 2
BackgroundWorker
ññ 
workerProgressBar
ññ .
=
ññ/ 0
new
ññ1 4
BackgroundWorker
ññ5 E
(
ññE F
)
ññF G
;
ññG H
workerProgressBar
óó 
.
óó 
DoWork
óó $
+=
óó% '&
workerProgressBar_DoWork
óó( @
;
óó@ A
workerProgressBar
òò 
.
òò 
RunWorkerAsync
òò ,
(
òò, -
)
òò- .
;
òò. /
}
ôô 	
private
õõ 
bool
õõ 
CanLogin
õõ 
(
õõ 
object
õõ $
	parameter
õõ% .
)
õõ. /
{
úú 	
return
ùù 
!
ùù 
IsAuthenticated
ùù #
;
ùù# $
}
ûû 	
public
†† 
bool
†† 
IsAuthenticated
†† #
{
°° 	
get
¢¢ 
{
¢¢ 
return
¢¢ 
Thread
¢¢ 
.
¢¢  
CurrentPrincipal
¢¢  0
.
¢¢0 1
Identity
¢¢1 9
.
¢¢9 :
IsAuthenticated
¢¢: I
;
¢¢I J
}
¢¢K L
}
££ 	
public
•• 
event
•• )
PropertyChangedEventHandler
•• 0
PropertyChanged
••1 @
;
••@ A
private
ßß 
void
ßß #
NotifyPropertyChanged
ßß *
(
ßß* +
string
ßß+ 1
propertyName
ßß2 >
)
ßß> ?
{
®® 	
if
©© 
(
©© 
PropertyChanged
©© 
!=
©©  "
null
©©# '
)
©©' (
PropertyChanged
™™ 
(
™™  
this
™™  $
,
™™$ %
new
™™& )&
PropertyChangedEventArgs
™™* B
(
™™B C
propertyName
™™C O
)
™™O P
)
™™P Q
;
™™Q R
}
´´ 	
}
¨¨ 
}≠≠ ≈
lC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Authenication\CustomIdentity.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Authenication ,
{		 
public

 

class

 
CustomIdentity

 
:

  !
	IIdentity

" +
{ 
public 
CustomIdentity 
( 
int !
userId" (
,( )
string) /
name0 4
,4 5
string6 <
username= E
,E F
stringG M
[M N
]N O
rolesP U
)U V
{ 	
UserId 
= 
userId 
; 
Name 
= 
name 
; 
Username 
= 
username 
;  
Roles 
= 
roles 
; 
} 	
public 
string 
Name 
{ 
get  
;  !
private" )
set* -
;- .
}/ 0
public 
int 
UserId 
{ 
get 
;  
private! (
set) ,
;, -
}. /
public 
string 
Username 
{  
get! $
;$ %
private& -
set. 1
;1 2
}3 4
public 
string 
[ 
] 
Roles 
{ 
get  #
;# $
private% ,
set- 0
;0 1
}2 3
public 
string 
AuthenticationType (
{) *
get+ .
{/ 0
return1 7
$str8 O
;O P
}Q R
}S T
public 
bool 
IsAuthenticated #
{$ %
get& )
{* +
return, 2
!3 4
string4 :
.: ;
IsNullOrEmpty; H
(H I
NameI M
)M N
;N O
}P Q
}R S
} 
} “
mC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Authenication\CustomPrincipal.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Authenication ,
{		 
public

 

class

 
CustomPrincipal

  
:

! "

IPrincipal

# -
{ 
private 
CustomIdentity 
	_identity (
;( )
public 
CustomIdentity 
Identity &
{ 	
get 
{ 
return 
	_identity "
??# %
new& )
AnonymousIdentity* ;
(; <
)< =
;= >
}? @
set 
{ 
	_identity 
= 
value #
;# $
}% &
} 	
	IIdentity 

IPrincipal 
. 
Identity %
{ 	
get 
{ 
return 
this 
. 
Identity &
;& '
}( )
} 	
public 
bool 
IsInRole 
( 
string #
role$ (
)( )
{ 	
return 
	_identity 
. 
Roles "
." #
Contains# +
(+ ,
role, 0
)0 1
;1 2
} 	
} 
} ß.
pC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Calendar\CalendarWindowViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Calendar '
{ 
public 

class #
CalendarWindowViewModel (
:) *
ViewModelBase+ 8
{ 
private 
readonly 
IBLLServiceMain (
_service) 1
;1 2
private 
readonly 
int 
_id  
;  !
private  
ObservableCollection $
<$ %
AppointmentDTO% 3
>3 4
_appointments5 B
;B C
private  
ObservableCollection $
<$ %
UserDTO% ,
>, -
_users. 4
;4 5
private 
UserDTO 
_selectedSyncUser )
;) *
public  
ObservableCollection #
<# $
UserDTO$ +
>+ ,
Users- 2
{ 	
get 
=> 
_users 
; 
set 
{ 
if 
( 
value 
!= 
_users #
)# $
{ 
_users 
= 
value "
;" #
base 
.  
RaisePropertyChanged -
(- .
). /
;/ 0
}   
}!! 
}"" 	
public##  
ObservableCollection## #
<### $
AppointmentDTO##$ 2
>##2 3
Appointments##4 @
{$$ 	
get%% 
=>%% 
_appointments%%  
;%%  !
set&& 
{'' 
if(( 
((( 
value(( 
!=(( 
_appointments(( *
)((* +
{)) 
_appointments** !
=**" #
value**$ )
;**) *
base++ 
.++  
RaisePropertyChanged++ -
(++- .
)++. /
;++/ 0
},, 
}-- 
}.. 	
public// 
UserDTO// 
SelectedSyncUser// '
{00 	
get11 
=>11 
_selectedSyncUser11 $
;11$ %
set22 
{33 
if44 
(44 
value44 
!=44 
_selectedSyncUser44 .
)44. /
{55 
_selectedSyncUser66 %
=66& '
value66( -
;66- .
base77 
.77  
RaisePropertyChanged77 -
(77- .
)77. /
;77/ 0
}88 
}99 
}:: 	
public<< 
RelayCommand<< 
<<< 
object<< "
><<" #
SyncCommand<<$ /
{<<0 1
get<<2 5
;<<5 6
}<<7 8
public>> #
CalendarWindowViewModel>> &
(>>& '
IBLLServiceMain>>' 6
service>>7 >
)>>> ?
{?? 	
_service@@ 
=@@ 
service@@ 
;@@ 
CustomPrincipalAA 
cpAA 
=AA  
(AA! "
CustomPrincipalAA" 1
)AA1 2
ThreadAA2 8
.AA8 9
CurrentPrincipalAA9 I
;AAI J
ifBB 
(BB 
cpBB 
!=BB 
nullBB 
)BB 
_idBB 
=BB  !
cpBB" $
.BB$ %
IdentityBB% -
.BB- .
UserIdBB. 4
;BB4 5
LoadDataCC 
(CC 
)CC 
;CC 
SyncCommandDD 
=DD 
newDD 
RelayCommandDD *
<DD* +
objectDD+ 1
>DD1 2
(DD2 3
SyncWithUserDD3 ?
)DD? @
;DD@ A
}EE 	
privateGG 
voidGG 
SyncWithUserGG !
(GG! "
objectGG" (
startGG) .
)GG. /
{HH 	
ifII 
(II 
_selectedSyncUserII !
!=II" $
nullII% )
)II) *
{JJ 
	MessengerKK 
.KK 
DefaultKK !
.KK! "
SendKK" &
(KK& '
newKK' *
OpenWindowMessageKK+ <
{KK= >
TypeKK? C
=KKD E

WindowTypeKKF P
.KKP Q
SyncKKQ U
,KKU V
UserKKW [
=KK\ ]
newKK^ a
UserDTOKKb i
{KKj k
UserIdKKl r
=KKs t
_selectedSyncUser	KKu Ü
.
KKÜ á
UserId
KKá ç
}
KKé è
,
KKè ê
Argument
KKë ô
=
KKö õ
start
KKú °
.
KK° ¢
ToString
KK¢ ™
(
KK™ ´
)
KK´ ¨
}
KK¨ ≠
)
KK≠ Æ
;
KKÆ Ø
}LL 
}MM 	
privateNN 
voidNN 
LoadDataNN 
(NN 
)NN 
{OO 	
tryPP 
{QQ 
AppointmentsRR 
=RR 
newRR " 
ObservableCollectionRR# 7
<RR7 8
AppointmentDTORR8 F
>RRF G
(RRG H
_serviceRRH P
.RRP Q&
GetAppointmentsForCalendarRRQ k
(RRk l
_idRRl o
)RRo p
)RRp q
;RRq r
UsersSS 
=SS 
newSS  
ObservableCollectionSS 0
<SS0 1
UserDTOSS1 8
>SS8 9
(SS9 :
_serviceSS: B
.SSB C
GetUsersSSC K
(SSK L
)SSL M
)SSM N
;SSN O
}TT 
catchUU 
(UU 
	ExceptionUU 
eUU 
)UU 
{VV 

MessageBoxWW 
.WW 
ShowWW 
(WW  
eWW  !
.WW! "
ToStringWW" *
(WW* +
)WW+ ,
)WW, -
;WW- .
}XX 
}YY 	
}ZZ 
}[[ ™‰
pC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Appointments\MainWindowViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Appointments +
{ 
public 

class 
MainWindowViewModel $
:% &
ViewModelBase' 4
{ 
private 
readonly 
IBLLServiceMain (
_service) 1
;1 2
private 
readonly 
ILogService $
_logService% 0
;0 1
private 
readonly 
INotifyService '
_notifyService( 6
;6 7
private 
readonly 
int 
_id  
;  !
private 
readonly 
DispatcherTimer (
_timer) /
;/ 0
private!! 
DateTime!! 
_dateTimeNow!! %
;!!% &
private""  
ObservableCollection"" $
<""$ %
AppointmentModel""% 5
>""5 6
_appointments""7 D
;""D E
private##  
ObservableCollection## $
<##$ %
FileInfo##% -
>##- .
_files##/ 5
;##5 6
private$$ 
FileInfo$$ 
_selectTheme$$ %
;$$% &
public&& 
DateTime&& 
CurrentDateTime&& '
{'' 	
get(( 
=>(( 
_dateTimeNow(( 
;((  
set)) 
{** 
_dateTimeNow++ 
=++ 
value++ $
;++$ %
base,, 
.,,  
RaisePropertyChanged,, )
(,,) *
),,* +
;,,+ ,
}-- 
}.. 	
public//  
ObservableCollection// #
<//# $
AppointmentModel//$ 4
>//4 5
Appointments//6 B
{00 	
get11 
=>11 
_appointments11  
;11  !
set22 
{33 
if44 
(44 
value44 
!=44 
_appointments44 *
)44* +
{55 
_appointments66 !
=66" #
value66$ )
;66) *
base77 
.77  
RaisePropertyChanged77 -
(77- .
)77. /
;77/ 0
}88 
}99 
}:: 	
public;;  
ObservableCollection;; #
<;;# $
FileInfo;;$ ,
>;;, -
Files;;. 3
{<< 	
get== 
=>== 
_files== 
;== 
set>> 
{?? 
_files@@ 
=@@ 
value@@ 
;@@ 
baseAA 
.AA  
RaisePropertyChangedAA )
(AA) *
)AA* +
;AA+ ,
}BB 
}CC 	
publicDD 
FileInfoDD 
SelectedThemeDD %
{EE 	
getFF 
=>FF 
_selectThemeFF 
;FF  
setGG 
{HH 
_selectThemeII 
=II 
valueII $
;II$ %
baseJJ 
.JJ  
RaisePropertyChangedJJ )
(JJ) *
)JJ* +
;JJ+ ,
ChangeThemeKK 
(KK 
_selectThemeKK (
)KK( )
;KK) *
}LL 
}MM 	
publicPP 
RelayCommandPP 
<PP 
AppointmentModelPP ,
>PP, -#
PrintAppointmentCommandPP. E
{PPF G
getPPH K
;PPK L
}PPM N
publicQQ 
RelayCommandQQ 
<QQ 
AppointmentModelQQ ,
>QQ, -#
AllAppByLocationCommandQQ. E
{QQF G
getQQH K
;QQK L
}QQM N
publicRR 
RelayCommandRR 
AddAppWindowCommandRR /
{RR0 1
getRR2 5
;RR5 6
}RR7 8
publicSS 
RelayCommandSS 
<SS 
AppointmentModelSS ,
>SS, -
RemoveAppCommandSS. >
{SS? @
getSSA D
;SSD E
}SSF G
publicTT 
RelayCommandTT 
<TT 
objectTT "
>TT" #
SortCommandTT$ /
{TT0 1
getTT2 5
;TT5 6
}TT7 8
publicUU 
RelayCommandUU !
GroupBySubjectCommandUU 1
{UU2 3
getUU4 7
;UU7 8
}UU9 :
publicVV 
RelayCommandVV 
<VV 
AppointmentModelVV ,
>VV, -"
FilterBySubjectCommandVV. D
{VVE F
getVVG J
;VVJ K
}VVL M
publicWW 
RelayCommandWW 
<WW 
objectWW "
>WW" #

PrintTableWW$ .
{WW/ 0
getWW1 4
;WW4 5
}WW6 7
publicXX 
RelayCommandXX  
CalendarFrameCommandXX 0
{XX1 2
getXX3 6
;XX6 7
}XX8 9
publicYY 
RelayCommandYY 
CreateGroupCommandYY .
{YY/ 0
getYY1 4
;YY4 5
}YY6 7
public\\ 
MainWindowViewModel\\ "
(\\" #
IBLLServiceMain\\# 2
service\\3 :
,\\: ;
ILogService\\< G

logService\\H R
,\\R S
INotifyService\\T b
notifyService\\c p
)\\p q
{]] 	
CustomPrincipal^^ 
cp^^ 
=^^  
(^^! "
CustomPrincipal^^" 1
)^^1 2
Thread^^2 8
.^^8 9
CurrentPrincipal^^9 I
;^^I J
if__ 
(__ 
cp__ 
!=__ 
null__ 
)__ 
_id__ 
=__  !
cp__" $
.__$ %
Identity__% -
.__- .
UserId__. 4
;__4 5
_service`` 
=`` 
service`` 
;`` 
_logServiceaa 
=aa 

logServiceaa $
;aa$ %
_notifyServicebb 
=bb 
notifyServicebb *
;bb* +
	Schedulerdd 
.dd 
RemoveFromDataBasedd (
+=dd) +$
RemoveNotifyFromDatabasedd, D
;ddD E
LoadDataee 
(ee 
)ee 
;ee 
AddAppWindowCommandhh 
=hh  !
newhh" %
RelayCommandhh& 2
(hh2 3
AddAppointmenthh3 A
)hhA B
;hhB C#
PrintAppointmentCommandii #
=ii$ %
newii& )
RelayCommandii* 6
<ii6 7
AppointmentModelii7 G
>iiG H
(iiH I
PrintAppointmentiiI Y
)iiY Z
;iiZ [#
AllAppByLocationCommandjj #
=jj$ %
newjj& )
RelayCommandjj* 6
<jj6 7
AppointmentModeljj7 G
>jjG H
(jjH I
GetAllAppsByRoomjjI Y
)jjY Z
;jjZ [
RemoveAppCommandkk 
=kk 
newkk "
RelayCommandkk# /
<kk/ 0
AppointmentModelkk0 @
>kk@ A
(kkA B
RemoveAppointmentkkB S
)kkS T
;kkT U
SortCommandll 
=ll 
newll 
RelayCommandll *
<ll* +
objectll+ 1
>ll1 2
(ll2 3
SortByll3 9
)ll9 :
;ll: ;!
GroupBySubjectCommandmm !
=mm" #
newmm$ '
RelayCommandmm( 4
(mm4 5
GroupBySubjectmm5 C
)mmC D
;mmD E"
FilterBySubjectCommandnn "
=nn# $
newnn% (
RelayCommandnn) 5
<nn5 6
AppointmentModelnn6 F
>nnF G
(nnG H
FilterBySubjectnnH W
)nnW X
;nnX Y

PrintTableoo 
=oo 
newoo 
RelayCommandoo )
<oo) *
objectoo* 0
>oo0 1
(oo1 2
PrintListViewoo2 ?
)oo? @
;oo@ A 
CalendarFrameCommandpp  
=pp! "
newpp# &
RelayCommandpp' 3
(pp3 4
CalendarFramepp4 A
)ppA B
;ppB C
CreateGroupCommandqq 
=qq  
newqq! $
RelayCommandqq% 1
(qq1 2
CreateGroupqq2 =
)qq= >
;qq> ?
vartt 
pathtt 
=tt 
Pathtt 
.tt 
Combinett #
(tt# $
	AppDomaintt$ -
.tt- .
CurrentDomaintt. ;
.tt; <
BaseDirectorytt< I
,ttI J
$strttK O
,ttO P
$strttQ U
,ttU V
$strttW b
)ttb c
;ttc d
varuu 
localthemesuu 
=uu 
newuu !
DirectoryInfouu" /
(uu/ 0
pathuu0 4
)uu4 5
.uu5 6
GetFilesuu6 >
(uu> ?
)uu? @
;uu@ A
ifvv 
(vv 
Filesvv 
==vv 
nullvv 
)vv 
Filesww 
=ww 
newww  
ObservableCollectionww 0
<ww0 1
FileInfoww1 9
>ww9 :
(ww: ;
)ww; <
;ww< =
foreachxx 
(xx 
varxx 
itemxx 
inxx  
localthemesxx! ,
)xx, -
{yy 
Fileszz 
.zz 
Addzz 
(zz 
itemzz 
)zz 
;zz  
}{{ 
SelectedTheme|| 
=|| 
Files|| !
[||! "
$num||" #
]||# $
;||$ %
_dateTimeNow 
= 
DateTime #
.# $
Now$ '
;' (
_timer
ÄÄ 
=
ÄÄ 
new
ÄÄ 
DispatcherTimer
ÄÄ (
{
ÄÄ) *
Interval
ÄÄ+ 3
=
ÄÄ4 5
TimeSpan
ÄÄ6 >
.
ÄÄ> ?
FromMilliseconds
ÄÄ? O
(
ÄÄO P
$num
ÄÄP S
)
ÄÄS T
}
ÄÄU V
;
ÄÄV W
_timer
ÅÅ 
.
ÅÅ 
Tick
ÅÅ 
+=
ÅÅ 
TimerOnTick
ÅÅ &
;
ÅÅ& '
BackgroundWorker
ÉÉ 
workerTimer
ÉÉ (
=
ÉÉ) *
new
ÉÉ+ .
BackgroundWorker
ÉÉ/ ?
(
ÉÉ? @
)
ÉÉ@ A
;
ÉÉA B
workerTimer
ÑÑ 
.
ÑÑ (
WorkerSupportsCancellation
ÑÑ 2
=
ÑÑ3 4
true
ÑÑ5 9
;
ÑÑ9 :
workerTimer
ÖÖ 
.
ÖÖ 
DoWork
ÖÖ 
+=
ÖÖ ! 
workerTimer_DoWork
ÖÖ" 4
;
ÖÖ4 5
workerTimer
ÜÜ 
.
ÜÜ 
RunWorkerAsync
ÜÜ &
(
ÜÜ& '
)
ÜÜ' (
;
ÜÜ( )
	Messenger
ââ 
.
ââ 
Default
ââ 
.
ââ 
Register
ââ &
<
ââ& '!
NotificationMessage
ââ' :
>
ââ: ;
(
ââ; <
this
ââ< @
,
ââ@ A
message
ââB I
=>
ââJ L
{
ää 
if
ãã 
(
ãã 
message
ãã 
.
ãã 
Notification
ãã (
==
ãã) +
$str
ãã, 5
)
ãã5 6
{
åå $
RefreshingAppointments
çç *
(
çç* +
)
çç+ ,
;
çç, -
}
éé 
if
èè 
(
èè 
message
èè 
.
èè 
Notification
èè (
==
èè) +
$str
èè, 4
)
èè4 5
{
êê 
	Messenger
ëë 
.
ëë 
Default
ëë %
.
ëë% &

Unregister
ëë& 0
<
ëë0 1!
NotificationMessage
ëë1 D
>
ëëD E
(
ëëE F
this
ëëF J
)
ëëJ K
;
ëëK L
_timer
ìì 
.
ìì 
Tick
ìì 
-=
ìì  "
TimerOnTick
ìì# .
;
ìì. /
_timer
îî 
?
îî 
.
îî 
Stop
îî  
(
îî  !
)
îî! "
;
îî" #
	Scheduler
óó 
.
óó  
RemoveFromDataBase
óó 0
-=
óó1 3&
RemoveNotifyFromDatabase
óó4 L
;
óóL M
	Scheduler
òò 
.
òò 
Shutdown
òò &
(
òò& '
)
òò' (
;
òò( )
}
ôô 
}
öö 
)
öö 
;
öö 
}
õõ 	
private
ùù 
void
ùù  
workerTimer_DoWork
ùù '
(
ùù' (
object
ùù( .
sender
ùù/ 5
,
ùù5 6
DoWorkEventArgs
ùù7 F
e
ùùG H
)
ùùH I
{
ûû 	
_timer
üü 
?
üü 
.
üü 
Start
üü 
(
üü 
)
üü 
;
üü 
}
†† 	
private
°° 
void
°° 
TimerOnTick
°°  
(
°°  !
object
°°! '
sender
°°( .
,
°°. /
	EventArgs
°°0 9
e
°°: ;
)
°°; <
{
¢¢ 	
CurrentDateTime
££ 
=
££ 
DateTime
££ &
.
££& '
Now
££' *
;
££* +
}
§§ 	
public
¶¶ 
void
¶¶ &
RemoveNotifyFromDatabase
¶¶ ,
(
¶¶, -
object
¶¶- 3
sender
¶¶4 :
,
¶¶: ;
NotifyEventArgs
¶¶< K
args
¶¶L P
)
¶¶P Q
{
ßß 	
_notifyService
®® 
.
®® $
RemoveFromNotification
®® 1
(
®®1 2
args
®®2 6
.
®®6 7
NotifyId
®®7 ?
,
®®? @
_id
®®A D
)
®®D E
;
®®E F
}
©© 	
private
´´ 
void
´´ 
LoadData
´´ 
(
´´ 
)
´´ 
{
¨¨ 	
try
≠≠ 
{
ÆÆ 
Appointments
ØØ 
=
ØØ 
new
ØØ ""
ObservableCollection
ØØ# 7
<
ØØ7 8
AppointmentModel
ØØ8 H
>
ØØH I
(
ØØI J
Mapper
ØØJ P
.
ØØP Q
Map
ØØQ T
<
ØØT U
IEnumerable
ØØU `
<
ØØ` a
AppointmentDTO
ØØa o
>
ØØo p
,
ØØp q
IEnumerable
ØØr }
<
ØØ} ~
AppointmentModelØØ~ é
>ØØé è
>ØØè ê
(ØØê ë
_serviceØØë ô
.ØØô ö'
GetAppointmentsByUserIdØØö ±
(ØØ± ≤
_idØØ≤ µ
)ØØµ ∂
)ØØ∂ ∑
)ØØ∑ ∏
;ØØ∏ π
	Scheduler
±± 
.
±± 
ScheduleNotify
±± (
(
±±( )
_notifyService
±±) 7
.
±±7 8&
GetNotificationsByUserId
±±8 P
(
±±P Q
_id
±±Q T
)
±±T U
)
±±U V
;
±±V W
}
≤≤ 
catch
≥≥ 
(
≥≥ 
	Exception
≥≥ 
e
≥≥ 
)
≥≥ 
{
¥¥ 

MessageBox
µµ 
.
µµ 
Show
µµ 
(
µµ  
e
µµ  !
.
µµ! "
ToString
µµ" *
(
µµ* +
)
µµ+ ,
)
µµ, -
;
µµ- .
}
∂∂ 
}
∑∑ 	
private
∏∏ 
void
∏∏ 
CreateGroup
∏∏  
(
∏∏  !
)
∏∏! "
{
ππ 	
	Messenger
∫∫ 
.
∫∫ 
Default
∫∫ 
.
∫∫ 
Send
∫∫ "
(
∫∫" #
new
∫∫# &!
NotificationMessage
∫∫' :
(
∫∫: ;
$str
∫∫; H
)
∫∫H I
)
∫∫I J
;
∫∫J K
}
ªª 	
private
ºº 
void
ºº 
PrintListView
ºº "
(
ºº" #
object
ºº# )
	parameter
ºº* 3
)
ºº3 4
{
ΩΩ 	
PrintHelper
ææ 
.
ææ 
PrintViewList
ææ %
(
ææ% &
	parameter
ææ& /
as
ææ0 2
ListView
ææ3 ;
)
ææ; <
;
ææ< =
}
øø 	
private
¿¿ 
void
¿¿ 
ChangeTheme
¿¿  
(
¿¿  !
FileInfo
¿¿! )
selectTheme
¿¿* 5
)
¿¿5 6
{
¡¡ 	
Application
¬¬ 
.
¬¬ 
Current
¬¬ 
.
¬¬  
	Resources
¬¬  )
.
¬¬) *
Clear
¬¬* /
(
¬¬/ 0
)
¬¬0 1
;
¬¬1 2
Application
√√ 
.
√√ 
Current
√√ 
.
√√  
	Resources
√√  )
.
√√) *
Source
√√* 0
=
√√1 2
new
√√3 6
Uri
√√7 :
(
√√: ;
selectTheme
√√; F
.
√√F G
FullName
√√G O
,
√√O P
UriKind
√√Q X
.
√√X Y
Absolute
√√Y a
)
√√a b
;
√√b c
}
ƒƒ 	
private
≈≈ 
void
≈≈ 
AddAppointment
≈≈ #
(
≈≈# $
)
≈≈$ %
{
∆∆ 	
	Messenger
«« 
.
«« 
Default
«« 
.
«« 
Send
«« "
(
««" #
new
««# &
OpenWindowMessage
««' 8
{
««9 :
Type
««; ?
=
««@ A

WindowType
««B L
.
««L M
AddAppWindow
««M Y
}
««Z [
)
««[ \
;
««\ ]
}
»» 	
private
…… 
void
…… 
CalendarFrame
…… "
(
……" #
)
……# $
{
   	
	Messenger
ÀÀ 
.
ÀÀ 
Default
ÀÀ 
.
ÀÀ 
Send
ÀÀ "
(
ÀÀ" #
new
ÀÀ# &
OpenWindowMessage
ÀÀ' 8
{
ÀÀ9 :
Type
ÀÀ; ?
=
ÀÀ@ A

WindowType
ÀÀB L
.
ÀÀL M
CalendarFrame
ÀÀM Z
}
ÀÀ[ \
)
ÀÀ\ ]
;
ÀÀ] ^
}
ÃÃ 	
private
ÕÕ 
void
ÕÕ 
PrintAppointment
ÕÕ %
(
ÕÕ% &
AppointmentModel
ÕÕ& 6
appointment
ÕÕ7 B
)
ÕÕB C
{
ŒŒ 	
if
ŸŸ 
(
ŸŸ 
appointment
ŸŸ 
!=
ŸŸ 
null
ŸŸ #
)
ŸŸ# $
{
⁄⁄ 
	Messenger
€€ 
.
€€ 
Default
€€ !
.
€€! "
Send
€€" &
(
€€& '
new
€€' *
OpenWindowMessage
€€+ <
{
€€= >
Type
€€? C
=
€€D E

WindowType
€€F P
.
€€P Q'
AddAboutAppointmentWindow
€€Q j
,
€€j k
Appointment
€€l w
=
€€x y
appointment€€z Ö
,€€Ö Ü
Argument€€á è
=€€ê ë
$str€€í ©
}€€™ ´
)€€´ ¨
;€€¨ ≠
}
‹‹ 
}
›› 	
private
ﬁﬁ 
void
ﬁﬁ $
RefreshingAppointments
ﬁﬁ +
(
ﬁﬁ+ ,
)
ﬁﬁ, -
{
ﬂﬂ 	
Appointments
‡‡ 
=
‡‡ 
new
‡‡ "
ObservableCollection
‡‡ 3
<
‡‡3 4
AppointmentModel
‡‡4 D
>
‡‡D E
(
‡‡E F
Mapper
‡‡F L
.
‡‡L M
Map
‡‡M P
<
‡‡P Q
IEnumerable
‡‡Q \
<
‡‡\ ]
AppointmentDTO
‡‡] k
>
‡‡k l
,
‡‡l m
IEnumerable
‡‡n y
<
‡‡y z
AppointmentModel‡‡z ä
>‡‡ä ã
>‡‡ã å
(‡‡å ç
_service‡‡ç ï
.‡‡ï ñ'
GetAppointmentsByUserId‡‡ñ ≠
(‡‡≠ Æ
_id‡‡Æ ±
)‡‡± ≤
)‡‡≤ ≥
)‡‡≥ ¥
;‡‡¥ µ
	Messenger
‚‚ 
.
‚‚ 
Default
‚‚ 
.
‚‚ 
Send
‚‚ "
(
‚‚" #
new
‚‚# &
OpenWindowMessage
‚‚' 8
{
‚‚9 :
Type
‚‚; ?
=
‚‚@ A

WindowType
‚‚B L
.
‚‚L M
Toast
‚‚M R
,
‚‚R S
Argument
‚‚T \
=
‚‚] ^
$str‚‚_ †
,‚‚† °
SecondsToShow‚‚¢ Ø
=‚‚∞ ±
$num‚‚≤ ≥
}‚‚¥ µ
)‚‚µ ∂
;‚‚∂ ∑
var
‰‰ 

lastNotify
‰‰ 
=
‰‰ 
_notifyService
‰‰ +
.
‰‰+ ,&
GetNotificationsByUserId
‰‰, D
(
‰‰D E
_id
‰‰E H
)
‰‰H I
.
‰‰I J
LastOrDefault
‰‰J W
(
‰‰W X
)
‰‰X Y
;
‰‰Y Z
if
ÂÂ 
(
ÂÂ 

lastNotify
ÂÂ 
!=
ÂÂ 
null
ÂÂ "
)
ÂÂ" #
{
ÊÊ 
	Scheduler
ÁÁ 
.
ÁÁ 
ScheduleNotify
ÁÁ (
(
ÁÁ( )
new
ÁÁ) ,"
ObservableCollection
ÁÁ- A
<
ÁÁA B
NotificationDTO
ÁÁB Q
>
ÁÁQ R
{
ÁÁS T

lastNotify
ÁÁU _
}
ÁÁ` a
)
ÁÁa b
;
ÁÁb c
}
ËË 
}
ÈÈ 	
private
ÍÍ 
void
ÍÍ 
GetAllAppsByRoom
ÍÍ %
(
ÍÍ% &
AppointmentModel
ÍÍ& 6
appointment
ÍÍ7 B
)
ÍÍB C
{
ÎÎ 	
if
˚˚ 
(
˚˚ 
appointment
˚˚ 
!=
˚˚ 
null
˚˚ #
)
˚˚# $
{
¸¸ 
try
˝˝ 
{
˛˛ 
	Messenger
ˇˇ 
.
ˇˇ 
Default
ˇˇ %
.
ˇˇ% &
Send
ˇˇ& *
(
ˇˇ* +
new
ˇˇ+ .
OpenWindowMessage
ˇˇ/ @
(
ˇˇ@ A
)
ˇˇA B
{
ÄÄ 
Type
ÄÄ 
=
ÄÄ 

WindowType
ÄÄ '
.
ÄÄ' ('
AddAllAppByLocationWindow
ÄÄ( A
,
ÄÄA B
Argument
ÄÄC K
=
ÄÄL M
appointment
ÄÄN Y
.
ÄÄY Z

LocationId
ÄÄZ d
.
ÄÄd e
ToString
ÄÄe m
(
ÄÄm n
)
ÄÄn o
}
ÄÄp q
)
ÄÄq r
;
ÄÄr s
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ  
e
ÇÇ! "
)
ÇÇ" #
{
ÉÉ 

MessageBox
ÑÑ 
.
ÑÑ 
Show
ÑÑ #
(
ÑÑ# $
e
ÑÑ$ %
.
ÑÑ% &
ToString
ÑÑ& .
(
ÑÑ. /
)
ÑÑ/ 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÖÖ 
}
ÜÜ 
}
áá 	
private
àà 
void
àà 
GroupBySubject
àà #
(
àà# $
)
àà$ %
{
ââ 	
ICollectionView
ää 
view
ää  
=
ää! ""
CollectionViewSource
ää# 7
.
ää7 8
GetDefaultView
ää8 F
(
ääF G
Appointments
ääG S
)
ääS T
;
ääT U
view
ãã 
.
ãã 
GroupDescriptions
ãã "
.
ãã" #
Clear
ãã# (
(
ãã( )
)
ãã) *
;
ãã* +
view
åå 
.
åå 
GroupDescriptions
åå "
.
åå" #
Add
åå# &
(
åå& '
new
åå' *&
PropertyGroupDescription
åå+ C
(
ååC D
$str
ååD M
)
ååM N
)
ååN O
;
ååO P
}
çç 	
private
éé 
void
éé 
SortBy
éé 
(
éé 
object
éé "
	parameter
éé# ,
)
éé, -
{
èè 	
string
êê 
column
êê 
=
êê 
(
êê 
string
êê #
)
êê# $
	parameter
êê$ -
;
êê- .
if
ëë 
(
ëë 
column
ëë 
!=
ëë 
null
ëë 
)
ëë 
{
íí 
ICollectionView
ìì 
view
ìì  $
=
ìì% &"
CollectionViewSource
ìì' ;
.
ìì; <
GetDefaultView
ìì< J
(
ììJ K
Appointments
ììK W
)
ììW X
;
ììX Y
if
îî 
(
îî 
view
îî 
.
îî 
SortDescriptions
îî )
.
îî) *
Count
îî* /
>
îî0 1
$num
îî2 3
&&
ïï 
view
ïï 
.
ïï 
SortDescriptions
ïï ,
[
ïï, -
$num
ïï- .
]
ïï. /
.
ïï/ 0
PropertyName
ïï0 <
==
ïï= ?
column
ïï@ F
&&
ññ 
view
ññ 
.
ññ 
SortDescriptions
ññ ,
[
ññ, -
$num
ññ- .
]
ññ. /
.
ññ/ 0
	Direction
ññ0 9
==
ññ: <
ListSortDirection
ññ= N
.
ññN O
	Ascending
ññO X
)
ññX Y
{
óó 
view
òò 
.
òò 
GroupDescriptions
òò *
.
òò* +
Clear
òò+ 0
(
òò0 1
)
òò1 2
;
òò2 3
view
ôô 
.
ôô 
Filter
ôô 
=
ôô  !
null
ôô" &
;
ôô& '
view
öö 
.
öö 
SortDescriptions
öö )
.
öö) *
Clear
öö* /
(
öö/ 0
)
öö0 1
;
öö1 2
view
õõ 
.
õõ 
SortDescriptions
õõ )
.
õõ) *
Add
õõ* -
(
õõ- .
new
õõ. 1
SortDescription
õõ2 A
(
õõA B
column
õõB H
,
õõH I
ListSortDirection
õõJ [
.
õõ[ \

Descending
õõ\ f
)
õõf g
)
õõg h
;
õõh i
}
úú 
else
ùù 
{
ûû 
view
üü 
.
üü 
GroupDescriptions
üü *
.
üü* +
Clear
üü+ 0
(
üü0 1
)
üü1 2
;
üü2 3
view
†† 
.
†† 
Filter
†† 
=
††  !
null
††" &
;
††& '
view
°° 
.
°° 
SortDescriptions
°° )
.
°°) *
Clear
°°* /
(
°°/ 0
)
°°0 1
;
°°1 2
view
¢¢ 
.
¢¢ 
SortDescriptions
¢¢ )
.
¢¢) *
Add
¢¢* -
(
¢¢- .
new
¢¢. 1
SortDescription
¢¢2 A
(
¢¢A B
column
¢¢B H
,
¢¢H I
ListSortDirection
¢¢J [
.
¢¢[ \
	Ascending
¢¢\ e
)
¢¢e f
)
¢¢f g
;
¢¢g h
}
££ 
}
§§ 
}
•• 	
private
¶¶ 
void
¶¶ 
FilterBySubject
¶¶ $
(
¶¶$ %
AppointmentModel
¶¶% 5
appointment
¶¶6 A
)
¶¶A B
{
ßß 	
if
®® 
(
®® 
appointment
®® 
!=
®® 
null
®® #
)
®®# $
{
©© 
ICollectionView
™™ 
view
™™  $
=
™™% &"
CollectionViewSource
™™' ;
.
™™; <
GetDefaultView
™™< J
(
™™J K
Appointments
™™K W
)
™™W X
;
™™X Y
view
´´ 
.
´´ 
GroupDescriptions
´´ &
.
´´& '
Clear
´´' ,
(
´´, -
)
´´- .
;
´´. /
view
¨¨ 
.
¨¨ 
Filter
¨¨ 
=
¨¨ 
s
¨¨ 
=>
¨¨  "
(
¨¨# $
(
¨¨$ %
s
¨¨% &
as
¨¨' )
AppointmentModel
¨¨* :
)
¨¨: ;
?
¨¨; <
.
¨¨< =
Subject
¨¨= D
)
¨¨D E
==
¨¨F H
appointment
¨¨I T
.
¨¨T U
Subject
¨¨U \
;
¨¨\ ]
}
≠≠ 
}
ÆÆ 	
private
ØØ 
void
ØØ 
RemoveAppointment
ØØ &
(
ØØ& '
AppointmentModel
ØØ' 7
appointment
ØØ8 C
)
ØØC D
{
∞∞ 	
if
±± 
(
±± 
appointment
±± 
!=
±± 
null
±± #
)
±±# $
{
≤≤ 
try
≥≥ 
{
¥¥ 
CustomPrincipal
µµ #
customPrincipal
µµ$ 3
=
µµ4 5
Thread
µµ6 <
.
µµ< =
CurrentPrincipal
µµ= M
as
µµN P
CustomPrincipal
µµQ `
;
µµ` a
if
∂∂ 
(
∂∂ 
customPrincipal
∂∂ '
!=
∂∂( *
null
∂∂+ /
)
∂∂/ 0
_logService
∑∑ #
.
∑∑# $
LogAppointment
∑∑$ 2
(
∑∑2 3
Mapper
∑∑3 9
.
∑∑9 :
Map
∑∑: =
<
∑∑= >
AppointmentModel
∑∑> N
,
∑∑N O
AppointmentDTO
∑∑P ^
>
∑∑^ _
(
∑∑_ `
appointment
∑∑` k
)
∑∑k l
,
∑∑l m
customPrincipal
∏∏ +
.
∏∏+ ,
Identity
∏∏, 4
.
∏∏4 5
UserId
∏∏5 ;
,
∏∏; <
false
∏∏= B
)
∏∏B C
;
∏∏C D
_service
∫∫ 
.
∫∫ #
RemoveFromAppointment
∫∫ 2
(
∫∫2 3
appointment
∫∫3 >
.
∫∫> ?
AppointmentId
∫∫? L
,
∫∫L M
_id
∫∫N Q
)
∫∫Q R
;
∫∫R S
_notifyService
ªª "
.
ªª" # 
RemoveNotification
ªª# 5
(
ªª5 6
appointment
ªª6 A
.
ªªA B
AppointmentId
ªªB O
,
ªªO P
_id
ªªQ T
)
ªªT U
;
ªªU V
Appointments
ΩΩ  
.
ΩΩ  !
Remove
ΩΩ! '
(
ΩΩ' (
appointment
ΩΩ( 3
)
ΩΩ3 4
;
ΩΩ4 5
base
øø 
.
øø "
RaisePropertyChanged
øø -
(
øø- .
)
øø. /
;
øø/ 0
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¬¬ 

MessageBox
√√ 
.
√√ 
Show
√√ #
(
√√# $
ex
√√$ &
.
√√& '
ToString
√√' /
(
√√/ 0
)
√√0 1
)
√√1 2
;
√√2 3
}
ƒƒ 
}
≈≈ 
}
∆∆ 	
}
«« 
}»» ‚7
lC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Calendar\SyncWindowViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Calendar '
{ 
public 

class 
SyncWindowViewModel $
:$ %
ViewModelBase& 3
{ 
private 
int 
_myStartDay 
;  
private 
int 
_myFinishDay  
;  !
private 
int 
_syncStartDay !
;! "
private 
int 
_syncFinishDay "
;" #
public 
int 

MyStartDay 
{ 	
get 
=> 
_myStartDay 
; 
set 
{ 
_myStartDay 
= 
value #
;# $
base 
.  
RaisePropertyChanged )
() *
)* +
;+ ,
} 
} 	
public 
int 
MyFinishDay 
{ 	
get   
=>   
_myFinishDay   
;    
set!! 
{"" 
_myFinishDay## 
=## 
value## $
;##$ %
base$$ 
.$$  
RaisePropertyChanged$$ )
($$) *
)$$* +
;$$+ ,
}%% 
}&& 	
public'' 
int'' 
SyncStartDay'' 
{(( 	
get)) 
=>)) 
_syncStartDay))  
;))  !
set** 
{++ 
_syncStartDay,, 
=,, 
value,,  %
;,,% &
base-- 
.--  
RaisePropertyChanged-- )
(--) *
)--* +
;--+ ,
}.. 
}// 	
public00 
int00 
SyncFinishDay00  
{11 	
get22 
=>22 
_syncFinishDay22 !
;22! "
set33 
{44 
_syncFinishDay55 
=55  
value55! &
;55& '
base66 
.66  
RaisePropertyChanged66 )
(66) *
)66* +
;66+ ,
}77 
}88 	
private:: 
readonly:: 
IBLLServiceMain:: (
_service::) 1
;::1 2
private;; 
readonly;; 
int;; 
_id;;  
;;;  !
private<<  
ObservableCollection<< $
<<<$ %
AppointmentDTO<<% 3
><<3 4
_appointments<<5 B
;<<B C
private==  
ObservableCollection== $
<==$ %
AppointmentDTO==% 3
>==3 4
_appointmentsOther==5 G
;==G H
public??  
ObservableCollection?? #
<??# $
AppointmentDTO??$ 2
>??2 3
Appointments??4 @
{@@ 	
getAA 
=>AA 
_appointmentsAA  
;AA  !
setBB 
{CC 
ifDD 
(DD 
valueDD 
!=DD 
_appointmentsDD *
)DD* +
{EE 
_appointmentsFF !
=FF" #
valueFF$ )
;FF) *
baseGG 
.GG  
RaisePropertyChangedGG -
(GG- .
)GG. /
;GG/ 0
}HH 
}II 
}JJ 	
publicKK  
ObservableCollectionKK #
<KK# $
AppointmentDTOKK$ 2
>KK2 3
AppointmentsSyncKK4 D
{LL 	
getMM 
=>MM 
_appointmentsOtherMM %
;MM% &
setNN 
{OO 
ifPP 
(PP 
valuePP 
!=PP 
_appointmentsOtherPP /
)PP/ 0
{QQ 
_appointmentsOtherRR &
=RR' (
valueRR) .
;RR. /
baseSS 
.SS  
RaisePropertyChangedSS -
(SS- .
)SS. /
;SS/ 0
}TT 
}UU 
}VV 	
publicXX 
SyncWindowViewModelXX "
(XX" #
IBLLServiceMainXX# 2
serviceXX3 :
)XX: ;
{YY 	
_serviceZZ 
=ZZ 
serviceZZ 
;ZZ 
CustomPrincipal[[ 
cp[[ 
=[[  
([[! "
CustomPrincipal[[" 1
)[[1 2
Thread[[2 8
.[[8 9
CurrentPrincipal[[9 I
;[[I J
if\\ 
(\\ 
cp\\ 
!=\\ 
null\\ 
)\\ 
_id\\ 
=\\  !
cp\\" $
.\\$ %
Identity\\% -
.\\- .
UserId\\. 4
;\\4 5
	Messenger^^ 
.^^ 
Default^^ 
.^^ 
Register^^ &
<^^& '
OpenWindowMessage^^' 8
>^^8 9
(^^9 :
this^^: >
,^^> ?
message^^@ G
=>^^H J
{__ 
if`` 
(`` 
message`` 
.`` 
Type``  
==``! #

WindowType``$ .
.``. /
None``/ 3
&&``4 6
message``7 >
.``> ?
User``? C
!=``D F
null``G K
)``K L
{aa 

MyStartDaybb 
=bb  
Convertbb! (
.bb( )
ToInt32bb) 0
(bb0 1
messagebb1 8
.bb8 9
Argumentbb9 A
)bbA B
;bbB C
MyFinishDaycc 
=cc  !

MyStartDaycc" ,
+cc- .
$numcc/ 0
;cc0 1
SyncStartDaydd  
=dd! "

MyStartDaydd# -
;dd- .
SyncFinishDayee !
=ee" #
MyFinishDayee$ /
;ee/ 0
LoadDataff 
(ff 
messageff $
.ff$ %
Userff% )
.ff) *
UserIdff* 0
)ff0 1
;ff1 2
}gg 
}hh 
)hh 
;hh 
}ii 	
privatekk 
voidkk 
LoadDatakk 
(kk 
intkk !
idkk" $
)kk$ %
{ll 	
trymm 
{nn 
Appointmentsoo 
=oo 
newoo " 
ObservableCollectionoo# 7
<oo7 8
AppointmentDTOoo8 F
>ooF G
(ooG H
_serviceooH P
.ooP Q&
GetAppointmentsForCalendarooQ k
(ook l
_idool o
)ooo p
)oop q
;ooq r
AppointmentsSyncpp  
=pp! "
newpp# & 
ObservableCollectionpp' ;
<pp; <
AppointmentDTOpp< J
>ppJ K
(ppK L
_serviceppL T
.ppT U&
GetAppointmentsForCalendarppU o
(ppo p
idppp r
)ppr s
)pps t
;ppt u
}qq 
catchrr 
(rr 
	Exceptionrr 
err 
)rr 
{ss 

MessageBoxtt 
.tt 
Showtt 
(tt  
ett  !
.tt! "
ToStringtt" *
(tt* +
)tt+ ,
)tt, -
;tt- .
}uu 
}vv 	
}ww 
}xx è
oC:\Users\Dzianis_Tarasevich\Desktop\saves\16\WpfOutlook\ViewModel\ViewModels\Appointments\ToastListViewModel.cs
	namespace 	
	ViewModel
 
. 

ViewModels 
. 
Appointments +
{		 
public

 

class

 
ToastListViewModel

 #
:

$ %
ViewModelBase

& 3
{ 
public  
ObservableCollection #
<# $
Message4ListBox$ 3
>3 4
Messages5 =
{> ?
get@ C
;C D
setE H
;H I
}J K
public 
ToastListViewModel !
(! "
)" #
{ 	
Messages 
= 
new  
ObservableCollection /
</ 0
Message4ListBox0 ?
>? @
(@ A
)A B
;B C
	Messenger 
. 
Default 
. 
Register &
<& '
OpenWindowMessage' 8
>8 9
(9 :
this: >
,> ?
message@ G
=>H J
{ 
if 
( 
message 
. 
Type  
==! #

WindowType$ .
.. /
Toast/ 4
)4 5
{ 

AddMessage 
( 
message &
)& '
;' (
} 
} 
) 
; 
} 	
private 
async 
Task 

AddMessage %
(% &
OpenWindowMessage& 7
msg8 ;
); <
{ 	
Message4ListBox 
message4ListBox +
=, -
new. 1
Message4ListBox2 A
{B C
MsgD G
=H I
msgJ M
.M N
ArgumentN V
,V W
IsGoingX _
=` a
falseb g
}h i
;i j
Messages 
. 
Insert 
( 
$num 
, 
message4ListBox .
). /
;/ 0
await 
Task 
. 
Delay 
( 
new  
TimeSpan! )
() *
$num* +
,+ ,
$num- .
,. /
msg0 3
.3 4
SecondsToShow4 A
)A B
)B C
;C D
message4ListBox!! 
.!! 
IsGoing!! #
=!!$ %
true!!& *
;!!* +
await"" 
Task"" 
."" 
Delay"" 
("" 
new""  
TimeSpan""! )
("") *
$num""* +
,""+ ,
$num""- .
,"". /
$num""0 1
,""1 2
$num""3 4
,""4 5
$num""6 9
)""9 :
)"": ;
;""; <
Messages## 
.## 
Remove## 
(## 
message4ListBox## +
)##+ ,
;##, -
}$$ 	
}%% 
public'' 

class'' 
Message4ListBox''  
:''! "
ViewModelBase''# 0
{(( 
public)) 
String)) 
Msg)) 
{)) 
get)) 
;))  
set))! $
;))$ %
}))& '
private** 
bool** 
_isGoing** 
;** 
public,, 
bool,, 
IsGoing,, 
{-- 	
get.. 
{.. 
return.. 
_isGoing.. !
;..! "
}..# $
set// 
{00 
_isGoing11 
=11 
value11  
;11  ! 
RaisePropertyChanged22 $
(22$ %
)22% &
;22& '
}33 
}44 	
}55 
}66 